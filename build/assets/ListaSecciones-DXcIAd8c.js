import{r as s,o as xo,u as go,j as o}from"./index-SVRFFNc9.js";import{C as _}from"./index.esm-DWwMdKxH.js";import{S as c}from"./sweetalert2.esm.all-D3pEHXw3.js";import{E as _o}from"./jspdf.plugin.autotable-gke1D7B3.js";import{l as Co}from"./logo_saint_patrick-xw7Wl8f3.js";import bo from"./AccessDenied-yaDW3Jao.js";import{u as jo}from"./usePermission-BCWksQX7.js";import{C as No}from"./CContainer-BdNP0s3v.js";import{C as de,a as P}from"./CRow-Bf67u6lu.js";import{a as l}from"./CButton-D9GPTbB6.js";import{c as So}from"./cil-arrow-left-D66Kb3Zq.js";import{c as yo}from"./cil-plus-D8mtC-W5.js";import{C as Eo,a as wo,b as vo,c as Ao}from"./CDropdownToggle-DlfIUTmX.js";import{c as Po}from"./cil-description-MUzg6O3n.js";import{C as p}from"./CInputGroup-D-McUFva.js";import{C as h}from"./CInputGroupText-Cfu0fzaY.js";import{c as ko}from"./cil-search-CDkY_4k-.js";import{C as L}from"./CFormInput-B_gylY64.js";import{C as x}from"./CFormSelect-CzT7g5tb.js";import{C as To,a as Do,b as ke,c as N,d as $o,e as S}from"./CTable-98qqrSRH.js";import{c as zo}from"./cil-pen-53d2I-C-.js";import{c as Te}from"./cil-trash-CBbKHhHb.js";import{c as Io}from"./cil-settings-CNy3J7AJ.js";import{C as ue,a as pe,b as me,c as he}from"./CModalHeader-Bhtr3bZe.js";import{C as fe}from"./CModalTitle-M2mBvD_5.js";import{C as Ro}from"./CForm-CYRkMwLo.js";import"./CConditionalPortal-DwBsYzTA.js";import"./CFormControlWrapper-OEJgTi6e.js";import"./CFormControlValidation-CtDkyDfm.js";import"./CFormLabel-szm2Dda9.js";import"./CBackdrop-BbuVwMMD.js";const Fo=J=>{try{const Y=J.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),Z=decodeURIComponent(atob(Y).split("").map(K=>`%${`00${K.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""));return JSON.parse(Z)}catch(M){return console.error("Error al decodificar el token JWT:",M),null}},xr=()=>{const{canSelect:J,canDelete:M,canInsert:Y,canUpdate:Z}=jo("Secciones"),[K,Q]=s.useState([]),[xe,De]=s.useState([]),[C,$e]=s.useState([]),[ge,ze]=s.useState([]),[k,X]=s.useState([]),[b,_e]=s.useState(""),[Ce,ee]=s.useState([]),[oe,B]=s.useState(!1),[Ie,re]=s.useState(!1),[Re,G]=s.useState(!1),[n,y]=s.useState({Nombre_seccion:"",Numero_aula:"",Nombre_grado:"",Cod_profesor:"",Cod_periodo_matricula:""}),[t,T]=s.useState({}),[E,Fe]=s.useState({}),[be,je]=s.useState(""),[w,Ne]=s.useState(1),[v,Ue]=s.useState(10),[O,Le]=s.useState("Nombre_seccion"),[A,Me]=s.useState(""),[f,H]=s.useState(1),Be=()=>H(f-1),Se=xo(),Ge=go(),{periodoSeleccionado:d}=Ge.state||{},[D,ae]=s.useState(!0),[se,ce]=s.useState(""),[Oe,He]=s.useState(C),ye=async()=>{try{const r=await(await fetch("http://74.50.68.87:4000/api/secciones/periodo_academico/activo")).json();r&&r.Anio_academico?(Me(r.Anio_academico),ee([{Cod_periodo_matricula:r.Cod_periodo_matricula,Anio_academico:r.Anio_academico}])):console.warn("No se encontró el año académico activo.")}catch(e){console.error("Error capturado en este bloque:",e),console.error("Error al obtener el período académico activo:",e)}},$=async e=>{try{const r=await fetch(`http://74.50.68.87:4000/api/secciones/obtener_seccperiodo/${e}`),a=await r.json();if(r.ok){const i=a.map((m,u)=>({...m,originalIndex:u+1}));Q(i),console.log("Secciones cargadas:",i)}else Q([]),console.log("No se encontraron secciones para el período proporcionado.")}catch(r){console.error("Error capturado al cargar secciones:",r)}};s.useEffect(()=>{oe===!1&&d&&$(d)},[oe,d]),s.useEffect(()=>{A&&console.log("Período académico activo:",A)},[A]),s.useEffect(()=>{Je(),Ye(),Ze(),Ke(),Qe()},[]),s.useEffect(()=>{b?z(b):X([])},[b]);const qe=e=>(e=e.toUpperCase(),e=e.replace(/[^A-Z0-9 ]/g,""),e=e.replace(/\s{2,}/g," ").trimStart(),/([A-Z0-9])\1\1/.test(e)?(c.fire("Error","No se permiten tres caracteres iguales consecutivos.","error"),""):e),We=e=>{const{Cod_secciones:r,Nombre_grado:a}=e;console.log("Navegando a lista-secciones-asignatura con:",{seccionSeleccionada:r,periodoSeleccionado:d,gradoSeleccionado:a,profesores:C}),Se("/lista-secciones-asignatura/",{state:{seccionSeleccionada:r,periodoSeleccionado:d,gradoSeleccionado:a,profesores:C}})};s.useEffect(()=>{d?(console.log("Cargando estado del período seleccionado:",d),Ve(d),$(d)):(console.warn("No se encontró un período seleccionado."),ye())},[d]);const Ve=async e=>{try{const a=await(await fetch("http://74.50.68.87:4000/api/gestion_academica/obtener_periodo")).json();console.log("Períodos recibidos:",a);const i=a.find(m=>m.Cod_periodo_matricula===e);i?ae(i.Estado==="activo"):(console.warn("Período no encontrado."),ae(!1))}catch(r){console.error("Error capturado en este bloque:",r),console.error("Error al obtener el estado del período:",r),ae(!1)}},Je=async e=>{try{const i=(await(await fetch(`http://74.50.68.87:4000/api/secciones/obtener_secciones/${e}`)).json()).map((m,u)=>({...m,originalIndex:u+1}));Q(i)}catch(r){console.error("Error capturado en este bloque:",r),console.error("Error al obtener las secciones:",r)}},Ye=async()=>{const r=await(await fetch("http://74.50.68.87:4000/api/secciones/grados")).json();De(r)},Ze=async()=>{const r=await(await fetch("http://74.50.68.87:4000/api/secciones/profesores")).json();$e(r)},Ke=async()=>{try{const e=await fetch("http://74.50.68.87:4000/api/secciones/periodo_academico"),r=await e.json();e.ok&&r.length>0?ee(r):(console.warn("No se encontraron períodos de matrícula."),ee([]))}catch(e){console.error("Error capturado en este bloque:",e),console.error("Error al obtener los períodos académicos:",e)}},Qe=async()=>{try{const e=await fetch("http://74.50.68.87:4000/api/secciones/edificios");if(!e.ok)throw new Error(`Error HTTP: ${e.status}`);const r=await e.json();ze(r)}catch(e){console.error("Error capturado en este bloque:",e),console.error("Error al obtener los edificios:",e)}},z=async e=>{try{if(!e){console.error("Error: Cod_edificio no está definido."),c.fire("Error","El código del edificio no está definido.","error");return}console.log("Código de edificio enviado:",e);const r=await fetch(`http://74.50.68.87:4000/api/secciones/aulas/por_edificio/${e}`),a=await r.json();if(r.ok){let i=a.aulas;if(console.log("Respuesta del servidor:",a),console.log("Aulas cargadas:",i),!Array.isArray(i)){console.error("La propiedad 'aulas' no es un array:",i);return}if(!i.find(u=>u.Numero_aula===t.p_Numero_aula)&&t.p_Numero_aula){const u=await fetch(`http://74.50.68.87:4000/api/secciones/${t.p_Numero_aula}`),j=await u.json();u.ok?i.push(j):console.error("Error al obtener el aula actual:",j.mensaje)}console.log("Aulas después de agregar el aula actual:",i),X(i)}else console.error("Error al obtener aulas del edificio:",a.mensaje),c.fire("Error",a.mensaje||"No se pudieron cargar las aulas.","error")}catch(r){console.error("Error al cargar las aulas:",r),c.fire("Error","Hubo un problema al cargar las aulas.","error")}},ie=e=>{const r=C.find(a=>a.Cod_profesor===e);return r?r.Nombre_completo.toUpperCase():"Profesor no encontrado"};s.useEffect(()=>{const e=se.toLowerCase(),r=C.filter(a=>a.Numero_identidad.toLowerCase().includes(e)||a.Nombre_completo.toLowerCase().includes(e));He(r)},[se,C]);const Ee=e=>{const r=Ce.find(a=>a.Cod_periodo_matricula===e);return r?r.Anio_academico:"Año académico no disponible"},Xe=()=>{Se("/gestion_academica")},we=e=>{e>0&&e<=Math.ceil(g.length/v)&&Ne(e)},I=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),g=K.filter(e=>{const r=I(be);if(O==="Nombre_seccion")return I(e.Nombre_seccion).includes(r);if(O==="Numero_aula")return I(e.Numero_aula.toString()).includes(r);if(O==="Nombre_grado")return I(e.Nombre_grado).includes(r);if(O==="Nombre_profesor"){const a=ie(e.Cod_Profesor);return I(a).includes(r)}return!1}).sort((e,r)=>e.Nombre_seccion.localeCompare(r.Nombre_seccion,"es",{sensitivity:"base"})),ve=w*v,Ae=ve-v,eo=g.slice(Ae,ve),oo=()=>f===1&&(!b||!n.Cod_aula||!n.Cod_grado)?(c.fire("Error","Debe seleccionar un edificio, aula y grado.","error"),!1):f===2&&!n.Cod_profesor?(c.fire("Error","Debe seleccionar un profesor.","error"),!1):!0,ro=()=>{oo()&&H(f+1)},ao=()=>{const e=new _o;if(!g||g.length===0){alert("No hay datos para exportar.");return}const r=new Image;r.src=Co,r.onload=()=>{const a=e.internal.pageSize.width;e.addImage(r,"PNG",10,10,45,45),e.setFontSize(18),e.setTextColor(0,102,51),e.text("SAINT PATRICK'S ACADEMY",a/2,24,{align:"center"}),e.setFontSize(10),e.setTextColor(100),e.text("Casa Club del periodista, Colonia del Periodista",a/2,32,{align:"center"}),e.text("Teléfono: (504) 2234-8871",a/2,37,{align:"center"}),e.text("Correo: info@saintpatrickacademy.edu",a/2,42,{align:"center"});const i=Ee(g[0].Cod_periodo_matricula)||"SIN PERIODO";e.setFontSize(14),e.setTextColor(0,102,51),e.text(`Listado de Secciones - Año Académico ${i}`,a/2,50,{align:"center"}),e.setLineWidth(.5),e.setDrawColor(0,102,51),e.line(10,55,a-10,55),e.setFontSize(12),e.setTextColor(50),e.text("Listado Detallado de Secciones",a/2,65,{align:"center"});const m=["#","Sección","Aula","Grado","Maestro guía"],u=g.map((R,le)=>{var V,F,U;return[{content:(le+1).toString(),styles:{halign:"center"}},{content:((V=R.Nombre_seccion)==null?void 0:V.toUpperCase())||"SIN NOMBRE",styles:{halign:"center"}},((F=R.Numero_aula)==null?void 0:F.toString())||"SIN AULA",((U=R.Nombre_grado)==null?void 0:U.toUpperCase())||"SIN GRADO",{content:ie(R.Cod_Profesor)||"SIN PROFESOR",styles:{halign:"left"}}]});e.autoTable({startY:70,head:[m],body:u,headStyles:{fillColor:[0,102,51],textColor:[255,255,255],fontSize:10,halign:"center"},styles:{fontSize:10,cellPadding:3},alternateRowStyles:{fillColor:[240,248,255]},didDrawPage:R=>{const le=e.internal.getNumberOfPages(),V=e.internal.getCurrentPageInfo().pageNumber,F=e.internal.pageSize.height-10;e.setFontSize(10),e.setTextColor(0,102,51),e.text(`Página ${V} de ${le}`,a-10,F,{align:"right"});const U=new Date,ho=U.toLocaleDateString("es-HN",{year:"numeric",month:"long",day:"numeric"}),fo=U.toLocaleTimeString("es-HN",{hour:"2-digit",minute:"2-digit",second:"2-digit"});e.text(`Fecha de generación: ${ho} Hora: ${fo}`,10,F)}});const j=e.output("blob"),mo=URL.createObjectURL(j),te=window.open(mo,"_blank");te&&(te.document.title="Reporte de Secciones",te.document.filename="reporte_de_secciones.pdf")},r.onerror=()=>{alert("No se pudo cargar el logo.")}},ne=async(e,r="")=>{try{const a=localStorage.getItem("token"),i=Fo(a);if(!i){c.fire("Error","Token inválido o expirado. Por favor, inicie sesión nuevamente.","error");return}const m=i.cod_usuario,u=i.nombre_usuario;if(!m||!u){c.fire("Error","El token no contiene información válida del usuario.","error");return}const j=`El usuario: ${u} realizó la acción: ${e}. ${r}`;console.log("Datos para bitácora:",{cod_usuario:m,cod_objeto:97,accion:e,descripcion:j}),await fetch("http://74.50.68.87:4000/api/bitacora/registro",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({cod_usuario:m,cod_objeto:97,accion:e,descripcion:j})}),console.log("Registro en bitácora exitoso")}catch(a){console.error("Error al registrar en bitácora:",a.message),c.fire("Error","Hubo un problema al registrar en la bitácora.","error")}},so=()=>{A||ye(),q(),B(!0)},q=()=>{var e;y({Nombre_seccion:"",Cod_aula:"",Cod_grado:"",Cod_profesor:"",Cod_periodo_matricula:d||((e=Ce[0])==null?void 0:e.Cod_periodo_matricula)}),_e(""),X([]),ce("")};s.useEffect(()=>{console.log("Nombre de la sección actualizado:",n.Nombre_seccion)},[n.Nombre_seccion]);const[Uo,Pe]=s.useState(!1),co=async e=>{try{Pe(!0);const r=await fetch(`http://74.50.68.87:4000/api/secciones/generar_nombre_seccion/${e}/${A}`),a=await r.json();r.ok?y(i=>({...i,Nombre_seccion:a.Nombre_seccion})):console.error("Error en la API:",a.mensaje)}catch(r){console.error("Error capturado en este bloque:",r),console.error("Error al generar el nombre:",r)}finally{Pe(!1)}},io=async()=>{if(!n.Cod_aula||!n.Cod_grado||!n.Cod_profesor){c.fire("Error","Todos los campos son requeridos.","error");return}const e=k.find(r=>r.Cod_aula.toString()===n.Cod_aula.toString());if(!e){c.fire("Error","El aula seleccionada no es válida.","error");return}if(e.Secciones_disponibles<=0){c.fire("Error","No hay secciones disponibles en esta aula.","error");return}try{const r=await fetch("http://74.50.68.87:4000/api/secciones/crear_seccion",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({p_Cod_aula:n.Cod_aula,p_Cod_grado:n.Cod_grado,p_Cod_Profesor:n.Cod_profesor,p_Cod_periodo_matricula:n.Cod_periodo_matricula})}),a=await r.json();r.ok?(c.fire("Creación exitosa","La sección ha sido creada correctamente.","success"),await ne("INSERT",`Sección creada. Nombre: ${n.Nombre_seccion||"No especificado"}, Aula: ${n.Cod_aula}, Grado: ${n.Cod_grado}, Profesor: ${n.Cod_profesor}.`),$(d),z(b),B(!1),q()):c.fire("Error",a.mensaje||"No se pudo crear la sección.","error")}catch(r){console.error("Error al crear la sección:",r),c.fire("Error","Error de conexión o en el servidor.","error")}},no=async e=>{try{const r=await fetch(`http://74.50.68.87:4000/api/secciones/obtener_seccion/${e}`),a=await r.json();r.ok?(T({p_Cod_secciones:a.Cod_secciones,p_Nombre_seccion:a.Nombre_seccion,Cod_edificio:a.Cod_edificio,p_Numero_aula:a.Numero_aula,p_Nombre_grado:a.Nombre_grado,p_Cod_Profesor:a.Cod_profesor,p_Cod_periodo_matricula:a.Cod_periodo_matricula}),a.Cod_edificio&&await z(a.Cod_edificio),re(!0)):c.fire("Error",a.mensaje||"No se pudo obtener la sección.","error")}catch(r){console.error("Error capturado en este bloque:",r),console.error("Error al obtener los datos de la sección:",r),c.fire("Error","Hubo un problema al cargar los datos de la sección.","error")}},to=async()=>{const e=k.find(a=>a.Numero_aula.toString()===t.p_Numero_aula.toString()),r=t.p_Numero_aula;if(e&&e.Numero_aula!==r&&e.Secciones_disponibles<=0){c.fire("Error","No hay secciones disponibles en esta aula.","error");return}try{const a=await fetch("http://74.50.68.87:4000/api/secciones/actualizar_seccion",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(a.ok)c.fire("Éxito","Sección actualizada correctamente.","success"),await ne("UPDATE",`Sección actualizada. Nombre: ${t.p_Nombre_seccion}, Aula: ${t.p_Numero_aula}, Grado: ${t.p_Nombre_grado}, Profesor: ${t.p_Cod_Profesor}.`),re(!1),$(d),z(t.Cod_edificio);else{const i=await a.json();c.fire("Error",i.mensaje||"No se pudo actualizar la sección.","error")}}catch(a){console.error("Error al actualizar la sección:",a),c.fire("Error","Hubo un problema al actualizar la sección.","error")}},lo=()=>{T({p_Cod_secciones:"",p_Nombre_seccion:"",Cod_edificio:"",p_Numero_aula:"",p_Nombre_grado:"",p_Cod_Profesor:"",p_Cod_periodo_matricula:""})},uo=e=>{console.log("Sección seleccionada para eliminar:",e),Fe(e),G(!0)},po=async()=>{if(console.log("Sección a eliminar:",E),!E.Cod_secciones){c.fire("Error","No se ha seleccionado una sección válida para eliminar.","error");return}try{const e=await fetch(`http://74.50.68.87:4000/api/secciones/eliminar_seccion/${E.Cod_secciones}`,{method:"DELETE"});if(e.ok)c.fire("Eliminación exitosa","La sección ha sido eliminada correctamente.","success"),await ne("DELETE",`Sección eliminada. Código: ${E.Cod_secciones}, Nombre: ${E.Nombre_seccion||"No especificado"}.`),G(!1),d&&$(d);else{const r=await e.json();c.fire("Error",r.mensaje||"No se pudo eliminar la sección.","error")}}catch(e){console.error("Error al eliminar la sección:",e),c.fire("Error","Hubo un problema al eliminar la sección.","error")}},W=()=>{c.fire({title:"¿Estás seguro?",text:"Tienes cambios sin guardar. ¿Deseas cerrar el modal?",icon:"warning",showCancelButton:!0,confirmButtonText:"Cerrar",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&(B(!1),re(!1),G(!1),q(),lo(),H(1))})};return J?o.jsxs(No,{children:[o.jsxs("div",{className:"container mt-3",children:[" ",o.jsx(de,{className:"align-items-center mb-3",children:o.jsx(P,{xs:"12",className:"text-center",children:o.jsx("h2",{className:"fw-bold",children:"Gestión de Secciones"})})}),o.jsxs(de,{className:"align-items-center mb-3",children:[o.jsx(P,{xs:"12",md:"4",className:"text-start mb-2 mb-md-0",children:o.jsxs(l,{className:"d-flex align-items-center gap-1 rounded shadow",onMouseEnter:e=>e.currentTarget.style.backgroundColor="#4B4B4B",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#656565",style:{backgroundColor:"#656565",color:"#FFFFFF",padding:"10px 16px",fontSize:"0.9rem",transition:"background-color 0.2s ease, box-shadow 0.3s ease",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)",whiteSpace:"nowrap"},onClick:Xe,children:[o.jsx(_,{icon:So})," Gestión Académica"]})}),o.jsxs(P,{xs:"12",md:"8",className:"text-end d-flex flex-column flex-md-row justify-content-md-end align-items-md-center gap-2",children:[Y&&o.jsxs(l,{className:"d-flex align-items-center gap-1 rounded shadow",style:{backgroundColor:D?"#4B6251":"#C0C0C0",color:"white",padding:"10px 16px",fontSize:"0.9rem"},onClick:D?so:null,disabled:!D,children:[o.jsx(_,{icon:yo})," Nuevo"]}),o.jsxs(Eo,{children:[o.jsxs(wo,{style:{backgroundColor:"#6C8E58",color:"white",padding:"10px 16px",fontSize:"0.9rem"},className:"d-flex align-items-center rounded shadow",children:[o.jsx(_,{icon:Po})," Reporte"]}),o.jsx(vo,{children:o.jsx(Ao,{onClick:()=>ao(),style:{color:"#6C8E58",fontWeight:"bold"},children:"Ver Reporte en PDF"})})]})]})]}),o.jsx("div",{className:"filter-container mb-4",children:o.jsxs(de,{className:"align-items-center",children:[o.jsx(P,{xs:"12",md:"2",className:"text-start",children:o.jsx(l,{color:"light",onClick:()=>{je("")},style:{padding:"6px 12px",fontSize:"0.9rem",backgroundColor:"#E0E0E0",color:"#000",border:"1px solid #CCC"},children:"Limpiar"})}),o.jsx(P,{xs:"12",md:"6",className:"d-flex align-items-center gap-2",children:o.jsxs(p,{children:[o.jsx(h,{children:o.jsx(_,{icon:ko})}),o.jsx(L,{placeholder:"Buscar Sección...",onChange:e=>je(qe(e.target.value)),value:be,style:{padding:"6px",fontSize:"0.9rem"}}),o.jsxs(x,{"aria-label":"Buscar por",onChange:e=>Le(e.target.value),style:{marginLeft:"10px",fontSize:"0.9rem"},children:[o.jsx("option",{value:"Nombre_seccion",children:"Nombre Sección"}),o.jsx("option",{value:"Numero_aula",children:"Aula"}),o.jsx("option",{value:"Nombre_grado",children:"Grado"}),o.jsx("option",{value:"Nombre_profesor",children:"Maestro guía"})]})]})}),o.jsx(P,{xs:"12",md:"4",className:"text-md-end",children:o.jsxs(p,{style:{width:"auto",display:"inline-flex",alignItems:"center"},children:[o.jsx("span",{children:"Mostrar "}),o.jsxs(x,{style:{padding:"6px",fontSize:"0.9rem",width:"80px",textAlign:"center"},onChange:e=>{const r=Number(e.target.value);Ue(r),Ne(1)},value:v,children:[o.jsx("option",{value:"5",children:"5"}),o.jsx("option",{value:"10",children:"10"}),o.jsx("option",{value:"20",children:"20"})]}),o.jsx("span",{children:" registros"})]})})]})}),o.jsx("div",{className:"table-container mt-4",style:{height:"300px",overflowY:"auto",marginBottom:"20px"},children:o.jsxs(To,{striped:!0,bordered:!0,hover:!0,children:[o.jsx(Do,{style:{position:"sticky",top:0,zIndex:1,backgroundColor:"#fff"},children:o.jsxs(ke,{children:[o.jsx(N,{className:"text-center",style:{width:"5%"},children:"#"}),o.jsx(N,{className:"text-center",style:{width:"10%"},children:"Sección"}),o.jsx(N,{className:"text-center",style:{width:"10%"},children:"Aula"}),o.jsx(N,{style:{width:"20%"},children:"Grado"}),o.jsx(N,{style:{width:"20%"},children:"Maestro guía"}),o.jsx(N,{className:"text-center",style:{width:"20%"},children:"Periodo Matrícula"}),o.jsx(N,{className:"text-center",style:{width:"15%"},children:"Acciones"})]})}),o.jsx($o,{children:eo.map((e,r)=>o.jsxs(ke,{children:[o.jsx(S,{className:"text-center",children:Ae+r+1}),o.jsx(S,{className:"text-center",children:e.Nombre_seccion.toUpperCase()}),o.jsx(S,{className:"text-center",children:e.Numero_aula}),o.jsx(S,{children:e.Nombre_grado.toUpperCase()}),o.jsx(S,{children:ie(e.Cod_Profesor)}),o.jsx(S,{children:Ee(e.Cod_periodo_matricula)}),o.jsx(S,{className:"text-center",children:o.jsxs("div",{className:"d-flex justify-content-center",children:[Z&&o.jsx(l,{color:"warning",onClick:()=>no(e.Cod_secciones),className:"me-2",disabled:!D,children:o.jsx(_,{icon:zo})}),M&&o.jsx(l,{color:"danger",onClick:()=>uo(e),className:"me-2",disabled:!D,children:o.jsx(_,{icon:Te})}),o.jsx(l,{color:"info",onClick:()=>We(e),children:o.jsx(_,{icon:Io})})]})})]},e.Cod_secciones))})]})})]}),o.jsxs("div",{className:"pagination-container",style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:"20px"},children:[o.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[o.jsx(l,{style:{backgroundColor:"#6f8173",color:"#D9EAD3",padding:"8px 16px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",fontSize:"0.9rem",fontWeight:"bold",border:"none"},disabled:w===1,onClick:()=>we(w-1),children:"Anterior"}),o.jsx(l,{style:{backgroundColor:"#6f8173",color:"#D9EAD3",padding:"8px 16px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",fontSize:"0.9rem",fontWeight:"bold",border:"none"},disabled:w===Math.ceil(g.length/v),onClick:()=>we(w+1),children:"Siguiente"})]}),o.jsxs("span",{style:{fontSize:"0.9rem",color:"#6f8173"},children:["Página ",w," de ",Math.ceil(g.length/v)]})]}),o.jsxs(ue,{visible:oe,onClose:()=>{B(!1),H(1),q()},backdrop:"static",size:"md",children:[o.jsxs(pe,{closeButton:!1,children:[o.jsxs(fe,{children:["Crear Nueva Sección - Paso ",f]}),o.jsx(l,{className:"btn-close","aria-label":"Close",onClick:W})]}),o.jsxs(me,{children:[f===1&&o.jsxs("div",{children:[o.jsx("h5",{children:"Selecciona el Edificio, Aula y Grado"}),o.jsx("hr",{}),o.jsxs(p,{className:"mb-3",children:[o.jsx(h,{children:"Edificio"}),o.jsxs(x,{value:b,onChange:e=>{_e(e.target.value),y({...n,Cod_aula:""})},children:[o.jsx("option",{value:"",children:"Seleccione un Edificio"}),ge.map(e=>o.jsx("option",{value:e.Cod_edificio,children:e.Nombre_edificios.toUpperCase()},e.Cod_edificio))]})]}),o.jsxs(p,{className:"mb-3",children:[o.jsx(h,{children:"Aula"}),o.jsxs(x,{value:n.Cod_aula,onChange:e=>{const r=k.find(a=>a.Cod_aula.toString()===e.target.value.toString());if(!r){c.fire("Error","El aula seleccionada no es válida.","error");return}y({...n,Cod_aula:r.Cod_aula})},disabled:!b,children:[o.jsx("option",{value:"",children:"Seleccione un Aula"}),k.map(e=>o.jsx("option",{value:e.Cod_aula,children:`Aula ${e.Numero_aula} - Secciones disponibles: ${e.Secciones_disponibles}`},e.Cod_aula))]})]}),o.jsxs(p,{className:"mb-3",children:[o.jsx(h,{children:"Grado"}),o.jsxs(x,{value:n.Cod_grado,onChange:e=>{const r=e.target.value;y(a=>({...a,Cod_grado:r})),co(r)},children:[o.jsx("option",{value:"",children:"Seleccione un Grado"}),xe.map(e=>o.jsx("option",{value:e.Cod_grado,children:e.Nombre_grado},e.Cod_grado))]})]})]}),f===2&&o.jsxs("div",{children:[o.jsx("h5",{children:"Profesor y Período de Matrícula"}),o.jsx("hr",{}),o.jsxs("div",{children:[o.jsxs(p,{className:"mb-3",children:[o.jsx(h,{children:"Período Matrícula"}),o.jsx(L,{value:A||"Cargando...",readOnly:!0})]}),o.jsxs(p,{className:"mb-3",children:[o.jsx(h,{children:"Buscar Profesor"}),o.jsx(L,{placeholder:"Buscar por identidad, nombre o apellido...",value:se,onChange:e=>{let r=e.target.value.replace(/[^a-zA-Z0-9 ]/g,"").replace(/\s+/g," ").toUpperCase();/(.)\1{2,}/.test(r)&&(r=r.slice(0,-1)),ce(r)},onPaste:e=>e.preventDefault()})]}),o.jsx("div",{style:{border:"1px solid #ddd",borderRadius:"4px",padding:"10px",background:"white"},children:o.jsx("ul",{style:{listStyle:"none",margin:0,padding:0,maxHeight:"150px",overflowY:"scroll"},children:Oe.map(e=>o.jsx("li",{style:{padding:"8px",cursor:"pointer",borderBottom:"1px solid #ddd"},onClick:()=>{y({...n,Cod_profesor:e.Cod_profesor}),ce(`ID: ${e.Numero_identidad} - ${e.Nombre_completo}`)},children:`ID: ${e.Numero_identidad} - ${e.Nombre_completo}`},e.Cod_profesor))})})]})]})]}),o.jsxs(he,{children:[f>1&&o.jsx(l,{color:"secondary",onClick:Be,children:"Atrás"}),f<2?o.jsx(l,{color:"primary",onClick:ro,children:"Siguiente"}):o.jsx(l,{color:"success",onClick:io,children:"Finalizar y Guardar"})]})]}),o.jsxs(ue,{visible:Ie,backdrop:"static",size:"lg",children:[o.jsxs(pe,{closeButton:!1,children:[o.jsx(fe,{children:"Actualizar Sección"}),o.jsx(l,{className:"btn-close","aria-label":"Close",onClick:()=>{W()}})]}),o.jsx(me,{children:o.jsxs(Ro,{children:[o.jsxs(p,{className:"mb-3",children:[o.jsx(h,{children:"Código de Sección"}),o.jsx(L,{value:t.p_Cod_secciones||"",readOnly:!0})]}),o.jsxs(p,{className:"mb-3",children:[o.jsx(h,{children:"Nombre de la Sección"}),o.jsx(L,{value:t.p_Nombre_seccion||"",readOnly:!0})]}),o.jsxs(p,{className:"mb-3",children:[o.jsx(h,{children:"Grado"}),o.jsxs(x,{value:t.p_Nombre_grado||"",disabled:!0,children:[o.jsx("option",{value:"",children:"Seleccione un Grado"}),xe.map(e=>o.jsx("option",{value:e.Nombre_grado,children:e.Nombre_grado.toUpperCase()},e.Cod_grado))]})]}),o.jsxs(p,{className:"mb-3",children:[o.jsx(h,{children:"Edificio"}),o.jsxs(x,{value:t.Cod_edificio||"",onChange:async e=>{const r=e.target.value;T({...t,Cod_edificio:r,p_Numero_aula:""}),await z(r)},children:[o.jsx("option",{value:"",children:"Seleccione un Edificio"}),ge.map(e=>o.jsx("option",{value:e.Cod_edificio,children:e.Nombre_edificios.toUpperCase()},e.Cod_edificio))]})]}),o.jsxs(p,{className:"mb-3",children:[o.jsx(h,{children:"Aula"}),o.jsxs(x,{value:t.p_Numero_aula||"",onChange:e=>T({...t,p_Numero_aula:e.target.value}),disabled:!t.Cod_edificio,children:[o.jsx("option",{value:"",children:"Seleccione un Aula"}),k.map(e=>o.jsx("option",{value:e.Numero_aula,disabled:e.Secciones_disponibles<=0&&e.Numero_aula!==t.p_Numero_aula,children:`Aula ${e.Numero_aula} - Secciones disponibles: ${e.Secciones_disponibles}`},e.Cod_aula))]})]}),o.jsxs(p,{className:"mb-3",children:[o.jsx(h,{children:"Profesor"}),o.jsxs(x,{value:t.p_Cod_Profesor||"",onChange:e=>T({...t,p_Cod_Profesor:e.target.value}),children:[o.jsx("option",{value:"",children:"Seleccione un Profesor"}),C.map(e=>o.jsx("option",{value:e.Cod_profesor,children:`${e.Nombre_completo.toUpperCase()} - ID: ${e.Numero_identidad}`},e.Cod_profesor))]})]})]})}),o.jsxs(he,{children:[o.jsx(l,{color:"secondary",onClick:()=>{W()},children:"Cancelar"}),o.jsx(l,{color:"success",onClick:to,children:"Guardar Cambios"})]})]}),o.jsxs(ue,{visible:Re,backdrop:"static",children:[o.jsxs(pe,{closeButton:!1,children:[o.jsx(fe,{children:"Confirmar Eliminación"}),o.jsx(l,{className:"btn-close","aria-label":"Close",onClick:W})]}),o.jsxs(me,{children:['¿Estás seguro de que deseas eliminar la sección: "',E.Nombre_seccion,'"?']}),o.jsxs(he,{children:[o.jsx(l,{color:"secondary",onClick:()=>G(!1),children:"Cancelar"}),o.jsxs(l,{color:"danger",onClick:po,children:[o.jsx(_,{icon:Te})," Eliminar"]})]})]})]}):o.jsx(bo,{})};export{Fo as decodeJWT,xr as default};
