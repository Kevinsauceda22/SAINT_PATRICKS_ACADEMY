import{r as n,j as s}from"./index-SVRFFNc9.js";/* empty css                      */import{E as j,a as f}from"./eye-C-La4pM4.js";import{R as P}from"./refresh-cw-O16dAa9U.js";import"./createLucideIcon-CPQyE5BK.js";const S=""+new URL("Logo-DeDh_51w.png",import.meta.url).href,R=()=>{const[l,d]=n.useState(""),[u,m]=n.useState(""),[h,N]=n.useState(!1),[p,b]=n.useState(!1),[w,i]=n.useState(""),[g,v]=n.useState(""),C=()=>{const c="abcdefghijklmnopqrstuvwxyz",e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="0123456789",o="@#$%&*!";let a="";for(a+=c.charAt(Math.floor(Math.random()*c.length)),a+=e.charAt(Math.floor(Math.random()*e.length)),a+=r.charAt(Math.floor(Math.random()*r.length)),a+=o.charAt(Math.floor(Math.random()*o.length));a.length<12;){const x=c+e+r+o;a+=x.charAt(Math.floor(Math.random()*x.length))}a=a.split("").sort(()=>.5-Math.random()).join(""),d(a),m(a)},y=async t=>{t.preventDefault();const c=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@#$%&*!])[A-Za-z\d@#$%&*!]{8,}$/;if(l!==u){i("Las contraseñas no coinciden");return}else if(!c.test(l)){i("La contraseña debe tener al menos 8 caracteres, incluir mayúsculas, minúsculas, un número y un carácter especial");return}i("");try{const e=window.location.pathname.split("/").pop();console.log("Token de usuario:",e);const r=await fetch(`http://localhost:4000/api/usuarios/nuevopassword/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contraseña_usuario:l,confirmar_contrasena:u})});if(console.log("Status de respuesta:",r.status),!r.ok){let o;try{o=await r.json()}catch(a){throw console.error("Error al parsear JSON:",a),new Error("Error desconocido al cambiar la contraseña")}throw console.error("Error de la API:",o),new Error(o.message||"Error al cambiar la contraseña")}v("¡Contraseña cambiada exitosamente! Guarda esta contraseña en un gestor de contraseñas."),d(""),m("")}catch(e){console.error("Error en el envío:",e),i(e.message||"Ocurrió un error al cambiar la contraseña")}};return s.jsx("div",{className:"new-password-container",children:s.jsx("div",{className:"new-password-card",children:s.jsxs("div",{className:"new-password-content",children:[s.jsx("div",{className:"icon-container",children:s.jsx("img",{src:S,alt:"Logo de la Escuela",className:"school-logo"})}),s.jsx("h2",{className:"title",children:"Nueva Contraseña"}),w&&s.jsx("div",{className:"alert alert-error",children:w}),g&&s.jsx("div",{className:"alert alert-success",children:g}),s.jsxs("form",{onSubmit:y,className:"form",children:[s.jsxs("div",{className:"input-group",children:[s.jsx("label",{htmlFor:"password",className:"label",children:"Nueva Contraseña"}),s.jsxs("div",{className:"input-container",children:[s.jsx("input",{type:h?"text":"password",id:"password",value:l,onChange:t=>d(t.target.value),className:"input",required:!0}),s.jsx("button",{type:"button",onClick:()=>N(!h),className:"toggle-password",children:h?s.jsx(j,{}):s.jsx(f,{})})]})]}),s.jsxs("div",{className:"input-group",children:[s.jsx("label",{htmlFor:"confirmPassword",className:"label",children:"Confirmar Nueva Contraseña"}),s.jsxs("div",{className:"input-container",children:[s.jsx("input",{type:p?"text":"password",id:"confirmPassword",value:u,onChange:t=>m(t.target.value),className:"input",required:!0}),s.jsx("button",{type:"button",onClick:()=>b(!p),className:"toggle-password",children:p?s.jsx(j,{}):s.jsx(f,{})})]})]}),s.jsxs("div",{className:"button-group",children:[s.jsxs("button",{type:"button",onClick:C,className:"generate-button",children:[s.jsx(P,{className:"icon",style:{marginRight:"0.5rem"}}),"Generar Contraseña"]}),s.jsx("button",{type:"submit",className:"submit-button",children:"Cambiar Contraseña"})]})]})]})})})};export{R as default};
