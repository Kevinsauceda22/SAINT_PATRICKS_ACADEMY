import{r as c,x as We,j as o,C as Ue,h as J,i as X}from"./index-SVRFFNc9.js";import{C as u}from"./index.esm-DWwMdKxH.js";import{S as a}from"./sweetalert2.esm.all-D3pEHXw3.js";import{l as q}from"./logo_saint_patrick-xw7Wl8f3.js";import{E as Z}from"./jspdf.plugin.autotable-gke1D7B3.js";import{u as N,w as Q}from"./xlsx-lwdk4T0U.js";import{u as Ye}from"./usePermission-BCWksQX7.js";import Ke from"./AccessDenied-yaDW3Jao.js";import{C as ee,a as H}from"./CRow-Bf67u6lu.js";import{C as oe,a as re,b as te,c as I}from"./CDropdownToggle-DlfIUTmX.js";import{c as ne}from"./cil-description-MUzg6O3n.js";import{c as ae}from"./cil-file-CeQgYs_D.js";import{c as se}from"./cil-spreadsheet-CJUvf_vM.js";import{C as ie}from"./CInputGroup-D-McUFva.js";import{C as Je}from"./CInputGroupText-Cfu0fzaY.js";import{c as Xe}from"./cil-search-CDkY_4k-.js";import{C as qe}from"./CFormInput-B_gylY64.js";import{a as h}from"./CButton-D9GPTbB6.js";import{c as Ze}from"./cil-brush-alt-CV61lKqC.js";import{C as le}from"./CFormSelect-CzT7g5tb.js";import{C as ce,a as de,b as _,c as f,d as pe,e as g}from"./CTable-98qqrSRH.js";import{c as Qe}from"./cil-plus-D8mtC-W5.js";import{c as ue}from"./cil-pen-53d2I-C-.js";import{C as eo}from"./CPagination-UopCEeNZ.js";import{C as ge,a as xe,b as he,c as me}from"./CModalHeader-Bhtr3bZe.js";import{C as fe}from"./CModalTitle-M2mBvD_5.js";import{c as oo,a as ro}from"./cil-x-B8NR0tyJ.js";import{c as to}from"./cil-save-CHBg7z_U.js";import"./CConditionalPortal-DwBsYzTA.js";import"./CFormControlWrapper-OEJgTi6e.js";import"./CFormControlValidation-CtDkyDfm.js";import"./CFormLabel-szm2Dda9.js";import"./CBackdrop-BbuVwMMD.js";const Oo=()=>{const{canSelect:Ce,canInsert:no,canUpdate:ao}=Ye("ListaPonderacionesCiclos"),[m,be]=c.useState([]),[D,je]=c.useState([]),[x,ye]=c.useState([]),[Se,we]=c.useState([]),[E,ke]=c.useState(""),[Te,W]=c.useState(!1),[ve,P]=c.useState(!1),[Ne,F]=c.useState(!1),[k,B]=c.useState(""),[z,j]=c.useState(""),[T,_e]=c.useState(null),[$,L]=c.useState(null),[C,v]=c.useState({}),[so,Ee]=c.useState(!1),[M,U]=c.useState(""),[b,R]=c.useState(1),[y,Pe]=c.useState(5);c.useEffect(()=>{ze(),Ae(),De();const e=localStorage.getItem("token");if(e)try{const t=We(e);console.log("Token decodificado:",t)}catch(t){console.error("Error al decodificar el token:",t)}},[]);const ze=async()=>{try{const t=await(await fetch("http://localhost:4000/api/ciclos/verCiclos")).json();ye(t)}catch(e){console.error("Error al obtener los ciclos:",e)}},A=e=>{if(!x||x.length===0||!e)return"Ciclo no encontrado";const t=x.find(r=>r.Cod_ciclo===e);return t?t.Nombre_ciclo:"Ciclo no encontrado"},Ae=async()=>{try{const t=await(await fetch("http://localhost:4000/api/ponderaciones/verPonderaciones")).json();je(t)}catch(e){console.error("Error al obtener las ponderaciones:",e)}},O=e=>{if(!D.length)return"Ponderaciones no disponibles";const t=D.find(r=>r.Cod_ponderacion===e);return t?t.Descripcion_ponderacion:"Ponderacion no encontrada"},Y=async e=>{W(!0);try{const r=await(await fetch(`http://localhost:4000/api/ponderacionCiclo/verPonderacionesCiclos/${e}`)).json();be(r),ke(e),P(!0)}catch(t){console.error("Error al obtener los datos:",t)}finally{W(!1)}},De=async()=>{try{const r=(await(await fetch("http://localhost:4000/api/grados/verGrados")).json()).map((n,s)=>({...n,originalIndex:s+1}));we(r)}catch(e){console.error("Error al obtener los grados:",e)}},V=e=>Se.filter(t=>t.Cod_ciclo===e),Fe=e=>{_e(e),F(!0)},Be=(e,t)=>{L(e),v(t)},Me=()=>v({}),Re=async()=>{if(!k||k==="")return a.fire({icon:"error",title:"Error",text:"Por favor seleccione una ponderación",confirmButtonText:"Aceptar"}),!1;if(isNaN(k)||k<=0)return a.fire({icon:"error",title:"Error",text:"La ponderación seleccionada no es válida",confirmButtonText:"Aceptar"}),!1;if(isNaN(z)||z<=.5||z>100)return a.fire({icon:"error",title:"Error",text:"El puntaje debe ser un número entre 0.5 y 100",confirmButtonText:"Aceptar"}),!1;try{const e=localStorage.getItem("token");if(console.log("Token obtenido:",e),!e){a.fire("Error","No tienes permiso para realizar esta acción","error");return}const t=await fetch("http://localhost:4000/api/ponderacionCiclo/crearPonderacionesCiclos",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({Cod_ponderacion:k,Cod_ciclo:T.Cod_ciclo,Valor:z})});if(t.ok){const r=J(e);if(console.log("Token decodificado:",r),!r.cod_usuario)throw console.error("No se pudo obtener el código de usuario del token"),new Error("No se pudo obtener el código de usuario del token");const n=`El usuario: ${r.nombre_usuario} ha asignado una ponderación al ciclo: ${T.Nombre_ciclo}`,s=await X.post("http://localhost:4000/api/bitacora/registro",{cod_usuario:r.cod_usuario,cod_objeto:89,accion:"INSERT",descripcion:n},{headers:{Authorization:`Bearer ${e}`}});console.log("Respuesta de registro en bitácora:",s),s.status>=200&&s.status<300?(a.fire({icon:"success",title:"¡Éxito!",text:"Ponderación asignada correctamente",confirmButtonText:"Aceptar"}),F(!1),B(""),j(""),await Y(T.Cod_ciclo),P(!0)):a.fire("Error","No se pudo registrar la acción en la bitácora","error")}else{const r=await t.json();console.error("Error al asignar ponderación:",r),r.Mensaje?a.fire({icon:"error",title:"Error",text:r.Mensaje,confirmButtonText:"Aceptar"}):a.fire({icon:"error",title:"Error",text:"Hubo un problema al asignar la ponderación",confirmButtonText:"Aceptar"})}}catch(e){console.error("Error en la solicitud:",e),a.fire({icon:"error",title:"Error",text:"Hubo un problema al asignar la ponderación",confirmButtonText:"Aceptar"})}},Ie=async e=>{try{const t=localStorage.getItem("token");if(!t){a.fire("Error","No tienes permiso para realizar esta acción","error");return}const r=J(t);if(!r.cod_usuario)throw console.error("No se pudo obtener el código de usuario del token"),new Error("No se pudo obtener el código de usuario del token");if((await fetch("http://localhost:4000/api/ponderacionCiclo/actualizarPonderacionesCiclos",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({Cod_ponderacion_ciclo:e.Cod_ponderacion_ciclo,Cod_ponderacion:C.Cod_ponderacion||e.Cod_ponderacion,Cod_ciclo:e.Cod_ciclo,Valor:C.Valor||e.Valor})})).ok){const s=`El usuario: ${r.nombre_usuario} ha actualizado la ponderación al ciclo: ${A(e.Cod_ciclo)}`,d=await X.post("http://localhost:4000/api/bitacora/registro",{cod_usuario:r.cod_usuario,cod_objeto:89,accion:"UPDATE",descripcion:s},{headers:{Authorization:`Bearer ${t}`}});console.log("Respuesta de registro en bitácora:",d),d.status>=200&&d.status<300?console.log("Registro en bitácora exitoso"):a.fire({icon:"error",title:"Error",text:"No se pudo registrar la acción en la bitácora",confirmButtonText:"Aceptar"}),L(null),P(!1),Ee(!1),Me(),a.fire({icon:"success",title:"¡Éxito!",text:"La ponderación se ha actualizado correctamente",confirmButtonText:"Aceptar"})}else await a.fire({icon:"error",title:"Error",text:"Error al actualizar la ponderación",confirmButtonText:"Aceptar"})}catch(t){console.error("Error al actualizar la ponderación:",t),await a.fire({icon:"error",title:"Error",text:"Ocurrió un error inesperado",confirmButtonText:"Aceptar"})}},$e=()=>{if(!x||x.length===0){a.fire({icon:"info",title:"Tabla vacía",text:"No hay datos disponibles para generar el reporte.",confirmButtonText:"Aceptar"});return}const e=new Z,t=new Image;t.src=q,t.onload=()=>{e.addImage(t,"PNG",10,10,30,30);let r=20;e.setFontSize(18),e.setTextColor(0,102,51),e.text("SAINT PATRICK'S ACADEMY",e.internal.pageSize.width/2,r,{align:"center"}),r+=12,e.setFontSize(16),e.text("Reporte de Ciclos",e.internal.pageSize.width/2,r,{align:"center"}),r+=10,e.setFontSize(10),e.setTextColor(100),e.text("Casa Club del periodista, Colonia del Periodista",e.internal.pageSize.width/2,r,{align:"center"}),r+=4,e.text("Teléfono: (504) 2234-8871",e.internal.pageSize.width/2,r,{align:"center"}),r+=4,e.text("Correo: info@saintpatrickacademy.edu",e.internal.pageSize.width/2,r,{align:"center"}),r+=6,e.setLineWidth(.5),e.setDrawColor(0,102,51),e.line(10,r,e.internal.pageSize.width-10,r);const n=e.internal.pageSize.height;e.autoTable({startY:r+4,head:[["#","Nombre Ciclo","Grados Asignados"]],body:x.map((i,l)=>[l+1,i.Nombre_ciclo,V(i.Cod_ciclo).map(p=>p.Nombre_grado).join(", ")]),headStyles:{fillColor:[0,102,51],textColor:[255,255,255],fontSize:10},styles:{fontSize:10,cellPadding:3,halign:"center"},columnStyles:{0:{cellWidth:"auto"},1:{cellWidth:"auto"},2:{cellWidth:"auto"}},alternateRowStyles:{fillColor:[240,248,255]},didDrawPage:i=>{const l=new Date,p=`${l.toLocaleDateString()} ${l.toLocaleTimeString()}`,w=e.internal.pageSize.height;e.setFontSize(10),e.setTextColor(100),e.text(`Fecha y hora de generación: ${p}`,10,w-10)}});const s=e.internal.getNumberOfPages(),d=e.internal.pageSize.width;for(let i=1;i<=s;i++){e.setPage(i),e.setTextColor(100);const l=`Página ${i} de ${s}`;e.text(l,d-30,n-10)}window.open(e.output("bloburl"),"_blank")},t.onerror=()=>{console.warn("No se pudo cargar el logo. El PDF se generará sin el logo."),window.open(e.output("bloburl"),"_blank")}},Le=()=>{if(!m||m.length===0){a.fire({icon:"info",title:"Tabla vacía",text:"No hay datos disponibles para generar el reporte.",confirmButtonText:"Aceptar"});return}const e=new Z,t=new Image;t.src=q,t.onload=()=>{e.addImage(t,"PNG",10,10,30,30);let r=20;e.setFontSize(18),e.setTextColor(0,102,51),e.text("SAINT PATRICK'S ACADEMY",e.internal.pageSize.width/2,r,{align:"center"}),r+=12,e.setFontSize(16),e.text("Reporte de Ponderaciones por Ciclo",e.internal.pageSize.width/2,r,{align:"center"}),r+=10,e.setFontSize(12),e.setTextColor(0,0,0),E&&(e.text(`Ciclo: ${A(E)}`,e.internal.pageSize.width/2,r,{align:"center"}),r+=8),e.setFontSize(10),e.setTextColor(100),e.text("Casa Club del periodista, Colonia del Periodista",e.internal.pageSize.width/2,r,{align:"center"}),r+=4,e.text("Teléfono: (504) 2234-8871",e.internal.pageSize.width/2,r,{align:"center"}),r+=4,e.text("Correo: info@saintpatrickacademy.edu",e.internal.pageSize.width/2,r,{align:"center"}),r+=6,e.setLineWidth(.5),e.setDrawColor(0,102,51),e.line(10,r,e.internal.pageSize.width-10,r);const n=e.internal.pageSize.height;e.autoTable({startY:r+4,head:[["#","Descripción de Ponderación","Valor"]],body:m.map((l,p)=>[p+1,O(l.Cod_ponderacion),`${l.Valor}%`]),headStyles:{fillColor:[0,102,51],textColor:[255,255,255],fontSize:10},styles:{fontSize:10,cellPadding:3,halign:"center"},columnStyles:{0:{cellWidth:"auto"},1:{cellWidth:"auto"},2:{cellWidth:"auto"},3:{cellWidth:"auto"}},alternateRowStyles:{fillColor:[240,248,255]},didDrawPage:l=>{const p=new Date,w=`${p.toLocaleDateString()} ${p.toLocaleTimeString()}`,He=e.internal.pageSize.height;e.setFontSize(10),e.setTextColor(100),e.text(`Fecha y hora de generación: ${w}`,10,He-10)}});const s=e.internal.getNumberOfPages(),d=e.internal.pageSize.width;for(let l=1;l<=s;l++){e.setPage(l),e.setTextColor(100);const p=`Página ${l} de ${s}`;e.text(p,d-30,n-10)}const i=G();r=e.lastAutoTable.finalY+11,e.setFontSize(11),e.setTextColor(100),e.text(`Total : ${i}%`,e.internal.pageSize.width-15,r,{align:"right"}),window.open(e.output("bloburl"),"_blank")},t.onerror=()=>{console.warn("No se pudo cargar el logo. El PDF se generará sin el logo."),window.open(e.output("bloburl"),"_blank")}},Oe=()=>{if(!m||m.length===0){a.fire({icon:"info",title:"Tabla vacía",text:"No hay datos disponibles para generar el reporte excel.",confirmButtonText:"Aceptar"});return}const e=[["Saint Patrick Academy"],["Reporte de Ponderaciones por Ciclo"],[`Fecha de generación: ${new Date().toLocaleDateString()}`],[]];E&&(e.push([`Ciclo: ${A(E)}`]),e.push([])),e.push(["#","Descripción de Ponderación","Valor"]);const t=m.map((p,w)=>[w+1,O(p.Cod_ponderacion),`${p.Valor}%`]),r=G();t.push(["","","Total",`${r}%`]);const n=[...e,...t],s=N.aoa_to_sheet(n),d=[{wpx:50},{wpx:280},{wpx:100}];s["!cols"]=d;const i=N.book_new();N.book_append_sheet(i,s,"Reporte de Ponderaciones por Ciclo");const l=`reporte_ponderaciones_${new Date().toLocaleDateString().replace(/\//g,"-")}.xlsx`;Q(i,l)},Ve=()=>{if(!x||x.length===0){a.fire({icon:"info",title:"Tabla vacía",text:"No hay datos disponibles para generar el reporte excel.",confirmButtonText:"Aceptar"});return}const e=[["Saint Patrick Academy"],["Reporte de Información de los Ciclos"],[`Fecha de generación: ${new Date().toLocaleDateString()}`],[],["#","Nombre Ciclo","Grados Asignados"]],t=x.map((l,p)=>[p+1,l.Nombre_ciclo,V(l.Cod_ciclo).map(w=>w.Nombre_grado).join(", ")]),r=[...e,...t],n=N.aoa_to_sheet(r),s=[{wpx:50},{wpx:200}];n["!cols"]=s;const d=N.book_new();N.book_append_sheet(d,n,"Reporte de Ciclos");const i=`reporte_ciclos_${new Date().toLocaleDateString().replace(/\//g,"-")}.xlsx`;Q(d,i)},G=()=>m.reduce((t,r)=>t+parseFloat(r.Valor),0).toFixed(2),S=x.length>0?x.filter(e=>{var r;return(((r=e.Nombre_ciclo)==null?void 0:r.toUpperCase().trim())||"").includes(M.trim().toUpperCase())}):[],K=e=>{e>0&&e<=Math.ceil(S.length/y)&&R(e)},Ge=e=>{let t=e.target.value.toUpperCase();const r=/^[A-ZÑÁÉÍÓÚ0-9\s,]*$/;if(/\s{2,}/.test(t)&&(a.fire({icon:"warning",title:"Espacios múltiples",text:"No se permite más de un espacio entre palabras.",confirmButtonText:"Aceptar"}),t=t.replace(/\s+/g," ")),!r.test(t)&&t!==""){a.fire({icon:"warning",title:"Caracteres no permitidos",text:"Solo se permiten letras y espacios.",confirmButtonText:"Aceptar"});return}const n=t.split(" ");for(let s of n){const d={};for(let i of s)if(d[i]=(d[i]||0)+1,d[i]>4){a.fire({icon:"warning",title:"Repetición de letras",text:`La letra "${i}" se repite más de 4 veces en la palabra "${s}".`,confirmButtonText:"Aceptar"});return}}U(t),R(1)};return c.useEffect(()=>{console.log("Término de búsqueda:",M),console.log("Ciclos filtrados:",S)},[M,S]),Ce?o.jsxs("div",{className:"container mt-1",children:[o.jsx(ee,{className:"align-items-center mb-5",children:o.jsxs(H,{xs:"12",className:"d-flex flex-column flex-md-row justify-content-between align-items-center gap-3",children:[o.jsx("div",{className:"flex-grow-1 text-center",children:o.jsx("h4",{className:"text-center fw-semibold pb-2 mb-0",style:{display:"inline-block",borderBottom:"2px solid #4CAF50"},children:"Gestión de Ponderaciones a Ciclos"})}),o.jsxs(oe,{className:"btn-sm d-flex align-items-center gap-1 rounded shadow",children:[o.jsxs(re,{style:{backgroundColor:"#6C8E58",color:"white",fontSize:"0.85rem",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#5A784C",e.currentTarget.style.boxShadow="0 4px 8px rgba(0, 0, 0, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#6C8E58",e.currentTarget.style.boxShadow="none"},children:[o.jsx(u,{icon:ne})," Reporte"]}),o.jsxs(te,{style:{position:"absolute",zIndex:1050,backgroundColor:"#fff",boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.2)",borderRadius:"4px",overflow:"hidden"},children:[o.jsxs(I,{onClick:$e,style:{cursor:"pointer",outline:"none",backgroundColor:"transparent",padding:"0.5rem 1rem",fontSize:"0.85rem",color:"#333",borderBottom:"1px solid #eaeaea",transition:"background-color 0.3s"},onMouseOver:e=>e.target.style.backgroundColor="#f5f5f5",onMouseOut:e=>e.target.style.backgroundColor="transparent",children:[o.jsx(u,{icon:ae,size:"sm"})," Abrir en PDF"]}),o.jsxs(I,{onClick:Ve,style:{cursor:"pointer",outline:"none",backgroundColor:"transparent",padding:"0.5rem 1rem",fontSize:"0.85rem",color:"#333",transition:"background-color 0.3s"},onMouseOver:e=>e.target.style.backgroundColor="#f5f5f5",onMouseOut:e=>e.target.style.backgroundColor="transparent",children:[o.jsx(u,{icon:se,size:"sm"})," Descargar Excel"]})]})]})]})}),o.jsxs(ee,{className:"align-items-center mt-4 mb-2",children:[o.jsx(H,{xs:"12",md:"8",className:"d-flex flex-wrap align-items-center",children:o.jsxs(ie,{className:"me-3",style:{width:"350px"},children:[o.jsx(Je,{children:o.jsx(u,{icon:Xe})}),o.jsx(qe,{style:{width:"80px",height:"35px",display:"inline-block",fontSize:"0.8rem"},placeholder:"Buscar ciclo...",onChange:Ge,value:M}),o.jsxs(h,{style:{border:"1px solid #ccc",transition:"all 0.1s ease-in-out",backgroundColor:"#F3F4F7",color:"#343a40",height:"35px"},onClick:()=>{U(""),R(1)},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#E0E0E0",e.currentTarget.style.color="black"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#F3F4F7",e.currentTarget.style.color="#343a40"},children:[o.jsx(u,{icon:Ze})," Limpiar"]})]})}),o.jsx(H,{xs:"12",md:"4",className:"text-md-end mt-2 mt-md-0",children:o.jsx(ie,{style:{width:"auto",display:"inline-block"},children:o.jsxs("div",{className:"d-inline-flex align-items-center",children:[o.jsx("span",{style:{fontSize:"0.85rem"},children:"Mostrar "}),o.jsxs(le,{style:{width:"80px",height:"35px",display:"inline-block",textAlign:"center"},onChange:e=>{const t=Number(e.target.value);Pe(t),R(1)},value:y,children:[o.jsx("option",{value:"5",children:"5"}),o.jsx("option",{value:"10",children:"10"}),o.jsx("option",{value:"20",children:"20"})]}),o.jsx("span",{style:{fontSize:"0.85rem"},children:" registros"})]})})})]}),o.jsx("div",{className:"table-responsive",style:{maxHeight:"400px",overflowX:"auto",overflowY:"auto",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.3)"},children:o.jsxs(ce,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[o.jsx(de,{className:"sticky-top bg-light text-center",style:{fontSize:"0.8rem"},children:o.jsxs(_,{children:[o.jsx(f,{children:"#"}),o.jsx(f,{children:"NOMBRE DE CICLO"}),o.jsx(f,{children:"GRADOS ASIGNADOS"}),o.jsx(f,{children:"ACCIONES"})]})}),o.jsx(pe,{className:"text-center",style:{fontSize:"0.85rem"},children:S.length>0?S.slice((b-1)*y,b*y).map((e,t)=>o.jsxs(_,{children:[o.jsx(g,{children:t+1+(b-1)*y}),o.jsx(g,{children:e.Nombre_ciclo}),o.jsx(g,{children:V(e.Cod_ciclo).map(r=>r.Nombre_grado).join(", ")}),o.jsx(g,{children:o.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[o.jsxs(h,{style:{backgroundColor:"#4B6251",color:"#FFFFFF",padding:"5px 10px",fontSize:"0.9rem",marginRight:"8px"},onClick:()=>Fe(e),onMouseEnter:r=>{r.currentTarget.style.backgroundColor="#3C4B43",r.currentTarget.style.color="#FFFFFF",r.currentTarget.style.boxShadow="0px 4px 10px rgba(60, 75, 67, 0.6)"},onMouseLeave:r=>{r.currentTarget.style.backgroundColor="#4B6251",r.currentTarget.style.color="#FFFFFF",r.currentTarget.style.boxShadow="none"},children:[o.jsx(u,{icon:Qe,className:"me-2",style:{color:"#FFFFFF",fontSize:"1rem"}}),"Asignar"]}),o.jsx(h,{onClick:()=>Y(e.Cod_ciclo),onMouseEnter:r=>{r.currentTarget.style.boxShadow="0px 4px 10px rgba(249, 182, 78, 0.6)",r.currentTarget.style.color="#000000"},onMouseLeave:r=>{r.currentTarget.style.boxShadow="none",r.currentTarget.style.color="#5C4044"},style:{backgroundColor:"#F9B64E",color:"#5C4044",fontSize:"1rem"},children:o.jsx(u,{icon:ue})})]})})]},e.Cod_ciclo)):o.jsx(_,{children:o.jsx(g,{colSpan:4,className:"text-center",children:"No se encontraron resultados"})})})]})}),o.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"16px"},children:[o.jsxs(eo,{"aria-label":"Page navigation",style:{display:"flex",gap:"10px"},children:[o.jsx(h,{style:{backgroundColor:"#6f8173",color:"#D9EAD3"},disabled:b===1,onClick:()=>K(b-1),children:"Anterior"}),o.jsx(h,{style:{marginLeft:"10px",backgroundColor:"#6f8173",color:"#D9EAD3"},disabled:b===Math.ceil(S.length/y),onClick:()=>K(b+1),children:"Siguiente"})]}),o.jsxs("span",{style:{marginLeft:"10px"},children:["Página ",b," de ",Math.ceil(S.length/y)]})]}),o.jsxs(ge,{size:"lg",visible:ve,backdrop:"static",children:[o.jsx(xe,{onClick:()=>P(!1),children:o.jsxs(fe,{children:["INFORMACIÓN DE: ",o.jsx("strong",{children:A(E)})]})}),o.jsx(he,{children:Te?o.jsx("div",{className:"d-flex justify-content-center my-3",children:o.jsx(Ue,{color:"primary"})}):o.jsx("div",{className:"table-container",style:{maxHeight:"400px",overflowY:"scroll",marginBottom:"20px"},children:m.length>0?o.jsxs(ce,{striped:!0,bordered:!0,hover:!0,children:[o.jsx(de,{children:o.jsxs(_,{children:[o.jsx(f,{children:"#"}),o.jsx(f,{children:"DESCRIPCION DE PONDERACION"}),o.jsx(f,{children:"CICLO"}),o.jsx(f,{children:"VALOR"}),o.jsx(f,{children:"ACCIONES"})]})}),o.jsxs(pe,{children:[m.map((e,t)=>o.jsxs(_,{children:[o.jsx(g,{children:t+1}),o.jsx(g,{children:$===t?o.jsx("select",{style:{width:"100%",padding:"4px",fontSize:"0.9rem"},value:C.Cod_ponderacion||e.Cod_ponderacion,onChange:r=>v({...C,Cod_ponderacion:r.target.value}),children:D.map(r=>o.jsx("option",{value:r.Cod_ponderacion,children:r.Descripcion_ponderacion},r.Cod_ponderacion))}):O(e.Cod_ponderacion)}),o.jsx(g,{children:A(e.Cod_ciclo)}),o.jsx(g,{children:$===t?o.jsx("input",{type:"number",min:0,max:100,step:"0.05",maxLength:11,value:C.Valor||"",onChange:r=>{const n=r.target.value;(n===""||!isNaN(n)&&parseFloat(n)>=0&&parseFloat(n)<=100)&&v({...C,Valor:n})},onBlur:r=>{const n=parseFloat(r.target.value);isNaN(n)||n<.05||n>100?(a.fire("Error","El valor debe estar entre 0.05 y 100","error"),v({...C,Valor:""})):v({...C,Valor:n})}}):`${e.Valor}%`}),o.jsx(g,{children:$===t?o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx(h,{style:{padding:"4px 8px",backgroundColor:"#2ECC71",color:"white"},onClick:()=>Ie(e),children:o.jsx(u,{icon:oo})}),o.jsx(h,{style:{padding:"4px 8px",backgroundColor:"#E74C3C",color:"white"},onClick:()=>L(null),children:o.jsx(u,{icon:ro})})]}):o.jsxs(h,{size:"sm",style:{backgroundColor:"#4B6251",color:"white",padding:"2px 6px",fontSize:"0.85rem",cursor:"pointer"},onMouseEnter:r=>r.currentTarget.style.backgroundColor="#3C4B43",onMouseLeave:r=>r.currentTarget.style.backgroundColor="#4B6251",onClick:()=>Be(t,e),children:[o.jsx(u,{icon:ue})," Editar"]})})]},e.Cod_ponderacion_ciclo)),o.jsxs(_,{children:[o.jsx(g,{colSpan:3,className:"text-end",children:o.jsx("strong",{children:"Total:"})}),o.jsx(g,{children:o.jsxs("strong",{children:[G(),"%"]})})]})]})]}):o.jsx("p",{children:"No hay ponderaciones disponibles para este ciclo."})})}),o.jsxs(me,{children:[o.jsx(h,{color:"secondary",style:{fontSize:"0.85rem",cursor:"pointer"},onClick:()=>P(!1),children:"Cerrar"}),o.jsxs(oe,{children:[o.jsxs(re,{style:{backgroundColor:"#6C8E58",color:"white",fontSize:"0.85rem",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#5A784C",e.currentTarget.style.boxShadow="0 4px 8px rgba(0, 0, 0, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#6C8E58",e.currentTarget.style.boxShadow="none"},children:[o.jsx(u,{icon:ne})," Reporte"]}),o.jsxs(te,{children:[o.jsxs(I,{onClick:Le,style:{cursor:"pointer",outline:"none",backgroundColor:"transparent",padding:"0.5rem 1rem",fontSize:"0.85rem",color:"#333",borderBottom:"1px solid #eaeaea",transition:"background-color 0.3s"},onMouseOver:e=>e.target.style.backgroundColor="#f5f5f5",onMouseOut:e=>e.target.style.backgroundColor="transparent",children:[o.jsx(u,{icon:ae,size:"sm"})," Abrir en PDF"]}),o.jsxs(I,{onClick:Oe,style:{cursor:"pointer",outline:"none",backgroundColor:"transparent",padding:"0.5rem 1rem",fontSize:"0.85rem",color:"#333",transition:"background-color 0.3s"},onMouseOver:e=>e.target.style.backgroundColor="#f5f5f5",onMouseOut:e=>e.target.style.backgroundColor="transparent",children:[o.jsx(u,{icon:se,size:"sm"})," Descargar Excel"]})]})]})]})]}),o.jsxs(ge,{visible:Ne,backdrop:"static",children:[o.jsx(xe,{onClick:()=>{F(!1),B(""),j("")},children:o.jsxs(fe,{children:["Asignar Ponderación a: ",o.jsx("strong",{children:T==null?void 0:T.Nombre_ciclo})]})}),o.jsxs(he,{children:[o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{children:o.jsx("strong",{children:"Seleccione una Ponderación:"})}),o.jsxs(le,{value:k,onChange:e=>B(e.target.value),children:[o.jsx("option",{value:"",children:"Seleccione una Ponderación"}),D.map(e=>o.jsx("option",{value:e.Cod_ponderacion,children:e.Descripcion_ponderacion},e.Cod_ponderacion))]})]}),o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{children:o.jsx("strong",{children:"Valor:"})}),o.jsx("input",{type:"number",min:.5,max:100,step:"0.5",value:z||"",onChange:e=>{const t=e.target.value;j(t)},onBlur:e=>{const t=parseFloat(e.target.value);isNaN(t)||t<.5?j(.5):t>100?j(100):j(t)},onKeyDown:e=>{!/[0-9.]/.test(e.key)&&e.key!=="Backspace"&&e.key!=="Delete"&&e.key!=="ArrowLeft"&&e.key!=="ArrowRight"&&e.preventDefault()},className:"form-control"})]})]}),o.jsxs(me,{children:[o.jsx(h,{color:"secondary",style:{fontSize:"0.85rem",cursor:"pointer"},onClick:()=>{F(!1),B(""),j("")},children:"Cancelar"}),o.jsxs(h,{style:{backgroundColor:"#4B6251",color:"white",fontSize:"0.85rem",cursor:"pointer"},onClick:Re,onMouseEnter:e=>e.currentTarget.style.backgroundColor="#3C4B43",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#4B6251",children:["Guardar ",o.jsx(u,{icon:to})]})]})]})]}):o.jsx(Ke,{})};export{Oo as default};
