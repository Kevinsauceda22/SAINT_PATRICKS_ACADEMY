import{r as a,o as z,j as t,L as y,i as b,h as E}from"./index-SVRFFNc9.js";import{Q as L,B as m}from"./react-toastify.esm-64G3A88x.js";/* empty css                      */import{l as _}from"./logo_saint_patrick-xw7Wl8f3.js";import{c as j}from"./createLucideIcon-CPQyE5BK.js";import{E as B,a as T}from"./eye-C-La4pM4.js";import"./clsx-B-dksMZM.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=j("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=j("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),U=()=>{const[p,v]=a.useState(!1),[x,u]=a.useState(!1),[D,g]=a.useState(!1),[r,W]=a.useState({identificador:"",contraseña_usuario:""}),[d,k]=a.useState({}),C=z();a.useEffect(()=>{localStorage.getItem("token")&&(window.location.href="/dashboard")},[]);const h=async e=>{g(!0),await new Promise(i=>setTimeout(i,300)),C(e)},w=e=>{const{name:i,value:l}=e.target;W(c=>({...c,[i]:l}))},S=async e=>{var l,c;e.preventDefault();const i={};if(r.identificador||(i.identificador="Identificador es requerido"),r.contraseña_usuario||(i.contraseña_usuario="Contraseña es requerida"),k(i),Object.keys(i).length===0){u(!0);try{const n=await b.post("http://74.50.68.87:4000/api/usuarios/login",{identificador:r.identificador,contraseña_usuario:r.contraseña_usuario,twoFactorCode:r.twoFactorCode});if(console.log("Respuesta completa del login:",n.data),n.data.token){localStorage.setItem("token",n.data.token);const s=E(n.data.token);console.log("Token decodificado:",s);try{if(!s.cod_usuario)throw console.error("Token decodificado:",s),new Error("No se pudo obtener el código de usuario del token");await b.post("http://74.50.68.87:4000/api/bitacora/registro",{cod_usuario:s.cod_usuario,cod_objeto:76,accion:"LOGIN",descripcion:`Inicio de sesión exitoso del usuario: ${r.identificador}`},{headers:{Authorization:`Bearer ${n.data.token}`}}),console.log("Registro en bitácora exitoso")}catch(I){console.error("Error al registrar en bitácora:",I),console.error("Token decodificado:",s)}const f=n.data.is_two_factor_enabled===1;console.log("Estado 2FA:",f),f?(localStorage.setItem("temp_identificador",r.identificador),await h("/2fa")):(await h("/dashboard"),n.data.is_two_factor_enabled===1&&m.info("Tu cuenta tiene autenticación de dos factores activada. Puedes configurarla en tu perfil.",{position:"top-right",autoClose:5e3}))}}catch(n){console.error("Error en el login:",n),m.error(((c=(l=n.response)==null?void 0:l.data)==null?void 0:c.mensaje)||"Error en el inicio de sesión",{position:"top-center",autoClose:5e3})}finally{u(!1)}}},o={container:{display:"flex",minHeight:"100vh",backgroundColor:"#f8fafc",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',flexDirection:window.innerWidth<=768?"column":"row"},leftPanel:{flex:window.innerWidth<=768?"none":"1",background:"linear-gradient(135deg, #bdecb6 0%, #a3d5a5 50%, #82c5a1 100%)",display:window.innerWidth<=768?"none":"flex",alignItems:"center",justifyContent:"center",padding:window.innerWidth<=768?"20px":"40px",color:"#065f46"},leftContent:{maxWidth:"440px",textAlign:"center",padding:window.innerWidth<=768?"20px":"0"},welcomeText:{fontSize:window.innerWidth<=768?"28px":"36px",fontWeight:"700",marginBottom:"16px"},welcomeDesc:{fontSize:window.innerWidth<=768?"16px":"18px",opacity:"0.9",marginBottom:window.innerWidth<=768?"20px":"40px"},illustration:{position:"relative",height:window.innerWidth<=768?"200px":"300px",display:"flex",alignItems:"center",justifyContent:"center"},rightPanel:{flex:window.innerWidth<=768?"auto":"1",display:"flex",alignItems:"center",justifyContent:"center",padding:window.innerWidth<=768?"20px":"40px",minHeight:window.innerWidth<=768?"100vh":"auto"},loginContainer:{width:"100%",maxWidth:window.innerWidth<=768?"100%":"440px",padding:window.innerWidth<=768?"20px":"40px"},logo:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",margintop:"24px",marginBottom:(window.innerWidth<=768,"10px")},logoCircle:{width:window.innerWidth<=768?"100px":"150px",height:window.innerWidth<=768?"100px":"150px",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"50%",overflow:"hidden",background:`url(${_}) no-repeat center center`,backgroundSize:"cover"},title:{fontSize:window.innerWidth<=768?"24px":"32px",fontWeight:"100",color:"#1e293b",marginBottom:"32px",textAlign:"center"},form:{display:"flex",flexDirection:"column",gap:window.innerWidth<=768?"16px":"24px",width:"100%"},inputGroup:{display:"flex",flexDirection:"column",gap:"8px",position:"relative",width:"100%"},label:{fontSize:"14px",fontWeight:"500",color:"#475569"},input:{padding:"12px 16px 12px 40px",borderRadius:"12px",border:"1px solid #e2e8f0",fontSize:window.innerWidth<=768?"14px":"16px",transition:"all 0.2s ease",outline:"none",width:"100%",boxSizing:"border-box"},inputIcon:{position:"absolute",left:"12px",top:"38px",color:"#94a3b8"},showPasswordButton:{position:"absolute",right:"12px",top:"38px",background:"none",border:"none",cursor:"pointer",color:"#94a3b8",padding:"0"},error:{color:"#ef4444",fontSize:"12px",marginTop:"4px"},forgotPassword:{fontSize:"14px",color:"#4f46e5",textDecoration:"none",alignSelf:"flex-end",cursor:"pointer"},loginButton:{padding:window.innerWidth<=768?"12px 20px":"14px 24px",backgroundColor:"#8add7b",color:"white",border:"none",borderRadius:"12px",fontSize:window.innerWidth<=768?"14px":"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 14px rgba(79, 70, 229, 0.15)",width:"100%",marginTop:window.innerWidth<=768?"16px":"24px"},divider:{display:"flex",alignItems:"center",margin:window.innerWidth<=768?"20px 0":"32px 0"},dividerLine:{flex:1,height:"1px",backgroundColor:"#e2e8f0"},dividerText:{padding:"0 16px",color:"#94a3b8",fontSize:"14px"},registerContainer:{textAlign:"center",backgroundColor:"#f8fafc",padding:window.innerWidth<=768?"16px":"24px",borderRadius:"16px",border:"2px dashed #e2e8f0"},registerText:{fontSize:window.innerWidth<=768?"14px":"16px",color:"#475569",marginBottom:window.innerWidth<=768?"12px":"16px"},registerButton:{padding:window.innerWidth<=768?"10px 20px":"12px 24px",backgroundColor:"#8add7b",color:"white",border:"2px solid #8add7b",borderRadius:"12px",fontSize:window.innerWidth<=768?"14px":"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",textDecoration:"none",display:"inline-block"}};return a.useEffect(()=>{const e=()=>{g(i=>!i)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),t.jsxs("div",{style:o.container,children:[t.jsx("div",{style:o.leftPanel,children:t.jsxs("div",{style:o.leftContent,children:[t.jsx("h1",{style:o.welcomeText,children:"Saint Patrick´s Academy"}),t.jsx("p",{style:o.welcomeDesc,children:"Superación, Integridad y Amor. Principios y valores que sentan la base de la educación que impartimos en Saint Patrick's Academy a nuestro alumnos."}),t.jsxs("div",{style:o.illustration,children:[t.jsx("div",{style:o.illustrationCircle}),t.jsx("div",{style:o.illustrationSquare})]})]})}),t.jsx("div",{style:o.rightPanel,children:t.jsxs("div",{style:o.loginContainer,children:[t.jsx("div",{style:o.logo,children:t.jsx("div",{style:o.logoCircle})}),t.jsx("h2",{style:o.title,children:"Iniciar Sesión"}),t.jsxs("form",{style:o.form,onSubmit:S,children:[t.jsxs("div",{style:o.inputGroup,children:[t.jsx("label",{style:o.label,htmlFor:"identificador",children:"Correo o Usuario"}),t.jsx("div",{style:o.inputIcon,children:t.jsx(F,{size:window.innerWidth<=768?16:20})}),t.jsx("input",{id:"identificador",name:"identificador",type:"text",required:!0,style:o.input,placeholder:"nombre@ejemplo.com",onChange:w,onFocus:e=>{e.target.style.borderColor="#8add7b",e.target.style.boxShadow="0 0 0 3px rgba(79, 70, 229, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.boxShadow="none"}}),d.identificador&&t.jsx("p",{style:o.error,children:d.identificador})]}),t.jsxs("div",{style:o.inputGroup,children:[t.jsx("label",{style:o.label,htmlFor:"password",children:"Contraseña"}),t.jsx("div",{style:o.inputIcon,children:t.jsx(P,{size:window.innerWidth<=768?16:20})}),t.jsx("input",{id:"password",name:"contraseña_usuario",type:p?"text":"password",required:!0,style:o.input,placeholder:"••••••••",onChange:w,onFocus:e=>{e.target.style.borderColor="#8add7b",e.target.style.boxShadow="0 0 0 3px rgba(79, 70, 229, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e2e8f0",e.target.style.boxShadow="none"}}),t.jsx("button",{type:"button",onClick:()=>v(!p),style:o.showPasswordButton,children:p?t.jsx(B,{size:window.innerWidth<=768?16:20}):t.jsx(T,{size:window.innerWidth<=768?16:20})}),d.contraseña_usuario&&t.jsx("p",{style:o.error,children:d.contraseña_usuario})]}),t.jsx(y,{to:"/Olvidecontraseña",style:o.forgotPassword,onMouseEnter:e=>e.target.style.textDecoration="underline",onMouseLeave:e=>e.target.style.textDecoration="none",children:"¿Olvidaste tu contraseña?"}),t.jsx("button",{type:"submit",style:o.loginButton,onMouseEnter:e=>{e.target.style.backgroundColor="#8add7b",e.target.style.transform=window.innerWidth<=768?"none":"translateY(-2px)",e.target.style.boxShadow="0 6px 20px rgba(79, 70, 229, 0.2)"},onMouseLeave:e=>{e.target.style.backgroundColor="#8add7b",e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 14px rgba(79, 70, 229, 0.15)"},disabled:x,children:x?"Iniciando sesión...":"Iniciar Sesión"}),t.jsxs("div",{style:o.divider,children:[t.jsx("div",{style:o.dividerLine}),t.jsx("span",{style:o.dividerText,children:"O"}),t.jsx("div",{style:o.dividerLine})]}),t.jsxs("div",{style:o.registerContainer,children:[t.jsx("p",{style:o.registerText,children:"¿Aún no tienes una cuenta?"}),t.jsx(y,{to:"/pre-Registro",style:o.registerButton,onMouseEnter:e=>{e.target.style.backgroundColor="#8add7b",e.target.style.color="white",e.target.style.transform=window.innerWidth<=768?"none":"translateY(-2px)"},onMouseLeave:e=>{e.target.style.backgroundColor="#8add7b",e.target.style.color="white",e.target.style.transform="translateY(0)"},children:"Regístrate ahora"})]})]})]})}),t.jsx(L,{position:window.innerWidth<=768?"bottom-center":"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})};export{U as default};
