import{r as m,o as qe,j as o,C as Ne,i as A}from"./index-SVRFFNc9.js";import{S as c}from"./sweetalert2.esm.all-D3pEHXw3.js";import{C as N}from"./index.esm-DWwMdKxH.js";import{E as Se}from"./jspdf.plugin.autotable-gke1D7B3.js";import{u as z,w as Ve}from"./xlsx-lwdk4T0U.js";import{l as We}from"./logo_saint_patrick-xw7Wl8f3.js";import{u as Je}from"./usePermission-BCWksQX7.js";import{C as Ke}from"./CContainer-BdNP0s3v.js";import{C as S,a as x}from"./CRow-Bf67u6lu.js";import{c as Qe}from"./cil-school-Bvyx_Ms4.js";import{C as I}from"./CFormSelect-CzT7g5tb.js";import{a as j}from"./CButton-D9GPTbB6.js";import{c as Xe}from"./cil-plus-D8mtC-W5.js";import{C as Ze,a as eo,b as oo,c as ye}from"./CDropdownToggle-DlfIUTmX.js";import{c as ro}from"./cil-file-CeQgYs_D.js";import{C as B}from"./CInputGroup-D-McUFva.js";import{C as H}from"./CInputGroupText-Cfu0fzaY.js";import{c as ao}from"./cil-search-CDkY_4k-.js";import{C as y}from"./CFormInput-B_gylY64.js";import{c as to}from"./cil-brush-alt-CV61lKqC.js";import{C as io,a as so,b as Ae,c as P,d as no,e as F}from"./CTable-98qqrSRH.js";import{c as co}from"./cil-info-CmGCY32x.js";import{C as lo}from"./CPagination-UopCEeNZ.js";import{C as mo,a as po,b as uo,c as ho}from"./CModalHeader-Bhtr3bZe.js";import{C as _o}from"./CModalTitle-M2mBvD_5.js";import{C as ie,a as se}from"./CCardBody-BwCgYaTs.js";import{c as go,a as xo}from"./cil-user-ZBkygg2e.js";import{c as fo}from"./cil-user-female-olbbcJqF.js";import{C as jo}from"./CCardTitle-BpfOpSSz.js";import{C as Co}from"./CCardText-DTroknJ6.js";import"./CFormControlWrapper-OEJgTi6e.js";import"./CFormControlValidation-CtDkyDfm.js";import"./CFormLabel-szm2Dda9.js";import"./CConditionalPortal-DwBsYzTA.js";import"./CBackdrop-BbuVwMMD.js";const bo=L=>{try{const p=L.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),O=decodeURIComponent(atob(p).split("").map(R=>`%${`00${R.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""));return JSON.parse(O)}catch($){return console.error("Error al decodificar el token JWT:",$),null}},ar=()=>{Je("Matricula");const[L,$]=m.useState(!0),[p,O]=m.useState({estados_matricula:[],tipos_matricula:[]}),[R,ne]=m.useState([]),[D,X]=m.useState(""),[we,G]=m.useState(""),[ve,U]=m.useState(""),[T,Y]=m.useState(1),[k,Z]=m.useState(""),[ce,le]=m.useState([]),[q,ee]=m.useState(""),[C,V]=m.useState(null),oe=qe();localStorage.getItem("token");const[g,b]=m.useState({fecha_matricula:"",cod_grado:"",cod_seccion:"",cod_estado_matricula:"",cod_periodo_matricula:(C==null?void 0:C.Cod_periodo_matricula)||"",cod_tipo_matricula:"",cod_hijo:"",primer_nombre_hijo:"",segundo_nombre_hijo:"",primer_apellido_hijo:"",segundo_apellido_hijo:"",fecha_nacimiento_hijo:"",nombre_completo_hijo:""}),[re,ae]=m.useState(!1),[M,Ee]=m.useState([]),[W,de]=m.useState(""),[w,J]=m.useState(0),[v,Pe]=m.useState(5),Fe=()=>Y(e=>e+1),Te=()=>Y(e=>e-1),ke=async()=>{try{const e=await A.get("http://localhost:4000/api/matricula/opciones"),{estados_matricula:r,tipos_matricula:t}=e.data;O({estados_matricula:r,tipos_matricula:t});const i=r.find(s=>s.Tipo==="Falta de Pago"),n=t.find(s=>s.Tipo==="Estandar");console.log("Estado predeterminado encontrado:",i),console.log("Tipo de matrícula predeterminado encontrado:",n),b(s=>({...s,cod_estado_matricula:(i==null?void 0:i.Cod_estado_matricula)||"",cod_tipo_matricula:(n==null?void 0:n.Cod_tipo_matricula)||""})),(!i||!n)&&c.fire("Advertencia","No se encontraron valores predeterminados. Verifique la configuración.","warning")}catch(e){console.error("Error al cargar las opciones:",e),c.fire("Error","Hubo un problema al cargar las opciones de matrícula.","error")}};m.useEffect(()=>{ke()},[]);const Me=e=>{const r=e.target.value;r==="porGrado"?oe("/matriculasPorGrado"):r==="porPeriodo"?oe("/matriculasPorPeriodo"):r==="porAnioAnterior"&&oe("/matriculasAnioAnterior")},$e=async()=>{var e;try{$(!0);const t=(await A.get("http://localhost:4000/api/matricula/opciones")).data;console.log("Opciones de matrícula recibidas:",t),t.periodos_matricula&&t.periodos_matricula.length>0?console.log("Periodos de matrícula activos:",t.periodos_matricula):console.log("No se encontraron períodos de matrícula activos");const i=(e=t.periodos_matricula)==null?void 0:e.find(n=>n.estado==="activo");i?(console.log("Período activo encontrado:",i),V(i),b(n=>({...n,cod_periodo_matricula:i.Cod_periodo_matricula}))):(console.log("No hay períodos activos disponibles."),V(null)),O(t)}catch(r){console.error("Error al cargar las opciones de matrícula:",r),c.fire("Error","Error al cargar las opciones de matrícula.","error")}finally{$(!1)}};m.useEffect(()=>{re&&b(e=>({...e,fecha_matricula:te()}))},[re]);const me=async()=>{try{const t=((await A.get("http://localhost:4000/api/matricula/matriculas")).data.data||[]).map(i=>{var s;const n=(s=p.periodos_matricula)==null?void 0:s.find(u=>String(u.Cod_periodo_matricula)===String(i.Cod_periodo_matricula));return{...i,Anio_academico:(n==null?void 0:n.Anio_academico)||"N/A"}});Ee(t)}catch(e){console.error("Error al obtener las matrículas:",e)}},De=async()=>{var e,r;if(!D){c.fire("Advertencia","Por favor, ingrese un DNI válido para el padre.","warning");return}try{const t=await A.get(`http://localhost:4000/api/matricula/hijos/${D}`),{padre:i,hijos:n}=t.data;if(!i||!i.Nombre_Padre){c.fire("Error","No se encontraron datos del padre.","error");return}if(!Array.isArray(n)||n.length===0){c.fire("Advertencia","No se encontraron hijos asociados.","warning"),G(i.Nombre_Padre||""),U(i.Apellido_Padre||""),ne([]);return}ne(n.map(s=>({...s,NombreCompleto:`${s.Primer_nombre} ${s.Segundo_nombre||""} ${s.Primer_apellido} ${s.Segundo_apellido||""}`.trim(),FechaNacimiento:s.fecha_nacimiento?new Date(s.fecha_nacimiento).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A"}))),G(i.Nombre_Padre||""),U(i.Apellido_Padre||"")}catch(t){console.error("Error al obtener los hijos asociados:",t),c.fire("Error",((r=(e=t.response)==null?void 0:e.data)==null?void 0:r.message)||"Hubo un problema al obtener los hijos asociados.","error")}};m.useEffect(()=>{(async()=>{try{const t=(await A.get("http://localhost:4000/api/matricula/opciones")).data.periodos_matricula.find(i=>i.estado==="activo");V(t)}catch(r){console.error("Error al cargar el período activo:",r)}})()},[]);const ze=async e=>{if(!e||!C){le([]);return}try{const r=await A.get(`http://localhost:4000/api/matricula/secciones/${e}`,{params:{cod_periodo_matricula:C.Cod_periodo_matricula}});console.log("Secciones obtenidas:",r.data.data),le(r.data.data||[])}catch(r){console.error("Error al obtener las secciones del grado seleccionado:",r),alert("Error al obtener las secciones del grado seleccionado")}},pe=async(e,r="")=>{try{const t=localStorage.getItem("token"),i=bo(t);if(!i){c.fire("Error","Token inválido o expirado. Por favor, inicie sesión nuevamente.","error");return}const n=i.cod_usuario,s=i.nombre_usuario;if(!n||!s){c.fire("Error","El token no contiene información válida del usuario.","error");return}const u=`El usuario: ${s} realizó la acción: ${e}. ${r}`;console.log("Datos para bitácora:",{cod_usuario:n,cod_objeto:77,accion:e,descripcion:u}),await A.post("http://localhost:4000/api/bitacora/registro",{cod_usuario:n,cod_objeto:77,accion:e,descripcion:u},{headers:{Authorization:`Bearer ${t}`}}),console.log("Registro en bitácora exitoso")}catch(t){console.error("Error al registrar en bitácora:",t.message),c.fire("Error","Hubo un problema al registrar en la bitácora.","error")}},Ie=async e=>{var a,f,d;e.preventDefault();const r={dni_padre:D,fecha_matricula:g.fecha_matricula,cod_grado:q,cod_seccion:k,cod_estado_matricula:g.cod_estado_matricula,cod_periodo_matricula:g.cod_periodo_matricula,cod_tipo_matricula:g.cod_tipo_matricula,cod_hijo:g.cod_hijo},i=["dni_padre","cod_grado","cod_seccion","cod_estado_matricula","cod_tipo_matricula","cod_hijo"].filter(l=>!r[l]);if(i.length>0){c.fire("Error",`Los siguientes campos son requeridos: ${i.join(", ")}.`,"error");return}if(!r.fecha_matricula){c.fire("Error","La fecha de matrícula no está asignada automáticamente.","error");return}const n=(a=p==null?void 0:p.periodos_matricula)==null?void 0:a.find(l=>l.Cod_periodo_matricula===r.cod_periodo_matricula),s=n==null?void 0:n.Anio_academico;if(M.some(l=>l.cod_hijo===r.cod_hijo&&l.anio_academico===s)){c.fire({title:"Advertencia",text:`El alumno ya está matriculado en el período académico ${s}. No se puede registrar más de una vez en el mismo período.`,icon:"warning"});return}try{const l=await A.post("http://localhost:4000/api/matricula/crearmatricula",r);if(l.status===201){const h=l.data.message;c.fire({title:"Éxito",text:h,icon:"success"}),await pe("INSERT",`Creó una matrícula para el estudiante con código ${r.cod_hijo} en el período ${r.cod_periodo_matricula}.`),ae(!1),Y(1),b({fecha_matricula:te(),cod_grado:"",cod_seccion:"",cod_estado_matricula:"",cod_periodo_matricula:"",cod_tipo_matricula:"",cod_hijo:"",primer_nombre_hijo:"",segundo_nombre_hijo:"",primer_apellido_hijo:"",segundo_apellido_hijo:"",fecha_nacimiento_hijo:""}),X(""),G(""),U(""),ee(""),Z(""),me()}}catch(l){const h=((d=(f=l.response)==null?void 0:f.data)==null?void 0:d.message)||l.message||"Error al crear la matrícula.";console.error("Error al crear la matrícula:",h),await pe("Error",`Error al crear matrícula: ${h}`),c.fire("Error",h,"error")}},te=()=>{const e=new Date,r=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${t}-${i}`},Be=e=>{de(e.target.value.toLowerCase()),J(0)},He=e=>{const r=e.target.value;b(i=>({...i,cod_hijo:r}));const t=R.find(i=>i.Cod_persona===parseInt(r,10));t&&b(i=>{var n;return{...i,nombre_completo_hijo:`${t.Primer_nombre} ${t.Segundo_nombre||""} ${t.Primer_apellido} ${t.Segundo_apellido||""}`.trim(),fecha_nacimiento_hijo:((n=t.fecha_nacimiento)==null?void 0:n.split("T")[0])||"N/A"}})},K=M.filter(e=>e.codificacion_matricula.toLowerCase().includes(W)),ue=(w+1)*v,he=ue-v,Le=K.slice(he,ue);m.useEffect(()=>{$e(),me()},[]);const Oe=()=>{const e=new Se,r=new Image;r.src=We,r.onload=()=>{e.addImage(r,"PNG",10,10,30,30),e.setFontSize(18),e.setTextColor(0,102,51),e.text("SAINT PATRICK'S ACADEMY",e.internal.pageSize.width/2,20,{align:"center"}),e.setFontSize(14),e.text("Reporte General de Matrículas",e.internal.pageSize.width/2,30,{align:"center"}),e.setFontSize(10),e.setTextColor(100),e.text("Casa Club del periodista, Colonia del Periodista",e.internal.pageSize.width/2,40,{align:"center"}),e.text("Teléfono: (504) 2234-8871",e.internal.pageSize.width/2,45,{align:"center"}),e.text("Correo: info@saintpatrickacademy.edu",e.internal.pageSize.width/2,50,{align:"center"}),e.setLineWidth(.5),e.setDrawColor(0,102,51),e.line(10,55,e.internal.pageSize.width-10,55),e.setFontSize(12),e.setTextColor(0,51,102),e.text("Detalles de Matrículas",e.internal.pageSize.width/2,65,{align:"center"}),e.autoTable({startY:75,head:[["#","Cod Matrícula","Fecha Matrícula","Estado","Período","Grado","Sección"]],body:M.map((s,u)=>{var a,f,d,l;return[u+1,s.codificacion_matricula,s.fecha_matricula.split("T")[0],((f=(a=p.estados_matricula)==null?void 0:a.find(h=>h.Cod_estado_matricula===s.Cod_estado_matricula))==null?void 0:f.Tipo)||"N/A",((l=(d=p.periodos_matricula)==null?void 0:d.find(h=>h.Cod_periodo_matricula===s.Cod_periodo_matricula))==null?void 0:l.Anio_academico)||"N/A",s.Nombre_grado||"N/A",s.Nombre_seccion||"N/A"]}),styles:{fontSize:10,textColor:[34,34,34],cellPadding:4,valign:"middle",overflow:"linebreak"},headStyles:{fillColor:[0,102,51],textColor:[255,255,255],fontSize:10},alternateRowStyles:{fillColor:[240,248,255]},margin:{left:10,right:10}});const t=e.internal.getNumberOfPages();for(let s=1;s<=t;s++){e.setPage(s);const u=new Date().toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});e.setFontSize(10),e.setTextColor(100),e.text(`Fecha y Hora de Generación: ${u}`,10,e.internal.pageSize.height-10),e.text(`Página ${s} de ${t}`,e.internal.pageSize.width-30,e.internal.pageSize.height-10,{align:"right"})}const i=e.output("blob"),n=URL.createObjectURL(i);window.open(n)},r.onerror=()=>{c.fire("Error","No se pudo cargar el logo.","error")}},Re=()=>{const e=z.book_new(),r=[["#","Cod Matrícula","Fecha Matrícula","Estado","Período","Grado","Sección"],...M.map((s,u)=>{var a,f,d,l;return[u+1,s.codificacion_matricula,s.fecha_matricula.split("T")[0],((f=(a=p.estados_matricula)==null?void 0:a.find(h=>h.Cod_estado_matricula===s.Cod_estado_matricula))==null?void 0:f.Tipo)||"N/A",((l=(d=p.periodos_matricula)==null?void 0:d.find(h=>h.Cod_periodo_matricula===s.Cod_periodo_matricula))==null?void 0:l.Anio_academico)||"N/A",s.Nombre_grado||"N/A",s.Nombre_seccion||"N/A"]})],t=z.aoa_to_sheet(r),i=z.decode_range(t["!ref"]);for(let s=i.s.c;s<=i.e.c;++s){const u=z.encode_cell({r:0,c:s});t[u]&&(t[u].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"16A085"}},alignment:{horizontal:"center",vertical:"center"}})}const n=[{wpx:30},{wpx:100},{wpx:100},{wpx:80},{wpx:80},{wpx:80},{wpx:80}];t["!cols"]=n,z.book_append_sheet(e,t,"Matrículas"),Ve(e,"Reporte_General_Matriculas.xlsx")},_e=Math.ceil(K.length/v),Ge=async e=>{try{c.fire({title:"Generando PDF...",text:"Por favor espera mientras se completan los datos.",allowOutsideClick:!1,didOpen:()=>{c.showLoading()}});const i=async d=>{try{const l=await fetch(`http://localhost:4000/api/matricula/secciones/${e.Cod_grado}?cod_periodo_matricula=${e.Cod_periodo_matricula}`);if(l.ok){const E=(await l.json()).data.find(Q=>Q.Cod_secciones===d);return E&&E.Nombre_profesor?`${E.Nombre_profesor} ${E.Apellido_profesor||""}`.trim():"Sin Maestro Asignado"}else return console.warn("Error al obtener las secciones."),"Error al obtener el maestro"}catch(l){return console.error("Error al obtener el maestro:",l),"Error al obtener el maestro"}};let n={};try{const d=await fetch("http://localhost:4000/api/matricula/opciones");d.ok?n=await d.json():console.warn("Error al obtener las opciones de matrícula")}catch(d){console.error("Error al obtener las opciones de matrícula:",d.message)}let s=[],u="N/A";if(e.Cod_seccion)try{const d=await fetch(`http://localhost:4000/api/matricula/horario/${e.Cod_seccion}`);d.ok?(s=(await d.json()).data||[],u=await i(e.Cod_seccion)):console.warn("Error al obtener los horarios de la sección")}catch(d){console.error("Error al obtener los datos del horario:",d.message)}e.Cod_seccion||(e.Nombre_seccion="Sin Asignar",e.Cod_seccion="N/A");const a=new Se,f=new Image;f.src=e.logo||"./src/assets/brand/logo_saint_patrick.png",f.onload=()=>{var E,Q,ge,xe,fe,je,Ce,be;a.addImage(f,"PNG",10,10,30,30),a.setFontSize(18),a.setTextColor(0,102,51),a.text("SAINT PATRICK'S ACADEMY",a.internal.pageSize.width/2,20,{align:"center"}),a.setFontSize(14),a.text("Detalle de Matrícula y Horarios",a.internal.pageSize.width/2,30,{align:"center"}),a.setFontSize(10),a.setTextColor(100),a.text("Casa Club del periodista, Colonia del Periodista",a.internal.pageSize.width/2,40,{align:"center"}),a.text("Teléfono: (504) 2234-8871",a.internal.pageSize.width/2,45,{align:"center"}),a.text("Correo: info@saintpatrickacademy.edu",a.internal.pageSize.width/2,50,{align:"center"}),a.setDrawColor(0,102,51),a.setLineWidth(.5),a.line(10,55,a.internal.pageSize.width-10,55),a.setFontSize(12),a.setTextColor(0),a.text("Información del Estudiante:",10,65),a.setFontSize(10),a.text(`Código de Matrícula: ${e.codificacion_matricula||"N/A"}`,10,75),a.text(`Fecha de Matrícula: ${((E=e.fecha_matricula)==null?void 0:E.split("T")[0])||"N/A"}`,10,80),a.text(`Nombre Completo: ${[e.Nombre_Hijo||"N/A",e.Segundo_nombre_Hijo||"",e.Apellido_Hijo||"N/A",e.Segundo_apellido_Hijo||""].filter(Boolean).join(" ")}`,10,85),a.text(`Fecha de Nacimiento: ${((Q=e.fecha_nacimiento_hijo)==null?void 0:Q.split("T")[0])||"N/A"}`,10,90),a.text(`Padre/Madre/Tutor: ${e.Nombre_Padre||"N/A"} ${e.Apellido_Padre||"N/A"}`,10,95),a.setFontSize(12),a.setTextColor(0,102,51),a.text("Detalles de Matrícula:",10,105),a.autoTable({startY:110,head:[["Campo","Valor"]],body:[["Estado",((xe=(ge=n.estados_matricula)==null?void 0:ge.find(_=>_.Cod_estado_matricula===e.Cod_estado_matricula))==null?void 0:xe.Tipo)||"N/A"],["Período",((je=(fe=n.periodos_matricula)==null?void 0:fe.find(_=>_.Cod_periodo_matricula===e.Cod_periodo_matricula))==null?void 0:je.Anio_academico)||"N/A"],["Tipo de Matrícula",((be=(Ce=n.tipos_matricula)==null?void 0:Ce.find(_=>_.Cod_tipo_matricula===e.Cod_tipo_matricula))==null?void 0:be.Tipo)||"N/A"],["Grado",e.Nombre_grado||"N/A"],["Sección",e.Nombre_seccion||"N/A"],["Maestro",u]],styles:{fontSize:10},headStyles:{fillColor:[0,102,51],textColor:[255,255,255]}}),a.setFontSize(12),a.setTextColor(0,102,51),a.text("Horario de Clases:",10,a.lastAutoTable.finalY+15),a.autoTable({startY:a.lastAutoTable.finalY+20,head:[["Asignatura","Día","Hora Inicio","Hora Fin"]],body:s.length>0?s.map(_=>[_.Nombre_asignatura||"N/A",_.Nombre_dia||"N/A",_.Hora_inicio||"N/A",_.Hora_fin||"N/A"]):[["No hay horarios disponibles","","",""]],styles:{fontSize:10},headStyles:{fillColor:[0,102,51],textColor:[255,255,255]}});const d=a.internal.getNumberOfPages();for(let _=1;_<=d;_++){a.setPage(_);const Ye=new Date().toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});a.setFontSize(10),a.setTextColor(100),a.text(`Fecha y Hora de Generación: ${Ye}`,10,a.internal.pageSize.height-10),a.text(`Página ${_} de ${d}`,a.internal.pageSize.width-30,a.internal.pageSize.height-10,{align:"right"})}c.close();const l=a.output("blob"),h=URL.createObjectURL(l);window.open(h,"_blank")},f.onerror=()=>{c.fire("Error","No se pudo cargar el logo.","error")}}catch(i){console.error("Error al generar el PDF:",i),c.fire("Error","No se pudo generar el PDF. Intente nuevamente.","error")}Math.ceil(K.length/v);const r=(w+1)*v,t=r-v;K.slice(t,r)};m.useEffect(()=>{p.periodos_activos&&p.periodos_activos.length>0&&V(p.periodos_activos[0])},[p.periodos_activos]);const Ue=e=>{if(!e)return"N/A";const r=new Date,t=new Date(e);let i=r.getFullYear()-t.getFullYear();const n=r.getMonth()-t.getMonth();return(n<0||n===0&&r.getDate()<t.getDate())&&i--,`${i} años`};return o.jsxs(Ke,{children:[o.jsx(S,{className:"justify-content-center mb-2",children:o.jsx(x,{xs:"auto",children:o.jsxs("h3",{style:{margin:0,fontWeight:"bold",color:"#4B6251",textAlign:"center"},children:[o.jsx(N,{icon:Qe,size:"lg",style:{color:"#4B6251",marginRight:"0.5rem"}}),"Matrículas"]})})}),o.jsx("div",{style:{width:"100%",height:"2px",backgroundColor:"#4B6251",marginBottom:"1rem"}}),o.jsxs(S,{className:"justify-content-between align-items-center mb-4",children:[o.jsx(x,{xs:12,md:6,className:"d-flex align-items-center",children:o.jsxs(I,{onChange:Me,defaultValue:"",style:{width:"250px",borderRadius:"10px",backgroundColor:"#f5f5f5",color:"#333",border:"1px solid #ccc",padding:"0.5rem",transition:"all 0.3s"},className:"custom-select",onMouseEnter:e=>e.target.style.backgroundColor="#e0e0e0",onMouseLeave:e=>e.target.style.backgroundColor="#f5f5f5",children:[o.jsx("option",{value:"",disabled:!0,children:"Seleccione una opción"}),o.jsx("option",{value:"porGrado",children:"Matrículas por Grado"}),o.jsx("option",{value:"porPeriodo",children:"Matrículas por Secciones"}),o.jsx("option",{value:"porAnioAnterior",children:"Matrículas de Años Anteriores"})]})}),o.jsxs(x,{xs:12,md:6,className:"d-flex justify-content-end align-items-center",children:[o.jsxs(j,{color:"dark",onClick:()=>{var r;((r=p.periodos_matricula)==null?void 0:r.some(t=>t.estado==="activo"))?ae(!0):c.fire("Advertencia","No hay un período de matrícula activo.","warning")},className:"me-2",style:{backgroundColor:"#4B6251",borderColor:"#0F463A"},children:[o.jsx(N,{icon:Xe})," Nueva"]}),o.jsxs(Ze,{children:[o.jsxs(eo,{color:"success",style:{backgroundColor:"#6C8E58",borderColor:"#617341"},children:[o.jsx(N,{icon:ro})," Reporte"]}),o.jsxs(oo,{children:[o.jsx(ye,{onClick:()=>{M.filter(e=>`${e.Nombre_Padre} ${e.Apellido_Padre}`.toLowerCase().includes(W.toLowerCase())),Oe()},children:"Exportar a PDF"}),o.jsx(ye,{onClick:()=>{M.filter(e=>`${e.Nombre_Padre} ${e.Apellido_Padre}`.toLowerCase().includes(W.toLowerCase())),Re()},children:"Exportar a Excel"})]})]})]})]}),o.jsxs(S,{className:"align-items-center mb-4",children:[o.jsx(x,{md:6,className:"d-flex align-items-center",children:o.jsxs(B,{children:[o.jsx(H,{children:o.jsx(N,{icon:ao})}),o.jsx(y,{placeholder:"Buscar matrícula",value:W,onChange:Be}),o.jsxs(j,{color:"secondary",onClick:()=>de(""),children:[o.jsx(N,{icon:to})," Limpiar"]})]})}),o.jsxs(x,{md:6,className:"d-flex justify-content-end align-items-center",children:[o.jsx("span",{className:"me-1",children:"Mostrar"}),o.jsxs(I,{value:v,onChange:e=>{Pe(Number(e.target.value)),J(0)},style:{width:"100px"},children:[o.jsx("option",{value:"5",children:"5"}),o.jsx("option",{value:"10",children:"10"}),o.jsx("option",{value:"20",children:"20"})]}),o.jsx("span",{className:"ms-1",children:"registros"})]})]}),L?o.jsx(Ne,{color:"primary"}):o.jsx("div",{className:"table-container",children:o.jsxs(io,{striped:!0,responsive:!0,bordered:!0,hover:!0,style:{textTransform:"uppercase"},children:[o.jsx(so,{children:o.jsxs(Ae,{children:[o.jsx(P,{children:"#"}),o.jsx(P,{children:"Cod Matrícula"}),o.jsx(P,{children:"Nombre Estudiante"}),o.jsx(P,{children:"Fecha Matrícula"}),o.jsx(P,{children:"Estado"}),o.jsx(P,{children:"Período"}),o.jsx(P,{children:"Acciones"})]})}),o.jsx(no,{children:Le.map((e,r)=>{var s,u;const t=(s=p.estados_matricula)==null?void 0:s.find(a=>a.Cod_estado_matricula===e.Cod_estado_matricula),i=(u=p.periodos_matricula)==null?void 0:u.find(a=>String(a.Cod_periodo_matricula)===String(e.Cod_periodo_matricula)),n=(i==null?void 0:i.Anio_academico)||"N/A";return o.jsxs(Ae,{children:[o.jsx(F,{children:r+1+he}),o.jsx(F,{children:e.codificacion_matricula}),o.jsxs(F,{children:[e.Nombre_Hijo," ",e.Apellido_Hijo]}),o.jsx(F,{children:e.fecha_matricula.split("T")[0]}),o.jsx(F,{children:(t==null?void 0:t.Tipo)||"N/A"}),o.jsx(F,{children:n}),o.jsx(F,{children:o.jsx(j,{color:"info",onClick:()=>Ge(e),children:o.jsx(N,{icon:co})})})]},e.Cod_matricula)})})]})}),o.jsxs("nav",{className:"d-flex justify-content-center align-items-center mt-4",children:[o.jsxs(lo,{className:"mb-0",style:{gap:"0.3cm"},children:[o.jsx(j,{style:{backgroundColor:"gray",color:"white",marginRight:"0.3cm"},disabled:w===0,onClick:()=>J(w-1),children:"Anterior"}),o.jsx(j,{style:{backgroundColor:"gray",color:"white"},disabled:w===_e-1,onClick:()=>J(w+1),children:"Siguiente"})]}),o.jsxs("span",{className:"mx-2",children:["Página ",w+1," de ",_e]})]}),o.jsxs(mo,{visible:re,onClose:()=>{ae(!1),Y(1),b(e=>({...e,fecha_matricula:te(),cod_grado:"",cod_seccion:"",cod_hijo:"",primer_nombre_hijo:"",segundo_nombre_hijo:"",primer_apellido_hijo:"",segundo_apellido_hijo:"",fecha_nacimiento_hijo:""})),X(""),G(""),U(""),ee(""),Z("")},backdrop:"static",size:"md",children:[o.jsx(po,{closeButton:!0,children:o.jsxs(_o,{children:["Registrar Nueva Matrícula - Paso ",T]})}),o.jsx(uo,{children:C?o.jsxs(o.Fragment,{children:[T===1&&o.jsxs("div",{children:[o.jsx(ie,{className:"mb-4",children:o.jsxs(se,{children:[o.jsx("h5",{children:"Información del Padre"}),o.jsx("hr",{}),o.jsxs(B,{className:"mb-3",children:[o.jsx(H,{children:o.jsx(N,{icon:go})}),o.jsx(y,{type:"text",placeholder:"DNI",value:D,onChange:e=>{const r=e.target.value;/^\d*$/.test(r)&&r.length<=13?X(r):r.length>13?c.fire("Advertencia","El DNI no puede tener más de 13 dígitos.","warning"):c.fire("Advertencia","Solo se permiten números en este campo.","warning")},onBlur:()=>{D.length!==13?c.fire("Error","El DNI debe tener exactamente 13 dígitos.","error"):De()},onKeyPress:e=>{const r=e.which||e.keyCode;(r<48||r>57)&&e.preventDefault()},onPaste:e=>{e.preventDefault(),c.fire("Advertencia","No se permite pegar en este campo.","warning")},onCopy:e=>{e.preventDefault(),c.fire("Advertencia","No se permite copiar en este campo.","warning")},required:!0})]}),o.jsxs(S,{className:"mb-3",children:[o.jsxs(x,{children:[o.jsx("label",{children:"Nombre del Padre"}),o.jsx(y,{type:"text",value:we,readOnly:!0})]}),o.jsxs(x,{children:[o.jsx("label",{children:"Apellido del Padre"}),o.jsx(y,{type:"text",value:ve,readOnly:!0})]})]})]})}),o.jsx(ie,{className:"mb-4",children:o.jsxs(se,{children:[o.jsx("h5",{children:"Información del Hijo"}),o.jsx("hr",{}),o.jsxs(B,{className:"mb-3",children:[o.jsx(H,{children:o.jsx(N,{icon:fo})}),o.jsxs(I,{name:"cod_hijo",onChange:He,value:g.cod_hijo,required:!0,children:[o.jsx("option",{value:"",children:"Selecciona el hijo"}),R.map(e=>o.jsx("option",{value:e.Cod_persona,children:`${e.Primer_nombre} ${e.Segundo_nombre||""} ${e.Primer_apellido} ${e.Segundo_apellido||""} - DNI: ${e.dni_persona}`},e.Cod_persona))]})]}),o.jsx(S,{className:"mb-3",children:o.jsxs(x,{children:[o.jsx("label",{children:"Nombre Completo"}),o.jsx(y,{type:"text",value:g.nombre_completo_hijo,readOnly:!0})]})}),o.jsxs(S,{className:"mb-3",children:[o.jsxs(x,{children:[o.jsx("label",{children:"Fecha de Nacimiento"}),o.jsxs(B,{className:"mb-3",children:[o.jsx(H,{children:o.jsx(N,{icon:xo})}),o.jsx(y,{type:"date",value:g.fecha_nacimiento_hijo,readOnly:!0})]})]}),o.jsxs(x,{children:[o.jsx("label",{children:"Edad"}),o.jsx(y,{type:"text",value:Ue(g.fecha_nacimiento_hijo),readOnly:!0})]})]})]})})]}),T===2&&o.jsxs("div",{children:[o.jsx("h5",{children:"Información Académica"}),o.jsx("hr",{}),o.jsx(S,{className:"mb-3",children:o.jsxs(x,{children:[o.jsx("label",{children:"Fecha de Matrícula"}),o.jsx(y,{type:"date",name:"fecha_matricula",value:g.fecha_matricula,readOnly:!0,required:!0})]})}),o.jsxs("div",{className:"mb-3",children:[o.jsx("h6",{children:"Elije Grado"}),p.grados.map(e=>o.jsx(j,{color:q===e.Cod_grado?"dark":"secondary",onClick:()=>{ee(e.Cod_grado),ze(e.Cod_grado)},className:"m-1",style:{backgroundColor:q===e.Cod_grado?"#4B6251":"#6C757D",borderColor:q===e.Cod_grado?"#0F463A":"#495057",color:"#FFF"},children:e.Nombre_grado},e.Cod_grado))]}),o.jsxs(S,{className:"mt-3",children:[o.jsx("h6",{children:"Elije Sección"}),L?o.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100px"},children:[o.jsx(Ne,{color:"primary"})," "]}):ce.length>0?ce.map(e=>o.jsx(x,{md:6,lg:4,className:"mb-3",children:o.jsx(ie,{className:k===e.Cod_secciones?"border-primary":"",style:{borderColor:k===e.Cod_secciones?"#0F463A":"#CED4DA",backgroundColor:k===e.Cod_secciones?"#4B6251":"#FFF"},children:o.jsxs(se,{children:[o.jsx(jo,{style:{color:k===e.Cod_secciones?"#FFF":"#000"},children:e.Nombre_seccion}),o.jsxs(Co,{style:{color:k===e.Cod_secciones?"#FFF":"#000"},children:[o.jsx("strong",{children:"Aula:"})," ",e.Numero_aula||"No disponible"," ",o.jsx("br",{}),o.jsx("strong",{children:"Edificio:"})," ",e.Nombre_edificios||"No disponible"," ",o.jsx("br",{}),o.jsx("strong",{children:"Profesor:"})," ",e.Nombre_profesor?`${e.Nombre_profesor} ${e.Apellido_profesor}`:"No disponible"," ",o.jsx("br",{})]}),o.jsx(j,{color:"primary",onClick:()=>Z(e.Cod_secciones),style:{backgroundColor:"#4B6251",borderColor:"#0F463A",color:"#FFF"},children:"Elije Sección"})]})})},e.Cod_secciones)):o.jsx("p",{children:"No hay secciones disponibles para el grado seleccionado."})]})]}),T===3&&o.jsxs("div",{children:[o.jsx("h5",{children:"Estado, Período y Tipo de Matrícula"}),o.jsx("hr",{}),o.jsxs(S,{className:"mb-3",children:[o.jsxs(x,{children:[o.jsx("label",{children:"Estado de Matrícula"}),o.jsxs(I,{name:"cod_estado_matricula",value:g.cod_estado_matricula,onChange:e=>b({...g,cod_estado_matricula:e.target.value}),required:!0,children:[o.jsx("option",{value:"",disabled:!0,children:"Selecciona el Estado"}),p.estados_matricula.map(e=>o.jsx("option",{value:e.Cod_estado_matricula,children:e.Tipo},e.Cod_estado_matricula))]})]}),o.jsxs(x,{children:[o.jsx("label",{children:"Período Académico"}),o.jsx(y,{type:"text",value:C?C.Anio_academico:"No disponible",readOnly:!0})]})]}),o.jsxs(B,{className:"mb-3",children:[o.jsx(H,{children:"Tipo Matrícula"}),o.jsxs(I,{name:"cod_tipo_matricula",value:g.cod_tipo_matricula,onChange:e=>b({...g,cod_tipo_matricula:e.target.value}),required:!0,children:[o.jsx("option",{value:"",disabled:!0,children:"Selecciona el Tipo de Matrícula"}),p.tipos_matricula.map(e=>o.jsx("option",{value:e.Cod_tipo_matricula,children:e.Tipo},e.Cod_tipo_matricula))]})]})]})]}):o.jsxs("div",{children:[o.jsx("h5",{children:"No hay un período de matrícula activo en este momento."}),o.jsx("p",{children:"Por favor, contacte a la administración para más detalles."})]})}),o.jsxs(ho,{children:[T>1&&o.jsx(j,{color:"secondary",onClick:Te,children:"Atrás"}),T<3?o.jsx(j,{style:{backgroundColor:"#4B6251",borderColor:"#4B6251",color:"#ffffff"},onClick:Fe,children:"Siguiente"}):o.jsx(j,{style:{backgroundColor:"#4B6251",borderColor:"#4B6251",color:"#ffffff"},onClick:Ie,disabled:!C,children:"Guardar"})]})]}),o.jsx("style",{jsx:!0,children:`
        .table-container {
          max-height: 400px;
          overflow-y: auto;
        }

        .table-container::-webkit-scrollbar {
          width: 8px;
        }

        .table-container::-webkit-scrollbar-thumb {
          background-color: #6c757d;
          border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
          background-color: #4B6251;
        }
      `})]})};export{bo as decodeJWT,ar as default};
