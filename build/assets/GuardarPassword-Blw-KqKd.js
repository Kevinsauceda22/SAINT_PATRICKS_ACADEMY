import{r as e,A as B,o as q,j as s,i as _}from"./index-SVRFFNc9.js";import{S as x}from"./sweetalert2.esm.all-D3pEHXw3.js";import{E as f,a as j}from"./eye-C-La4pM4.js";import{c as b}from"./createLucideIcon-CPQyE5BK.js";import{C as G}from"./copy-Bvy9txOW.js";import{C as g}from"./check-CzPZpIZL.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=b("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=b("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),J=()=>{const[r,d]=e.useState(""),[p,u]=e.useState(""),[m,t]=e.useState(""),[i,C]=e.useState(!1),[l,y]=e.useState(!1),[N,h]=e.useState(!1),[v,w]=e.useState(!1),{auth:k,setAuth:S}=e.useContext(B),z=q(),P=a=>{d(a.target.value),t("")},E=a=>{u(a.target.value),t("")},A=()=>{const a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+";let o="";for(let n=0;n<12;n++)o+=a[Math.floor(Math.random()*a.length)];d(o),u(o),t(""),h(!0),setTimeout(()=>h(!1),3e3)},M=()=>{navigator.clipboard.writeText(r),w(!0),setTimeout(()=>w(!1),3e3)},L=async a=>{var o,n;if(a.preventDefault(),r!==p){t("Las contraseñas no coinciden");return}if(r.includes(" ")){t("La contraseña no debe contener espacios");return}if(r.length<8){t("La contraseña debe tener al menos 8 caracteres");return}try{const c=localStorage.getItem("token");(await _.put("http://localhost:4000/api/usuarios/actualizar-password-temporal",{cod_usuario:k.cod_usuario,nueva_contraseña:r},{headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"}})).data.status&&(S(T=>({...T,password_temporal:0})),await x.fire({title:"¡Éxito!",text:"Haz actualizado tus credenciales correctamente, usarás esta contraseña para poder ingresar al sistema",icon:"success",confirmButtonText:"Entendido",customClass:{popup:"swal2-popup-custom",confirmButton:"swal2-confirm-custom"}}),z("/"))}catch(c){console.error("Error al actualizar la contraseña:",c),x.fire({title:"Error",text:((n=(o=c.response)==null?void 0:o.data)==null?void 0:n.mensaje)||"Error al actualizar la contraseña",icon:"error",confirmButtonText:"Aceptar"})}};return s.jsx("div",{className:"change-password-wrapper",children:s.jsxs("div",{className:"change-password-container",children:[s.jsx("div",{className:"logo-wrapper",children:s.jsx("img",{src:"https://i.ibb.co/58kBnCh/Logo.png",alt:"Logo Escuela",className:"school-logo"})}),s.jsxs("div",{className:"password-header",children:[s.jsx("h2",{className:"password-title",children:"Cambiar Contraseña Temporal"}),s.jsx("p",{className:"password-description",children:"Estás a punto de cambiar tu contraseña temporal por una contraseña propia. Asegúrate de elegir una contraseña segura y fácil de recordar."})]}),s.jsxs("form",{onSubmit:L,className:"password-form",children:[s.jsxs("div",{className:"password-form-group",children:[s.jsx("label",{htmlFor:"password",className:"password-label",children:"Nueva Contraseña"}),s.jsxs("div",{className:"input-wrapper",children:[s.jsx("input",{type:i?"text":"password",id:"password",value:r,onChange:P,className:"password-input-field",required:!0}),s.jsx("button",{type:"button",onClick:()=>C(!i),className:"toggle-password-btn",children:i?s.jsx(f,{size:20}):s.jsx(j,{size:20})})]}),s.jsxs("div",{className:"password-actions",children:[s.jsxs("button",{type:"button",onClick:A,className:"password-action-btn",children:[s.jsx(F,{size:16}),"Generar"]}),s.jsxs("button",{type:"button",onClick:M,className:"password-action-btn",children:[s.jsx(G,{size:16}),"Copiar"]})]})]}),s.jsxs("div",{className:"password-form-group",children:[s.jsx("label",{htmlFor:"confirmPassword",className:"password-label",children:"Confirmar Contraseña"}),s.jsxs("div",{className:"input-wrapper",children:[s.jsx("input",{type:l?"text":"password",id:"confirmPassword",value:p,onChange:E,className:"password-input-field",required:!0}),s.jsx("button",{type:"button",onClick:()=>y(!l),className:"toggle-password-btn",children:l?s.jsx(f,{size:20}):s.jsx(j,{size:20})})]})]}),m&&s.jsx("div",{className:"password-error",children:m}),N&&s.jsxs("div",{className:"password-alert alert-success",children:[s.jsx(g,{size:16}),s.jsx("span",{children:"Contraseña generada exitosamente"})]}),v&&s.jsxs("div",{className:"password-alert alert-info",children:[s.jsx(g,{size:16}),s.jsx("span",{children:"Contraseña copiada al portapapeles"})]}),s.jsxs("button",{type:"submit",className:"submit-password-btn",children:[s.jsx(H,{size:20}),"Cambiar Contraseña"]})]}),s.jsx("p",{className:"password-help",children:"Si tienes algún problema al cambiar tu contraseña, por favor comunícate con un administrador."})]})})};export{J as default};
