import{r as d,x as Xt,j as t,C as Kt,h as Ie}from"./index-SVRFFNc9.js";import{C as g}from"./index.esm-DWwMdKxH.js";import{S as m}from"./sweetalert2.esm.all-D3pEHXw3.js";import{l as He}from"./logo_saint_patrick-xw7Wl8f3.js";import{E as We}from"./jspdf.plugin.autotable-gke1D7B3.js";import{u as y,w as Ye}from"./xlsx-lwdk4T0U.js";import{u as Zt}from"./usePermission-BCWksQX7.js";import Qt from"./AccessDenied-yaDW3Jao.js";import{C as eo}from"./CContainer-BdNP0s3v.js";import{C as k,a as b}from"./CRow-Bf67u6lu.js";import{C as Ge,a as qe,b as Ue,c as te}from"./CDropdownToggle-DlfIUTmX.js";import{c as Ve}from"./cil-description-MUzg6O3n.js";import{c as Je}from"./cil-file-CeQgYs_D.js";import{c as Xe}from"./cil-spreadsheet-CJUvf_vM.js";import{C as B}from"./CInputGroup-D-McUFva.js";import{C as to}from"./CInputGroupText-Cfu0fzaY.js";import{c as Ke}from"./cil-search-CDkY_4k-.js";import{C as L}from"./CFormInput-B_gylY64.js";import{a as x}from"./CButton-D9GPTbB6.js";import{c as oo}from"./cil-brush-alt-CV61lKqC.js";import{C as I}from"./CFormSelect-CzT7g5tb.js";import{C as H,a as Ze,b as v,c as u,d as W,e as p}from"./CTable-98qqrSRH.js";import{C as Qe}from"./CPagination-UopCEeNZ.js";import{c as ao}from"./cil-arrow-left-D66Kb3Zq.js";import{c as so}from"./cil-plus-D8mtC-W5.js";import{c as et}from"./cil-pen-53d2I-C-.js";import{c as ro}from"./cil-info-CmGCY32x.js";import{C as ue,a as xe,b as he,c as ge}from"./CModalHeader-Bhtr3bZe.js";import{C as tt}from"./CPopover-C-sLBJgI.js";import{c as ot}from"./cil-pencil-m516yCOw.js";import{c as no}from"./cil-save-CHBg7z_U.js";import"./CConditionalPortal-DwBsYzTA.js";import"./CFormControlWrapper-OEJgTi6e.js";import"./CFormControlValidation-CtDkyDfm.js";import"./CFormLabel-szm2Dda9.js";import"./CBackdrop-BbuVwMMD.js";import"./getRTLPlacement-CB0NCZ8Z.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";const at=()=>{const M=new Date,oe=M.getFullYear(),ae=String(M.getMonth()+1).padStart(2,"0"),se=String(M.getDate()).padStart(2,"0");return`${oe}-${ae}-${se}`},Vo=()=>{const{canSelect:M,canInsert:oe,canUpdate:ae}=Zt("ListaAsistencia"),[se,st]=d.useState([]),[re,rt]=d.useState([]),[ne,nt]=d.useState(!0),[_,fe]=d.useState(""),[j,R]=d.useState([]),[N,it]=d.useState([]),[ct,Y]=d.useState(!1),[lt,be]=d.useState(!1),[C,dt]=d.useState([]),[pt,O]=d.useState(!1),[S,G]=d.useState([]),[mt,ut]=d.useState(""),[Ce,ie]=d.useState(""),[ce,ye]=d.useState(""),[q,je]=d.useState(""),[le,Se]=d.useState(""),[$,xt]=d.useState("dia"),[we,Ae]=d.useState("secciones"),[ht,ve]=d.useState(""),[gt,_e]=d.useState(""),[ft,Ne]=d.useState(""),[bt,ze]=d.useState(""),[F,Ct]=d.useState(5),[U,ke]=d.useState(""),[T,V]=d.useState(1),[E,Fe]=d.useState(1),[J,yt]=d.useState(5),[Te,Ee]=d.useState([]),[D,X]=d.useState(""),[K,jt]=d.useState({}),St=e=>{const o=e.toLowerCase();return["presente","asisti√≥","asistencia","presencia","particip√≥","vino","en clase"].some(a=>o.includes(a))?{color:"#28a745",icono:t.jsx("span",{style:{fontSize:"0.9em"},children:"‚úîÔ∏è"})}:["ausente","falta","no asisti√≥","inexistente","no vino","no presencia"].some(a=>o.includes(a))?{color:"#dc3545",icono:t.jsx("span",{style:{fontSize:"0.9em"},children:"‚ùå"})}:["tardanza","retraso","lleg√≥ tarde","demora","tarde"].some(a=>o.includes(a))?{color:"#CC7722",icono:t.jsx("span",{style:{fontSize:"0.9em"},children:"‚è∞"})}:["justificado","excusa","autorizado","permisado","permitido","exento","aprobado"].some(a=>o.includes(a))?{color:"#4169E1",icono:t.jsx("span",{style:{fontSize:"0.9em"},children:"üìù"})}:{color:"gray",icono:t.jsx("span",{style:{fontSize:"0.9em"},children:"‚ùì"})}};d.useEffect(()=>{wt();const e=localStorage.getItem("token");if(e)try{const o=Xt(e);console.log("Token decodificado:",o)}catch(o){console.error("Error al decodificar el token:",o)}At(),_&&(vt(_),Z())},[_]);const wt=async()=>{try{const e=await fetch("http://74.50.68.87:4000/api/seccionalumno/secciones");if(!e.ok)throw new Error("Error al cargar secciones.");const o=await e.json();st(o)}catch(e){console.error("Error al obtener las secciones:",e)}finally{nt(!1)}},At=async()=>{try{const e=await fetch("http://74.50.68.87:4000/api/estadoAsistencia/estadoasistencias");if(!e.ok)throw new Error("Error al cargar estados de asistencia.");const o=await e.json();it(o);const a={};o.forEach(s=>{a[s.Cod_estado_asistencia]=St(s.Descripcion_asistencia)}),jt(a)}catch(e){console.error("Error al obtener los estados de asistencia:",e)}},vt=async e=>{try{const o=await fetch(`http://74.50.68.87:4000/api/seccionalumno/estudiantes/${e}`);if(!o.ok)throw new Error("Error al cargar estudiantes.");const s=(await o.json()).sort((c,r)=>c.Nombre_Completo.localeCompare(r.Nombre_Completo));rt(s);const n=s.map(c=>({Cod_seccion_matricula:c.Cod_seccion_matricula,Observacion:"",Cod_estado_asistencia:"",Cod_asistencias:c.Cod_asistencias||null}));R(n)}catch(o){console.error("Error al obtener los estudiantes:",o)}},_t=e=>{const o=new Date(e),a=o.getFullYear(),s=String(o.getMonth()+1).padStart(2,"0"),n=String(o.getDate()).padStart(2,"0");return`${a}-${s}-${n}`},Nt=async e=>{try{const o=_t(e),a=await fetch(`http://74.50.68.87:4000/api/asistencia/asistencias?cod_seccion=${_}&fecha=${o}`);if(!a.ok)throw new Error("Error al obtener las asistencias.");const n=(await a.json()).sort((c,r)=>c.Nombre_Completo.localeCompare(r.Nombre_Completo));dt(n),Y(!0)}catch(o){console.error("Error al obtener las asistencias por secci√≥n:",o),m.fire({title:"Error",text:"No se pudieron cargar las asistencias. Int√©ntalo m√°s tarde.",icon:"error",confirmButtonText:"Aceptar"})}},Z=async()=>{if(_)try{const e=await fetch(`http://74.50.68.87:4000/api/asistencia/recuento?codSeccion=${_}`);if(!e.ok)throw new Error("Error al obtener el recuento de asistencias.");const a=(await e.json()).sort((s,n)=>new Date(n.fecha)-new Date(s.fecha));Ee(a)}catch(e){console.error("Error al obtener el recuento de asistencias:",e)}},de=e=>{const o=new Date(e),a={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0};return o.toLocaleString("es-HN",a)},zt=N.reduce((e,o)=>(e[o.Descripcion_asistencia]=o.Cod_estado_asistencia,e),{}),kt=async e=>{try{const a=new Date(e).toISOString().split("T")[0];ut(a);const s=await fetch(`http://74.50.68.87:4000/api/asistencia/asistencias?cod_seccion=${_}&fecha=${a}`);if(!s.ok)throw new Error("Error al obtener las asistencias.");const r=(await s.json()).sort((i,l)=>i.Nombre_Completo.localeCompare(l.Nombre_Completo)).map(i=>({...i,Cod_estado_asistencia:zt[i.DescripcionEstado]||""}));G(r),O(!0)}catch(o){console.error("Error al cargar los datos para actualizar:",o),m.fire({title:"Error",text:"No se pudieron cargar los datos de asistencia. Int√©ntalo m√°s tarde.",icon:"error",confirmButtonText:"Aceptar"})}},P=e=>{e.preventDefault(),m.fire({icon:"warning",title:"Acci√≥n bloqueada",text:"Copiar y pegar no est√° permitido.",confirmButtonText:"Aceptar"})},De=(e,o)=>{let s=e.target.value.toUpperCase().trimStart();const n=/^[A-Z√ë√Å√â√ç√ì√ö0-9\s,]*$/;if(/\s{2,}/.test(s)&&(m.fire({icon:"warning",title:"Espacios m√∫ltiples",text:"No se permite m√°s de un espacio entre palabras.",confirmButtonText:"Aceptar"}),s=s.replace(/\s+/g," ")),!n.test(s)){m.fire({icon:"warning",title:"Caracteres no permitidos",text:"Solo se permiten letras, n√∫meros y espacios.",confirmButtonText:"Aceptar"});return}const c=s.split(" ");for(let r of c){const i={};for(let l of r)if(i[l]=(i[l]||0)+1,i[l]>4){m.fire({icon:"warning",title:"Repetici√≥n de letras",text:`La letra "${l}" se repite m√°s de 4 veces en la palabra "${r}".`,confirmButtonText:"Aceptar"});return}}o(s)},Ft=(e,o)=>{const a=[...j];a[e].Observacion=o,R(a)},Pe=(e,o)=>{const a=[...S];a[e].Observacion=o,G(a)},Tt=(e,o)=>{const a=[...j];a[e].Cod_estado_asistencia=a[e].Cod_estado_asistencia===o?"":o,R(a)},Et=(e,o)=>{const a=[...S];a[e].Cod_estado_asistencia=a[e].Cod_estado_asistencia===o?"":o,G(a)},Dt=async()=>{try{const e=localStorage.getItem("token");if(!e){m.fire("Error","No tienes permiso para realizar esta acci√≥n","error");return}const o=Ie(e);if(!o.cod_usuario||!o.nombre_usuario)throw console.error("No se pudo obtener el c√≥digo o el nombre de usuario del token"),new Error("No se pudo obtener el c√≥digo o el nombre de usuario del token");if(j.some(z=>!z.Cod_estado_asistencia)){m.fire({title:"Completa la asistencia",text:"Debes registrar la asistencia de todos los estudiantes",icon:"info",confirmButtonText:"Aceptar"});return}const[s,n,c]=at().split("-"),r=new Date(s,n-1,c),i=new Date;r.setHours(i.getHours(),i.getMinutes(),i.getSeconds());const l=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")} ${String(r.getHours()).padStart(2,"0")}:${String(r.getMinutes()).padStart(2,"0")}:${String(r.getSeconds()).padStart(2,"0")}`,f=j.map(z=>({Observacion:z.Observacion||null,Cod_estado_asistencia:z.Cod_estado_asistencia||null,Cod_seccion_matricula:z.Cod_seccion_matricula||null,Fechas:l}));if((await(await fetch("http://74.50.68.87:4000/api/asistencia/verificarExistencia",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fecha:l,codSeccion:f[0].Cod_seccion_matricula})})).json()).existe){m.fire({title:"Asistencia ya registrada",text:"Ya existen registros de asistencia para esta fecha y secci√≥n.",icon:"info",confirmButtonText:"Aceptar"});return}if((await fetch("http://74.50.68.87:4000/api/asistencia/crearasistencias",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(f)})).ok){const z=`El usuario: ${o.nombre_usuario} ha creado nueva asistencia para la fecha: ${l} `;(await fetch("http://74.50.68.87:4000/api/bitacora/registro",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({cod_usuario:o.cod_usuario,cod_objeto:47,accion:"INSERT",descripcion:z})})).ok?console.log("Registro en bit√°cora exitoso"):m.fire("Error","No se pudo registrar la acci√≥n en la bit√°cora","error"),m.fire({title:"Asistencias registradas correctamente",icon:"success",confirmButtonText:"Aceptar"}),Z(),Q()}else throw new Error("Error al insertar asistencias")}catch(e){console.error("Hubo un problema al guardar asistencias:",e),m.fire({title:"Error!",text:e.message.includes("asistencia ya existe")?"No se puede guardar porque la asistencia ya existe.":"Hubo un problema al guardar las asistencias.",icon:"error",confirmButtonText:"Aceptar"})}},Pt=async()=>{try{const e=localStorage.getItem("token");if(!e){m.fire("Error","No tienes permiso para realizar esta acci√≥n","error");return}const o=Ie(e);if(!o.cod_usuario||!o.nombre_usuario)throw console.error("No se pudo obtener el c√≥digo o el nombre de usuario del token"),new Error("No se pudo obtener el c√≥digo o el nombre de usuario del token");const a=S.map(n=>({Cod_asistencias:n.Cod_asistencias,Observacion:n.Observacion||null,Cod_estado_asistencia:n.Cod_estado_asistencia||null,Cod_seccion_matricula:n.Cod_seccion_matricula||null})),s=await fetch("http://74.50.68.87:4000/api/asistencia/actualizarasistencias",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(a)});if(s.ok){const n=await s.json(),c=a.map(l=>l.Cod_asistencias).join(", "),r=`El usuario: ${o.nombre_usuario} ha actualizado las asistencias con los c√≥digos: ${c}`;(await fetch("http://74.50.68.87:4000/api/bitacora/registro",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({cod_usuario:o.cod_usuario,cod_objeto:47,accion:"UPDATE",descripcion:r})})).ok?console.log("Registro en bit√°cora exitoso"):m.fire("Error","No se pudo registrar la acci√≥n en la bit√°cora","error"),m.fire({title:"Asistencias actualizadas correctamente",icon:"success",confirmButtonText:"Aceptar"}),Z(),O(!1)}else throw new Error("Error al actualizar las asistencias")}catch(e){console.error("Hubo un problema al actualizar asistencias:",e),m.fire({title:"Error!",text:"Hubo un problema al actualizar las asistencias.",icon:"error",confirmButtonText:"Aceptar"})}},Bt=(()=>{const e={};return Te.forEach(o=>{const{fecha:a,estado:s,cantidad:n}=o;e[a]||(e[a]={}),e[a][s]=n}),e})(),Mt=e=>{const o=j.every(s=>s.Cod_estado_asistencia===e),a=j.map(s=>({...s,Cod_estado_asistencia:o?"":e}));R(a)},Rt=e=>{const o=S.every(s=>s.Cod_estado_asistencia===e),a=S.map(s=>({...s,Cod_estado_asistencia:o?"":e}));G(a)},Be=Object.entries(Bt).filter(([e])=>{const o=new Date(e),a=o.getDate(),s=o.getMonth()+1,n=o.getFullYear();return $==="mes"?!(q&&parseInt(q,10)!==s||ce&&parseInt(ce,10)!==a):$==="anio"?!(le&&parseInt(le,10)!==n):!0}),Me=E*J,Ot=Me-J,$t=Be.slice(Ot,Me),pe=Math.ceil(Be.length/J),Re=e=>{e>0&&e<=pe&&Fe(e)},Lt=e=>{const o=new Date(e),a=String(o.getDate()).padStart(2,"0"),s=String(o.getMonth()+1).padStart(2,"0"),n=o.getFullYear();return`${a}/${s}/${n}`},Oe=C.filter(e=>e.Nombre_Completo.toLowerCase().includes(Ce.toLowerCase())),It=()=>{R(re.map(e=>({Cod_seccion_matricula:e.Cod_seccion_matricula,Observacion:"",Cod_estado_asistencia:"",Cod_asistencias:e.Cod_asistencias||null})))},Q=()=>{It(),be(!1)},Ht=()=>{if(!C||C.length===0){m.fire({icon:"info",title:"Tabla vac√≠a",text:"No hay datos disponibles para generar el reporte excel.",confirmButtonText:"Aceptar"});return}const e=C.length>0?de(C[0].Fecha):"sin_fecha",o=e!=="sin_fecha"?e.split(" ")[0].replace(/[^0-9/-]/g,""):"",a=[["Saint Patrick's Academy"],["Reporte de Asistencia"],[`Secci√≥n: ${D||"No especificada"}`,`Fecha de generaci√≥n: ${new Date().toLocaleDateString()}`,`Fecha de registro: ${o||"Sin fecha"}`],[],["#","Nombre Completo","Estado","Observaci√≥n"]],s=C.map((h,w)=>[w+1,h.Nombre_Completo,h.DescripcionEstado,h.Observacion||"N/A"]),n=[...a,...s],c=y.aoa_to_sheet(n),r=y.decode_range(c["!ref"]);for(let h=0;h<=3;h++)for(let w=r.s.c;w<=r.e.c;w++){const me=y.encode_cell({r:h,c:w});c[me]&&(c[me].s={font:{bold:!0,sz:14,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"15401D"}},alignment:{horizontal:"center"}})}for(let h=0;h<4;h++){const w=y.encode_cell({r:4,c:h});c[w]&&(c[w].s={font:{bold:!0,sz:12,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"2D6A4F"}},alignment:{horizontal:"center",vertical:"center"}})}const i=[{wpx:250},{wpx:250},{wpx:100},{wpx:250}];c["!cols"]=i;const l=y.book_new();y.book_append_sheet(l,c,"Reporte de Asistencia");const f=`${D||"No_especificada"}_${o||"sin_fecha"}.xlsx`;Ye(l,f)},Wt=()=>{if(!C||C.length===0){m.fire({icon:"info",title:"Tabla vac√≠a",text:"No hay datos disponibles para generar el reporte.",confirmButtonText:"Aceptar"});return}const e=new We,o=new Image;o.src=He;const a=C.length>0?de(C[0].Fecha):"sin_fecha";o.onload=()=>{e.addImage(o,"PNG",10,10,30,30);let s=20;if(e.setFontSize(18),e.setTextColor(0,102,51),e.text("SAINT PATRICK'S ACADEMY",e.internal.pageSize.width/2,s,{align:"center"}),s+=12,e.setFontSize(16),e.text("Reporte de Asistencia",e.internal.pageSize.width/2,s,{align:"center"}),s+=10,e.setFontSize(12),e.setTextColor(0,0,0),D&&a&&a!=="sin_fecha"){const i=a.split(" ")[0].replace(/[^0-9/-]/g,"");e.text(`Secci√≥n: ${D} | Fecha del registro: ${i}`,e.internal.pageSize.width/2,s,{align:"center"})}else if(D)e.text(`Secci√≥n: ${D}`,e.internal.pageSize.width/2,s,{align:"center"});else if(a&&a!=="sin_fecha"){const i=a.split(" ")[0].replace(/[^0-9/-]/g,"");e.text(`Fecha de registro: ${i}`,e.internal.pageSize.width/2,s,{align:"center"})}s+=8,e.setFontSize(10),e.setTextColor(100),e.text("Casa Club del periodista, Colonia del Periodista",e.internal.pageSize.width/2,s,{align:"center"}),s+=4,e.text("Tel√©fono: (504) 2234-8871",e.internal.pageSize.width/2,s,{align:"center"}),s+=4,e.text("Correo: info@saintpatrickacademy.edu",e.internal.pageSize.width/2,s,{align:"center"}),s+=6,e.setLineWidth(.5),e.setDrawColor(0,102,51),e.line(10,s,e.internal.pageSize.width-10,s);const n=e.internal.pageSize.height;e.autoTable({startY:s+4,head:[["#","Nombre del Alumno","Estado","Observaci√≥n"]],body:C.map((i,l)=>[l+1,`${i.Nombre_Completo||""}`.trim(),i.DescripcionEstado,i.Observacion||"N/A"]),headStyles:{fillColor:[0,102,51],textColor:[255,255,255],fontSize:10},styles:{fontSize:10,cellPadding:3,halign:"center"},columnStyles:{0:{cellWidth:"auto"},1:{cellWidth:"auto"},2:{cellWidth:"auto"},3:{cellWidth:"auto"}},alternateRowStyles:{fillColor:[240,248,255]},didDrawPage:i=>{const l=new Date,f=`${l.toLocaleDateString()} ${l.toLocaleTimeString()}`,h=e.internal.pageSize.height;e.setFontSize(10),e.setTextColor(100),e.text(`Fecha y hora de generaci√≥n: ${f}`,10,h-10)}});const c=e.internal.getNumberOfPages(),r=e.internal.pageSize.width;for(let i=1;i<=c;i++){e.setPage(i),e.setTextColor(100);const l=`P√°gina ${i} de ${c}`;e.text(l,r-30,n-10)}window.open(e.output("bloburl"),"_blank")},o.onerror=()=>{console.warn("No se pudo cargar el logo. El PDF se generar√° sin el logo."),window.open(e.output("bloburl"),"_blank")}},Yt=()=>{if(!A||A.length===0){m.fire({icon:"info",title:"Tabla vac√≠a",text:"No hay datos disponibles para generar el reporte excel.",confirmButtonText:"Aceptar"});return}const e=[["Saint Patrick Academy"],["Reporte de Secciones"],[],["#","Secci√≥n","Grado","A√±o Acad√©mico","Profesor"]],o=A.map((l,f)=>[f+1,l.Seccion,l.Grado,l.Anio_Academico,l.Nombre_Profesor]),a=[...e,...o],s=y.aoa_to_sheet(a),n=y.decode_range(s["!ref"]);for(let l=0;l<=3;l++)for(let f=n.s.c;f<=n.e.c;f++){const h=y.encode_cell({r:l,c:f});s[h]&&(s[h].s={font:{bold:!0,sz:14,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"15401D"}},alignment:{horizontal:"center"}})}const c=[{wpx:100},{wpx:100},{wpx:100},{wpx:100},{wpx:200}];s["!cols"]=c;const r=y.book_new();y.book_append_sheet(r,s,"Reporte de Secciones"),Ye(r,"Reporte_Secciones.xlsx")},Gt=()=>{if(!A||A.length===0){m.fire({icon:"info",title:"Tabla vac√≠a",text:"No hay datos disponibles para generar el reporte.",confirmButtonText:"Aceptar"});return}const e=new We,o=new Image;o.src=He,o.onload=()=>{e.addImage(o,"PNG",10,10,30,30);let a=20;e.setFontSize(18),e.setTextColor(0,102,51),e.text("SAINT PATRICK'S ACADEMY",e.internal.pageSize.width/2,a,{align:"center"}),a+=12,e.setFontSize(16),e.text("Reporte de Secciones",e.internal.pageSize.width/2,a,{align:"center"}),a+=10,e.setFontSize(10),e.setTextColor(100),e.text("Casa Club del periodista, Colonia del Periodista",e.internal.pageSize.width/2,a,{align:"center"}),a+=4,e.text("Tel√©fono: (504) 2234-8871",e.internal.pageSize.width/2,a,{align:"center"}),a+=4,e.text("Correo: info@saintpatrickacademy.edu",e.internal.pageSize.width/2,a,{align:"center"}),a+=6,e.setLineWidth(.5),e.setDrawColor(0,102,51),e.line(10,a,e.internal.pageSize.width-10,a);const s=e.internal.pageSize.height;e.autoTable({startY:a+4,head:[["#","Secci√≥n","Grado","A√±o Acad√©mico","Profesor"]],body:A.map((r,i)=>[i+1,`${r.Seccion||""}`.trim(),r.Grado,r.Anio_Academico,r.Nombre_Profesor]),headStyles:{fillColor:[0,102,51],textColor:[255,255,255],fontSize:10},styles:{fontSize:10,cellPadding:3,halign:"center"},columnStyles:{0:{cellWidth:"auto"},1:{cellWidth:"auto"},2:{cellWidth:"auto"},3:{cellWidth:"auto"},4:{cellWidth:"auto"}},alternateRowStyles:{fillColor:[240,248,255]},didDrawPage:r=>{const i=new Date,l=`${i.toLocaleDateString()} ${i.toLocaleTimeString()}`,f=e.internal.pageSize.height;e.setFontSize(10),e.setTextColor(100),e.text(`Fecha y hora de generaci√≥n: ${l}`,10,f-10)}});const n=e.internal.getNumberOfPages(),c=e.internal.pageSize.width;for(let r=1;r<=n;r++){e.setPage(r),e.setTextColor(100);const i=`P√°gina ${r} de ${n}`;e.text(i,c-30,s-10)}window.open(e.output("bloburl"),"_blank")},o.onerror=()=>{console.warn("No se pudo cargar el logo. El PDF se generar√° sin el logo."),window.open(e.output("bloburl"),"_blank")}},qt=async(e,o,a,s,n)=>{if(fe(e),ve(o),_e(a),Ne(s),ze(n),Z(),Ae("asistencias"),e)try{const c=await fetch(`http://74.50.68.87:4000/api/seccionalumno/nomenclatura?codSeccion=${e}`);if(!c.ok)throw new Error("Error al obtener la nomenclatura.");const r=await c.json();X(r?r.Nomenclatura:"")}catch(c){console.error("Error al obtener la nomenclatura:",c)}else X("")},Ut=()=>{Ae("secciones"),Ee([]),fe(null),ve(""),_e(""),Ne(""),ze(""),X("")};if(!M)return t.jsx(Qt,{});const Vt=e=>{let a=e.target.value.toUpperCase().trimStart();const s=/^[A-Z√ë√Å√â√ç√ì√ö0-9\s,]*$/;if(/\s{2,}/.test(a)&&(m.fire({icon:"warning",title:"Espacios m√∫ltiples",text:"No se permite m√°s de un espacio entre palabras.",confirmButtonText:"Aceptar"}),a=a.replace(/\s+/g," ")),!s.test(a)){m.fire({icon:"warning",title:"Caracteres no permitidos",text:"Solo se permiten letras, n√∫meros y espacios.",confirmButtonText:"Aceptar"});return}const n=a.split(" ");for(let c of n){const r={};for(let i of c)if(r[i]=(r[i]||0)+1,r[i]>4){m.fire({icon:"warning",title:"Repetici√≥n de letras",text:`La letra "${i}" se repite m√°s de 4 veces en la palabra "${c}".`,confirmButtonText:"Aceptar"});return}}ke(a),V(1)},ee=se.filter(e=>e.Seccion.toLowerCase().includes(U.toLowerCase())||e.Grado.toLowerCase().includes(U.toLowerCase())||e.Anio_Academico.toString().includes(U)),$e=T*F,Jt=$e-F,A=ee.slice(Jt,$e),Le=e=>{e>0&&e<=Math.ceil(ee.length/F)&&V(e)};return t.jsxs(eo,{className:"py-1",children:[ne&&t.jsx("div",{className:"text-center my-5",children:t.jsx(Kt,{color:"primary","aria-label":"Cargando informaci√≥n..."})}),!ne&&we==="secciones"&&t.jsxs(t.Fragment,{children:[t.jsx(k,{className:"align-items-center mb-5",children:t.jsxs(b,{xs:"12",className:"d-flex flex-column flex-md-row justify-content-between align-items-center gap-3",children:[t.jsx("div",{className:"flex-grow-1 text-center",children:t.jsx("h4",{className:"text-center fw-semibold pb-2 mb-0",style:{display:"inline-block",borderBottom:"2px solid #4CAF50"},children:" Lista de Secciones"})}),t.jsxs(Ge,{className:"btn-sm d-flex align-items-center gap-1 rounded shadow",children:[t.jsxs(qe,{style:{backgroundColor:"#6C8E58",color:"white",fontSize:"0.85rem",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#5A784C",e.currentTarget.style.boxShadow="0 4px 8px rgba(0, 0, 0, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#6C8E58",e.currentTarget.style.boxShadow="none"},children:[t.jsx(g,{icon:Ve})," Reporte"]}),t.jsxs(Ue,{style:{position:"absolute",zIndex:1050,backgroundColor:"#fff",boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.2)",borderRadius:"4px",overflow:"hidden"},children:[t.jsxs(te,{onClick:Gt,style:{cursor:"pointer",outline:"none",backgroundColor:"transparent",padding:"0.5rem 1rem",fontSize:"0.85rem",color:"#333",borderBottom:"1px solid #eaeaea",transition:"background-color 0.3s"},onMouseOver:e=>e.target.style.backgroundColor="#f5f5f5",onMouseOut:e=>e.target.style.backgroundColor="transparent",children:[t.jsx(g,{icon:Je,size:"sm"})," Abrir en PDF"]}),t.jsxs(te,{onClick:Yt,style:{cursor:"pointer",outline:"none",backgroundColor:"transparent",padding:"0.5rem 1rem",fontSize:"0.85rem",color:"#333",transition:"background-color 0.3s"},onMouseOver:e=>e.target.style.backgroundColor="#f5f5f5",onMouseOut:e=>e.target.style.backgroundColor="transparent",children:[t.jsx(g,{icon:Xe,size:"sm"})," Descargar Excel"]})]})]})]})}),t.jsxs(k,{className:"align-items-center mt-4 mb-2",children:[t.jsx(b,{xs:"12",md:"8",className:"d-flex flex-wrap align-items-center",children:t.jsxs(B,{className:"me-3",style:{width:"350px"},children:[t.jsx(to,{children:t.jsx(g,{icon:Ke})}),t.jsx(L,{style:{width:"80px",height:"35px",display:"inline-block",fontSize:"0.8rem"},placeholder:"Buscar por a√±o, grado o secci√≥n",onChange:Vt,value:U,onPaste:P,onCopy:P}),t.jsxs(x,{style:{border:"1px solid #ccc",transition:"all 0.1s ease-in-out",backgroundColor:"#F3F4F7",color:"#343a40",height:"35px"},onClick:()=>{ke(""),V(1)},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#E0E0E0",e.currentTarget.style.color="black"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#F3F4F7",e.currentTarget.style.color="#343a40"},children:[t.jsx(g,{icon:oo})," Limpiar"]})]})}),t.jsx(b,{xs:"12",md:"4",className:"text-md-end mt-2 mt-md-0",children:t.jsx(B,{style:{width:"auto",display:"inline-block"},children:t.jsxs("div",{className:"d-inline-flex align-items-center",children:[t.jsx("span",{style:{fontSize:"0.85rem"},children:"Mostrar¬†"}),t.jsxs(I,{style:{width:"80px",height:"35px",display:"inline-block",textAlign:"center"},onChange:e=>{const o=Number(e.target.value);Ct(o),V(1)},value:F,children:[t.jsx("option",{value:"5",children:"5"}),t.jsx("option",{value:"10",children:"10"}),t.jsx("option",{value:"20",children:"20"})]}),t.jsx("span",{style:{fontSize:"0.85rem"},children:"¬†registros"})]})})})]}),t.jsx("div",{className:"table-responsive",style:{maxHeight:"400px",overflowX:"auto",overflowY:"auto",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.3)"},children:t.jsxs(H,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[t.jsx(Ze,{className:"sticky-top bg-light text-center",style:{fontSize:"0.8rem"},children:t.jsxs(v,{children:[t.jsx(u,{children:"#"}),t.jsx(u,{children:"SECCI√ìN"}),t.jsx(u,{children:"GRADO"}),t.jsx(u,{children:"A√ëO ACAD√âMICO"}),t.jsx(u,{children:"PROFESOR"}),t.jsx(u,{children:"ACCI√ìN"})]})}),t.jsx(W,{className:"text-center",style:{fontSize:"0.85rem"},children:A.length>0?A.map((e,o)=>t.jsxs(v,{children:[t.jsx(p,{children:o+1}),t.jsx(p,{children:e.Seccion}),t.jsx(p,{children:e.Grado}),t.jsx(p,{children:e.Anio_Academico}),t.jsx(p,{children:e.Nombre_Profesor}),t.jsx(p,{children:t.jsx(x,{size:"sm",style:{backgroundColor:"#F0F4F3",color:"#153E21",border:"1px solid #A2B8A9",borderRadius:"6px",padding:"5px 12px",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.1)"},onMouseEnter:a=>a.target.style.backgroundColor="#dce3dc",onMouseLeave:a=>a.target.style.backgroundColor="#F0F4F3",onClick:()=>qt(e.Cod_secciones,e.Seccion,e.Grado,e.Anio_Academico,e.Nombre_Profesor),children:"Ver Asistencia"})})]},o)):t.jsx(v,{children:t.jsx(p,{colSpan:"5",children:"No se encontraron resultados"})})})]})}),t.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"16px"},children:[t.jsxs(Qe,{"aria-label":"Page navigation",style:{display:"flex",gap:"10px"},children:[t.jsx(x,{style:{backgroundColor:"#6f8173",color:"#D9EAD3"},disabled:T===1,onClick:()=>Le(T-1),children:"Anterior"}),t.jsx(x,{style:{marginLeft:"10px",backgroundColor:"#6f8173",color:"#D9EAD3"},disabled:T===Math.ceil(ee.length/F),onClick:()=>Le(T+1),children:"Siguiente"})]}),t.jsxs("span",{style:{marginLeft:"10px"},children:["P√°gina ",T," de ",Math.ceil(ee.length/F)]})]})]}),!ne&&we==="asistencias"&&t.jsxs(t.Fragment,{children:[t.jsx(k,{className:"align-items-center mb-5",children:t.jsxs(b,{xs:"12",className:"d-flex flex-column flex-md-row justify-content-between align-items-center gap-3",children:[t.jsxs(x,{className:"btn btn-sm d-flex align-items-center gap-1 rounded shadow",onMouseEnter:e=>e.currentTarget.style.backgroundColor="#4B4B4B",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#656565",style:{backgroundColor:"#656565",color:"#FFFFFF",padding:"6px 12px",fontSize:"0.9rem",transition:"background-color 0.2s ease, box-shadow 0.3s ease",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)"},onClick:Ut,children:[t.jsx(g,{icon:ao})," Volver a Secciones"]}),t.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center flex-grow-1",children:[t.jsx("h3",{className:"text-center pb-2 mb-0",style:{borderBottom:"2px solid #4CAF50",margin:"0 auto",fontSize:"1.5rem"},children:"Asistencia"}),t.jsxs("div",{className:"d-flex justify-content-center align-items-center mt-2",children:[t.jsxs("div",{className:"me-3",style:{fontSize:"1rem"},children:["Grado: ",gt]}),t.jsxs("div",{className:"me-3",style:{fontSize:"1rem"},children:["Secci√≥n: ",ht]}),t.jsxs("div",{className:"me-3",style:{fontSize:"1rem"},children:["A√±o: ",ft]}),t.jsxs("div",{className:"me-3",style:{fontSize:"1rem"},children:["Profesor: ",bt]})]})]}),oe&&t.jsxs(x,{className:"btn btn-sm d-flex align-items-center gap-1 rounded shadow",onClick:()=>be(!0),onMouseEnter:e=>e.currentTarget.style.backgroundColor="#3C4B43",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#4B6251",style:{backgroundColor:"#4B6251",color:"#FFFFFF",padding:"5px 10px",fontSize:"0.9rem"},children:[t.jsx(g,{icon:so,className:"me-2"}),"Nuevo"]})]})}),t.jsxs(k,{className:"align-items-center mt-4 mb-2",children:[t.jsxs(b,{xs:"12",md:"8",className:"d-flex flex-wrap align-items-center gap-3",children:[t.jsx(B,{className:"me-1",style:{maxWidth:"150px"},children:t.jsxs(I,{value:$,onChange:e=>{xt(e.target.value),je(""),Se(""),ye("")},style:{padding:"0.2rem",fontSize:"0.8rem",height:"35px",lineHeight:"2"},children:[t.jsx("option",{value:"",children:"Buscar por:"}),t.jsx("option",{value:"mes",children:"Mes"}),t.jsx("option",{value:"anio",children:"A√±o"})]})}),$==="mes"&&t.jsxs(B,{className:"me-3",style:{maxWidth:"250px"},children:[t.jsxs(I,{value:q,onChange:e=>je(e.target.value),style:{padding:"0.2rem",fontSize:"0.8rem",height:"35px",lineHeight:"2"},children:[t.jsx("option",{value:"",children:"Selecciona un mes"}),[...Array(12).keys()].map(e=>t.jsx("option",{value:e+1,children:new Date(0,e).toLocaleString("es",{month:"long"})},e+1))]}),q&&t.jsx(L,{type:"number",placeholder:"D√≠a (opcional)",value:ce,onChange:e=>ye(e.target.value),min:"1",max:"31",style:{padding:"0.2rem",fontSize:"0.8rem",height:"35px",lineHeight:"2"}})]}),$==="anio"&&t.jsx(B,{className:"me-3",style:{maxWidth:"250px"},children:t.jsxs(I,{value:le,onChange:e=>Se(e.target.value),style:{padding:"0.2rem",fontSize:"0.8rem",height:"35px",lineHeight:"2"},children:[t.jsx("option",{value:"",children:"Selecciona un a√±o"}),Array.from({length:50},(e,o)=>new Date().getFullYear()-o).map(e=>t.jsx("option",{value:e,children:e},e))]})})]}),t.jsx(b,{xs:"12",md:"4",className:"text-md-end mt-3 mt-md-0",children:t.jsx(B,{style:{width:"auto",display:"inline-block"},children:t.jsxs("div",{className:"d-inline-flex align-items-center",children:[t.jsx("span",{style:{fontSize:"0.85rem"},children:"Mostrar¬†"}),t.jsxs(I,{style:{width:"80px",height:"35px",display:"inline-block",textAlign:"center"},onChange:e=>{const o=Number(e.target.value);yt(o),Fe(1)},value:J,children:[t.jsx("option",{value:"5",children:"5"}),t.jsx("option",{value:"10",children:"10"}),t.jsx("option",{value:"20",children:"20"})]}),t.jsx("span",{style:{fontSize:"0.85rem"},children:"¬†registros"})]})})})]}),Te.length===0?t.jsx("p",{className:"text-center text-muted mt-2",children:"No se encontraron registros de asistencia para esta secci√≥n"}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"table-responsive",style:{maxHeight:"400px",overflowX:"auto",overflowY:"auto",marginBottom:"20px",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.3)"},children:t.jsxs(H,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[t.jsx(Ze,{className:"sticky-top bg-light text-center",style:{fontSize:"0.8rem"},children:t.jsxs(v,{children:[t.jsx(u,{children:"#"}),t.jsx(u,{children:"FECHA"}),N.map(e=>t.jsx(u,{className:"text-center",children:e.Descripcion_asistencia},e.Cod_estado_asistencia)),t.jsx(u,{children:"ACCI√ìN"})]})}),t.jsx(W,{className:"text-center",style:{fontSize:"0.85rem"},children:$t.map(([e,o],a)=>t.jsxs(v,{children:[t.jsx(p,{children:a+1}),t.jsx(p,{children:Lt(e)}),N.map(s=>t.jsx(p,{children:o[s.Cod_estado_asistencia]||0},s.Cod_estado_asistencia)),t.jsx(p,{style:{padding:"10px"},children:t.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[ae&&t.jsx(x,{onClick:()=>kt(e),onMouseEnter:s=>{s.currentTarget.style.boxShadow="0px 4px 10px rgba(249, 182, 78, 0.6)",s.currentTarget.style.color="#000000"},onMouseLeave:s=>{s.currentTarget.style.boxShadow="none",s.currentTarget.style.color="#5C4044"},style:{backgroundColor:"#F9B64E",color:"#5C4044",border:"none",transition:"all 0.2s ease",padding:"5px 10px",height:"38px",width:"45px"},children:t.jsx(g,{icon:et})}),t.jsx(x,{onClick:()=>Nt(e),onMouseEnter:s=>{s.currentTarget.style.boxShadow="0px 4px 10px rgba(93, 138, 168, 0.6)",s.currentTarget.style.color="#000000"},onMouseLeave:s=>{s.currentTarget.style.boxShadow="none",s.currentTarget.style.color="#5C4044"},style:{backgroundColor:"#5D8AA8",marginRight:"10px",color:"#5C4044",border:"none",transition:"all 0.2s ease",padding:"5px 10px",height:"38px",width:"45px"},children:t.jsx(g,{icon:ro})})]})})]},e))})]})}),t.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"16px"},children:[t.jsxs(Qe,{"aria-label":"Page navigation",style:{display:"flex",gap:"10px"},children:[t.jsx(x,{style:{backgroundColor:"#6f8173",color:"#D9EAD3"},disabled:E===1,onClick:()=>Re(E-1),children:"Anterior"}),t.jsx(x,{style:{marginLeft:"10px",backgroundColor:"#6f8173",color:"#D9EAD3"},disabled:E===pe,onClick:()=>Re(E+1),children:"Siguiente"})]}),t.jsxs("span",{style:{marginLeft:"10px"},children:["P√°gina ",E," de ",pe]})]})]})]}),t.jsxs(ue,{visible:lt,onClose:Q,size:"lg",centered:!0,backdrop:"static",children:[t.jsxs(xe,{closeButton:!1,children:[t.jsx("h5",{className:"modal-title",children:"Registrar Asistencia"}),t.jsx(x,{type:"button",className:"btn-close",onClick:Q})]}),t.jsxs(he,{style:{fontSize:"0.85rem"},children:[t.jsxs(k,{className:"align-items-center mb-2",children:[t.jsxs(b,{xs:"12",md:"6",className:"d-flex align-items-center",children:[t.jsx("h6",{className:"mb-1 me-3",children:"Fecha:"}),t.jsx(L,{type:"date",value:at(),disabled:!0,className:"rounded",style:{maxWidth:"150px",padding:"0.3rem",fontSize:"0.85rem"}})]}),t.jsx(b,{xs:"12",md:"6",className:"text-md-end text-center mt-2 mt-md-0"})]}),re.length===0?t.jsx("p",{className:"text-muted",children:"No hay estudiantes en esta secci√≥n."}):t.jsx("div",{className:"table-responsive",style:{maxHeight:"350px",overflowY:"auto",overflowX:"auto"},children:t.jsxs(H,{bordered:!0,hover:!0,responsive:!0,small:!0,children:[t.jsx("thead",{className:"bg-light",children:t.jsxs("tr",{children:[t.jsx(u,{className:"text-center",style:{fontSize:"0.8rem",padding:"2px",verticalAlign:"middle"},children:"#"}),t.jsx(u,{className:"text-center",style:{fontSize:"0.8rem",padding:"2px",verticalAlign:"middle"},children:"ALUMNO"}),t.jsx(u,{className:"text-center",style:{fontSize:"0.9rem",padding:"2px",verticalAlign:"middle"},children:t.jsx("div",{className:"d-flex justify-content-center gap-4",children:N.map(e=>{const o=K[e.Cod_estado_asistencia]||{color:"gray",icono:"‚ùì"},s=j.every(n=>n.Cod_estado_asistencia===e.Cod_estado_asistencia)?`Haga clic para deseleccionar todos como: ${e.Descripcion_asistencia}`:`Haga clic para marcar todos como: ${e.Descripcion_asistencia}`;return t.jsx("span",{style:{color:o.color,fontSize:"1.2rem",cursor:"pointer"},title:s,onClick:()=>Mt(e.Cod_estado_asistencia),children:o.icono},e.Cod_estado_asistencia)})})}),t.jsx(u,{className:"text-center",style:{fontSize:"0.8rem",padding:"2px",verticalAlign:"middle"},children:"OBSERVACI√ìN"})]})}),t.jsx(W,{children:re.map((e,o)=>t.jsxs(v,{children:[t.jsx(p,{className:"text-center",style:{fontSize:"0.8rem",padding:"2px",verticalAlign:"middle"},children:o+1}),t.jsx(p,{style:{fontSize:"0.8rem",padding:"4px",verticalAlign:"middle"},children:e.Nombre_Completo}),t.jsx(p,{className:"text-center",style:{fontSize:"0.8rem",padding:"2px",verticalAlign:"middle"},children:t.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"32px"},children:N.map(a=>{const s=K[a.Cod_estado_asistencia]||{color:"gray"};return t.jsx("input",{type:"checkbox",checked:j[o].Cod_estado_asistencia===a.Cod_estado_asistencia,onChange:()=>Tt(o,a.Cod_estado_asistencia),style:{cursor:"pointer",width:"16px",height:"16px",accentColor:s.color,marginTop:"8px"}},a.Cod_estado_asistencia)})})}),t.jsx(p,{className:"text-center",style:{fontSize:"0.8rem",padding:"4px"},children:t.jsx(tt,{content:t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.jsx("textarea",{placeholder:"Escribe tu observaci√≥n",value:j[o].Observacion,maxLength:50,onChange:a=>De(a,s=>Ft(o,s)),onPaste:P,onCopy:P,style:{width:"280px",height:"40px",padding:"0.5rem",resize:"none",overflow:"hidden",whiteSpace:"pre-wrap",border:"1px solid #ccc",outline:"none",fontSize:"0.75rem"},onFocus:a=>a.target.style.border="1px solid #aaa",onBlur:a=>a.target.style.border="1px solid #ccc"})}),placement:"right",trigger:"click",style:{maxWidth:"320px"},children:t.jsx(x,{color:"link",children:t.jsx(g,{icon:ot,style:{color:"black"}})})})})]},e.Cod_seccion_matricula))})]})})]}),t.jsxs(ge,{children:[t.jsx(x,{color:"secondary",onClick:Q,children:"Cerrar"}),t.jsxs(x,{onClick:Dt,onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#3C4B43"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#4B6251"},style:{backgroundColor:"#4B6251",color:"#FFFFFF",padding:"6px 12px",transition:"background-color 0.2s ease, box-shadow 0.3s ease"},children:[t.jsx(g,{icon:no})," Guardar"]})]})]}),t.jsxs(ue,{visible:ct,onClose:()=>Y(!1),size:"xl",backdrop:"static",centered:!0,children:[t.jsxs(xe,{closeButton:!1,children:[t.jsx("h5",{className:"modal-title",children:"Asistencias de la Secci√≥n "}),t.jsx(x,{type:"button",className:"btn-close",onClick:()=>{Y(!1),ie("")}})]}),t.jsxs(he,{style:{maxHeight:"500px",overflowY:"auto",overflowX:"auto",padding:"1.5rem"},children:[t.jsxs(k,{className:"mb-3 justify-content-center align-items-center",children:[t.jsxs(b,{xs:"12",md:"6",className:"d-flex align-items-center",children:[t.jsx(g,{icon:Ke,style:{marginRight:"8px",fontSize:"1.2rem",color:"#6C8E58"}}),t.jsx(L,{placeholder:"Buscar por nombre",value:Ce,onChange:e=>ie(e.target.value),style:{fontSize:"0.85rem",flex:1}})]}),t.jsx(b,{xs:"auto",children:t.jsxs(Ge,{children:[t.jsxs(qe,{style:{backgroundColor:"#6C8E58",color:"white",fontSize:"0.85rem",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#5A784C",e.currentTarget.style.boxShadow="0 4px 8px rgba(0, 0, 0, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#6C8E58",e.currentTarget.style.boxShadow="none"},children:[t.jsx(g,{icon:Ve})," Reporte"]}),t.jsxs(Ue,{children:[t.jsxs(te,{onClick:Wt,style:{cursor:"pointer",outline:"none",backgroundColor:"transparent",padding:"0.5rem 1rem",fontSize:"0.85rem",color:"#333",borderBottom:"1px solid #eaeaea",transition:"background-color 0.3s"},onMouseOver:e=>e.target.style.backgroundColor="#f5f5f5",onMouseOut:e=>e.target.style.backgroundColor="transparent",children:[t.jsx(g,{icon:Je,size:"sm"})," Abrir en PDF"]}),t.jsxs(te,{onClick:Ht,style:{cursor:"pointer",outline:"none",backgroundColor:"transparent",padding:"0.5rem 1rem",fontSize:"0.85rem",color:"#333",transition:"background-color 0.3s"},onMouseOver:e=>e.target.style.backgroundColor="#f5f5f5",onMouseOut:e=>e.target.style.backgroundColor="transparent",children:[t.jsx(g,{icon:Xe,size:"sm"})," Descargar Excel"]})]})]})})]}),Oe.length>0?t.jsxs(H,{bordered:!0,hover:!0,responsive:!0,className:"shadow-sm",children:[t.jsx("thead",{className:"bg-light",children:t.jsxs("tr",{children:[t.jsx(u,{className:"text-center",style:{fontSize:"0.95rem",padding:"3px",verticalAlign:"middle"},children:"#"}),t.jsx(u,{className:"text-center",style:{fontSize:"0.95rem",padding:"3px",verticalAlign:"middle"},children:"Nombre Completo"}),t.jsx(u,{className:"text-center",style:{fontSize:"0.95rem",padding:"3px",verticalAlign:"middle"},children:"Fecha"}),t.jsx(u,{className:"text-center",style:{fontSize:"0.95rem",padding:"3px",verticalAlign:"middle"},children:"Estado"}),t.jsx(u,{className:"text-center",style:{fontSize:"0.95rem",padding:"3px",verticalAlign:"middle"},children:"Observaci√≥n"})]})}),t.jsx(W,{children:Oe.map((e,o)=>t.jsxs(v,{children:[t.jsx(p,{className:"text-center",style:{fontSize:"1rem",padding:"3px",verticalAlign:"middle"},children:o+1}),t.jsx(p,{style:{fontSize:"0.95rem",padding:"3px",verticalAlign:"middle"},children:e.Nombre_Completo}),t.jsx(p,{style:{fontSize:"0.95rem",padding:"3px",verticalAlign:"middle"},children:de(e.Fecha)}),t.jsx(p,{style:{fontSize:"0.95rem",padding:"3px",verticalAlign:"middle"},children:e.DescripcionEstado}),t.jsx(p,{style:{fontSize:"0.95rem",padding:"3px",verticalAlign:"middle"},children:e.Observacion})]},e.Cod_asistencias))})]}):t.jsx("p",{className:"text-center text-muted",children:"No hay registros de asistencia para esta fecha"})]}),t.jsx(ge,{children:t.jsx(x,{color:"secondary",onClick:()=>{Y(!1),ie("")},children:"Cerrar"})})]}),t.jsxs(ue,{visible:pt,onClose:()=>O(!1),size:"lg",centered:!0,backdrop:"static",children:[t.jsxs(xe,{closeButton:!1,children:[t.jsx("h5",{className:"modal-title",children:"Actualizar Asistencia"}),t.jsx(x,{type:"button",className:"btn-close",onClick:()=>O(!1)})]}),t.jsxs(he,{style:{fontSize:"0.85rem"},children:[t.jsxs(k,{className:"align-items-center mb-2",children:[t.jsxs(b,{xs:"12",md:"6",className:"d-flex align-items-center",children:[t.jsx("h6",{className:"mb-1 me-3",children:"Fecha:"}),t.jsx(L,{type:"date",value:mt,disabled:!0,className:"rounded",style:{maxWidth:"150px",padding:"0.3rem",fontSize:"0.85rem"}})]}),t.jsx(b,{xs:"12",md:"6",className:"text-md-end text-center mt-2 mt-md-0"})]}),S.length===0?t.jsx("p",{className:"text-muted",children:"No hay estudiantes en esta secci√≥n."}):t.jsx("div",{className:"table-responsive",style:{maxHeight:"350px",overflowY:"auto",overflowX:"auto"},children:t.jsxs(H,{bordered:!0,hover:!0,responsive:!0,small:!0,children:[t.jsx("thead",{className:"bg-light",children:t.jsxs("tr",{children:[t.jsx(u,{className:"text-center",style:{fontSize:"0.8rem",padding:"2px",verticalAlign:"middle"},children:"#"}),t.jsx(u,{className:"text-center",style:{fontSize:"0.8rem",padding:"2px",verticalAlign:"middle"},children:"ALUMNO"}),t.jsx(u,{className:"text-center",style:{fontSize:"0.9rem",padding:"2px",verticalAlign:"middle"},children:t.jsx("div",{className:"d-flex justify-content-center gap-4",children:N.map(e=>{const o=K[e.Cod_estado_asistencia]||{color:"gray",icono:"‚ùì"},s=S.every(n=>n.Cod_estado_asistencia===e.Cod_estado_asistencia)?`Haga clic para deseleccionar todos como: ${e.Descripcion_asistencia}`:`Haga clic para marcar todos como: ${e.Descripcion_asistencia}`;return t.jsx("span",{style:{color:o.color,fontSize:"1.2rem",cursor:"pointer"},title:s,onClick:()=>Rt(e.Cod_estado_asistencia),children:o.icono},e.Cod_estado_asistencia)})})}),t.jsx(u,{className:"text-center",style:{fontSize:"0.8rem",padding:"2px",verticalAlign:"middle"},children:"OBSERVACI√ìN"})]})}),t.jsx(W,{children:S.map((e,o)=>t.jsxs(v,{children:[t.jsx(p,{className:"text-center",style:{fontSize:"0.8rem",padding:"2px",verticalAlign:"middle"},children:o+1}),t.jsx(p,{style:{fontSize:"0.8rem",padding:"4px",verticalAlign:"middle"},children:e.Nombre_Completo}),t.jsx(p,{className:"text-center",style:{fontSize:"0.8rem",padding:"2px",verticalAlign:"middle"},children:t.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"32px"},children:N.map(a=>{const s=K[a.Cod_estado_asistencia]||{color:"gray"};return t.jsx("input",{type:"checkbox",checked:S[o].Cod_estado_asistencia===a.Cod_estado_asistencia,onChange:()=>Et(o,a.Cod_estado_asistencia),style:{cursor:"pointer",width:"16px",height:"16px",accentColor:s.color,marginTop:"8px"}},a.Cod_estado_asistencia)})})}),t.jsx(p,{className:"text-center",style:{fontSize:"0.8rem",padding:"4px"},children:t.jsx(tt,{content:t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[t.jsx("textarea",{placeholder:"Escribe tu observaci√≥n",value:e.Observacion==="BORRAR"?"":e.Observacion,maxLength:50,onChange:a=>De(a,s=>Pe(o,s)),onPaste:P,onCopy:P,style:{width:"280px",height:"40px",padding:"0.5rem",resize:"none",overflow:"hidden",whiteSpace:"pre-wrap",border:"1px solid #ccc",outline:"none",fontSize:"0.75rem"},onFocus:a=>a.target.style.border="1px solid #aaa",onBlur:a=>a.target.style.border="1px solid #ccc"}),t.jsx("button",{onClick:()=>Pe(o,"BORRAR"),style:{backgroundColor:"#f44336",color:"#fff",border:"none",padding:"0.1rem 0.3rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem"},children:"Borrar"})]}),placement:"right",trigger:"click",style:{maxWidth:"320px"},children:t.jsx(x,{color:"link",children:t.jsx(g,{icon:ot,style:{color:"black"}})})})})]},e.Cod_asistencias))})]})})]}),t.jsxs(ge,{children:[t.jsx(x,{color:"secondary",onClick:()=>O(!1),children:"Cerrar"}),t.jsxs(x,{onClick:Pt,onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#b28541"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#9f7536"},style:{backgroundColor:"#9f7536",color:"#FFFFFF"},children:[t.jsx(g,{icon:et})," Actualizar"]})]})]})]})};export{Vo as default};
