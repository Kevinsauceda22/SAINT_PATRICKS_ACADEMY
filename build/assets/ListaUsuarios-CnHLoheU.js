import{r as f,i as C,j as a}from"./index-SVRFFNc9.js";import"./react-toastify.esm-64G3A88x.js";import{S as r}from"./sweetalert2.esm.all-D3pEHXw3.js";import{u as oe}from"./usePermission-BCWksQX7.js";import te from"./AccessDenied-yaDW3Jao.js";import{c as m}from"./createLucideIcon-CPQyE5BK.js";import{C as re}from"./circle-alert-DxKZfK3F.js";import"./clsx-B-dksMZM.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=m("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=m("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=m("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=m("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=m("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=m("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=m("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=m("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=m("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Ne=()=>{const{canSelect:P,canUpdate:he,canDelete:ve,canInsert:L,loading:R,error:z}=oe("GestionUsuarios"),[E,A]=f.useState([]),[I,V]=f.useState(""),[B,G]=f.useState("all"),[S,J]=f.useState(""),[K,N]=f.useState(!0),[x,M]=f.useState(new Set),Q=localStorage.getItem("userId"),[D,T]=f.useState(!1),$=localStorage.getItem("userRole");f.useEffect(()=>{H()},[]);const W=[{id:2,title:"Administrador",description:"Acceso completo al sistema",icon:ue,color:"bg-blue-500"},{id:4,title:"Manager",description:"Gestión de recursos y usuarios",icon:se,color:"bg-green-500"},{id:1,title:"Padre",description:"Acceso a información de estudiantes",icon:me,color:"bg-orange-500"},{id:3,title:"Docente",description:"Gestión de clases y calificaciones",icon:ie,color:"bg-purple-500"}],U=e=>e?`${e}:00`:null,F=e=>e?/^([01]?[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/.test(e):!1,X=async e=>{let h={1:"Padre",2:"Administrador",3:"Docente",4:"Manager"}[e]||"";const p=[{Cod_grado_academico:1,Descripcion:"LICENCIATURA"},{Cod_grado_academico:2,Descripcion:"MAESTRÍA"},{Cod_grado_academico:3,Descripcion:"DOCTORADO"},{Cod_grado_academico:4,Descripcion:"POST-DOCTORADO"}],u=[{Cod_tipo_contrato:1,Descripcion:"TIEMPO COMPLETO"},{Cod_tipo_contrato:2,Descripcion:"MEDIO TIEMPO"},{Cod_tipo_contrato:3,Descripcion:"POR HORA"}];let d=[],v=[];try{const o=localStorage.getItem("token"),s=await C.get("http://localhost:4000/api/departamento/departamentos",{headers:{Authorization:`Bearer ${o}`}});s.data&&(d=s.data.reduce((i,n)=>i.find(y=>y.cod_departamento===n.cod_departamento)?i:i.concat([n]),[]).sort((i,n)=>i.nombre_departamento.localeCompare(n.nombre_departamento)));const t=await C.get("http://localhost:4000/api/nacionalidad/vernacionalidades",{headers:{Authorization:`Bearer ${o}`}});t.data&&(v=t.data.sort((i,n)=>i.pais_nacionalidad.localeCompare(n.pais_nacionalidad)))}catch(o){console.error("Error al cargar datos:",o),r.fire({title:"Error",text:"Error al cargar los datos necesarios",icon:"error",confirmButtonText:"Aceptar"});return}const w=e===3?`
      <div class="modal-section">
        <div class="section-title">Información Académica</div>
        <div class="form-grid">
          <div class="form-group">
            <select id="Cod_grado_academico" class="swal2-select" required>
              <option value="">Grado Académico *</option>
              ${p.map(o=>`
                <option value="${o.Cod_grado_academico}">
                  ${o.Descripcion}
                </option>
              `).join("")}
            </select>
          </div>
          <div class="form-group">
            <select id="Cod_tipo_contrato" class="swal2-select" required>
              <option value="">Tipo de Contrato *</option>
              ${u.map(o=>`
                <option value="${o.Cod_tipo_contrato}">
                  ${o.Descripcion}
                </option>
              `).join("")}
            </select>
          </div>
        </div>
      </div>
      <div class="modal-section">
        <div class="section-title">Horario y Experiencia</div>
        <div class="form-grid">
          <div class="form-group">
            <label>Hora de Entrada *</label>
            <input type="time" id="Hora_entrada" class="swal2-input" required>
          </div>
          <div class="form-group">
            <label>Hora de Salida *</label>
            <input type="time" id="Hora_salida" class="swal2-input" required>
          </div>
        </div>
        <div class="form-group">
          <label>Fecha de Ingreso *</label>
          <input type="date" id="Fecha_ingreso" class="swal2-input" required value="${new Date().toISOString().split("T")[0]}">
        </div>
        <div class="form-group">
          <label>Fecha Fin de Contrato</label>
          <input type="date" id="Fecha_fin_contrato" class="swal2-input">
        </div>
        <div class="form-group">
          <label>Años de Experiencia *</label>
    <input 
      type="number" 
      id="Años_experiencia" 
      class="swal2-input"
      placeholder="Ingrese los años de experiencia" 
      required 
      min="0" 
      max="99" 
      value="0"
      step="1"
      onchange="this.value = Math.round(this.value)"
      oninput="this.value = this.value.replace(/[^0-9]/g, '')"
    >
    <small class="helper-text">Ingrese los años de experiencia laboral (número entero entre 0 y 99)</small>
        </div>
      </div>
    `:"";r.fire({title:`Agregar ${h}`,html:`
        <div class="modal-form-container">
          <div class="modal-section">
            <div class="section-title">Información Personal</div>
            <div class="form-grid">
              <div class="form-group">
                <input 
                  id="Nombre" 
                  class="swal2-input" 
                  placeholder="Primer nombre *" 
                  required
                  oninput="this.value = this.value.replace(/\\s/g, '').toUpperCase()">
              </div>
              <div class="form-group">
                <input 
                  id="Segundo_nombre" 
                  class="swal2-input" 
                  placeholder="Segundo nombre"
                  oninput="this.value = this.value.replace(/\\s/g, '').toUpperCase()">
              </div>
              <div class="form-group">
                <input 
                  id="Primer_apellido" 
                  class="swal2-input" 
                  placeholder="Primer apellido *" 
                  required
                  oninput="this.value = this.value.replace(/\\s/g, '').toUpperCase()">
              </div>
              <div class="form-group">
                <input 
                  id="Segundo_apellido" 
                  class="swal2-input" 
                  placeholder="Segundo apellido"
                  oninput="this.value = this.value.replace(/\\s/g, '').toUpperCase()">
              </div>
            </div>
          </div>
  
          <div class="modal-section">
            <div class="section-title">DNI</div>
            <div class="form-group">
              <input 
                id="dni_persona" 
                class="swal2-input" 
                placeholder="Número de documento *" 
                required 
                maxlength="13"
                oninput="this.value = this.value.replace(/[^0-9]/g, '')">
              <small class="helper-text">El DNI debe tener exactamente 13 dígitos</small>
            </div>
          </div>
  
          <div class="modal-section">
            <div class="section-title">Información Adicional</div>
            <div class="form-grid">
              <div class="form-group">
                 <select id="Cod_nacionalidad" class="swal2-select" required onchange="handleNacionalidadChange(this.value)">
                  <option value="">Nacionalidad *</option>
                  ${v.map(o=>`
                    <option value="${o.Cod_nacionalidad}">
                      ${o.pais_nacionalidad.toUpperCase()}
                    </option>
                  `).join("")}
                </select>
              </div>
              <div class="form-group">
                <select id="cod_genero" class="swal2-select" required>
                  <option value="">Género *</option>
                  <option value="1">MASCULINO</option>
                  <option value="2">FEMENINO</option>
                  <option value="3">OTRO</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <input 
                id="direccion_persona" 
                class="swal2-input" 
                placeholder="Dirección"
                oninput="this.value = this.value.toUpperCase()">
            </div>
            <div class="form-group">
              <label class="date-label">Fecha de nacimiento</label>
              <input type="date" id="fecha_nacimiento" class="swal2-input">
            </div>
          </div>
  
          <div class="modal-section">
            <div class="section-title">Ubicación</div>
            <div class="form-grid">
              <div class="form-group">
                <select id="cod_departamento" class="swal2-select" required onchange="handleDepartamentoChange(this.value)">
                  <option value="">Departamento *</option>
                  ${d.map(o=>`
                    <option value="${o.cod_departamento}">
                      ${o.nombre_departamento.toUpperCase()}
                    </option>
                  `).join("")}
                </select>
              </div>
              <div class="form-group">
                <select id="cod_municipio" class="swal2-select" required disabled>
                  <option value="">Municipio *</option>
                </select>
              </div>
            </div>
          </div>

          ${w}
  
          <div class="modal-section">
            <div class="section-title">Información de Cuenta</div>
            <div class="form-group">
              <input 
                id="correo_usuario" 
                class="swal2-input" 
                placeholder="Correo electrónico *" 
                required>
              <small class="helper-text">Se enviará un correo con las credenciales temporales</small>
            </div>
          </div>
        </div>
      `,showCancelButton:!0,confirmButtonText:"Crear Usuario",cancelButtonText:"Cancelar",customClass:{popup:"swal2-popup",confirmButton:"swal2-confirm",cancelButton:"swal2-cancel"},didOpen:()=>{window.handleNacionalidadChange=o=>{const s=document.getElementById("cod_departamento"),t=document.getElementById("cod_municipio");o==="69"?(s.disabled=!1,s.innerHTML=`
              <option value="">Departamento *</option>
              ${d.map(n=>`
                <option value="${n.cod_departamento}">
                  ${n.nombre_departamento.toUpperCase()}
                </option>
              `).join("")}
            `):(s.disabled=!0,s.value="",t.disabled=!0,t.innerHTML='<option value="">Municipio *</option>',t.value="")},window.handleDepartamentoChange=async o=>{const s=document.getElementById("cod_municipio");if(!o){s.innerHTML='<option value="">Municipio *</option>',s.disabled=!0;return}try{const t=localStorage.getItem("token"),i=await C.get(`http://localhost:4000/api/departamento/municipios/${o}`,{headers:{Authorization:`Bearer ${t}`}});i.data&&(s.innerHTML=`
                <option value="">Municipio *</option>
                ${i.data.map(n=>`
                  <option value="${n.cod_municipio}">
                    ${n.nombre_municipio.toUpperCase()}
                  </option>
                `).join("")}
              `,s.disabled=!1)}catch(t){console.error("Error al cargar municipios:",t),s.innerHTML='<option value="">Error al cargar municipios</option>',s.disabled=!0}}},willClose:()=>{delete window.handleDepartamentoChange,delete window.handleNacionalidadChange},preConfirm:()=>{const o=document.getElementById("dni_persona").value;if(o.length!==13)return r.showValidationMessage("El DNI debe tener exactamente 13 dígitos"),!1;const s=document.getElementById("Cod_nacionalidad").value,t=s==="69",i={dni_persona:o,Nombre:document.getElementById("Nombre").value,Segundo_nombre:document.getElementById("Segundo_nombre").value,Primer_apellido:document.getElementById("Primer_apellido").value,Segundo_apellido:document.getElementById("Segundo_apellido").value,Cod_nacionalidad:s,direccion_persona:document.getElementById("direccion_persona").value,fecha_nacimiento:document.getElementById("fecha_nacimiento").value,Estado_Persona:"A",cod_tipo_persona:"1",...t?{cod_departamento:document.getElementById("cod_departamento").value,cod_municipio:document.getElementById("cod_municipio").value}:{cod_departamento:null,cod_municipio:null},cod_genero:document.getElementById("cod_genero").value},n={correo_usuario:document.getElementById("correo_usuario").value,Cod_rol:e,Cod_estado_usuario:1,datos_completados:0,Primer_ingreso:null};let c=null;if(e===3){const g=_=>_?`${_}:00`:null;c={Cod_grado_academico:parseInt(document.getElementById("Cod_grado_academico").value),Cod_tipo_contrato:parseInt(document.getElementById("Cod_tipo_contrato").value),Hora_entrada:g(document.getElementById("Hora_entrada").value),Hora_salida:g(document.getElementById("Hora_salida").value),Fecha_ingreso:document.getElementById("Fecha_ingreso").value,Fecha_fin_contrato:document.getElementById("Fecha_fin_contrato").value||null,Años_experiencia:parseInt(document.getElementById("Años_experiencia").value)};const b=new Date(`2000-01-01T${c.Hora_entrada}`);if(new Date(`2000-01-01T${c.Hora_salida}`)<=b)return r.showValidationMessage("La hora de salida debe ser posterior a la hora de entrada"),!1;if(c.Fecha_fin_contrato){const _=new Date(c.Fecha_ingreso);if(new Date(c.Fecha_fin_contrato)<=_)return r.showValidationMessage("La fecha de fin de contrato debe ser posterior a la fecha de ingreso"),!1}if(c.Años_experiencia<0||c.Años_experiencia>99)return r.showValidationMessage("Los años de experiencia deben estar entre 0 y 99"),!1}const y=["dni_persona","Nombre","Primer_apellido","correo_usuario","cod_genero","Cod_nacionalidad"];if(t&&y.push("cod_departamento","cod_municipio"),e===3&&y.push("Cod_grado_academico","Cod_tipo_contrato","Hora_entrada","Hora_salida","Fecha_ingreso","Años_experiencia"),y.filter(g=>!document.getElementById(g).value).length>0)return r.showValidationMessage("Por favor complete todos los campos marcados con *"),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.correo_usuario))return r.showValidationMessage("Por favor ingrese un correo electrónico válido"),!1;if(e===3){const g=U(document.getElementById("Hora_entrada").value),b=U(document.getElementById("Hora_salida").value),j=document.getElementById("Años_experiencia").value;if(j===""||j===null||isNaN(j))return r.showValidationMessage("Los años de experiencia son requeridos"),!1;const _=parseInt(j);if(_<0||_>99)return r.showValidationMessage("Los años de experiencia deben estar entre 0 y 99"),!1;if(c={Cod_grado_academico:parseInt(document.getElementById("Cod_grado_academico").value),Cod_tipo_contrato:parseInt(document.getElementById("Cod_tipo_contrato").value),Hora_entrada:g,Hora_salida:b,Fecha_ingreso:document.getElementById("Fecha_ingreso").value,Fecha_fin_contrato:document.getElementById("Fecha_fin_contrato").value||null,Años_experiencia:_},!F(g)||!F(b))return r.showValidationMessage("El formato de hora no es válido"),!1;const O=new Date(`2000-01-01T${g}`);if(new Date(`2000-01-01T${b}`)<=O)return r.showValidationMessage("La hora de salida debe ser posterior a la hora de entrada"),!1;if(c.Fecha_fin_contrato){const ae=new Date(c.Fecha_ingreso);if(new Date(c.Fecha_fin_contrato)<=ae)return r.showValidationMessage("La fecha de fin de contrato debe ser posterior a la fecha de ingreso"),!1}}return{personData:i,userData:n,profesorData:c}}}).then(o=>{if(o.isConfirmed){const s=localStorage.getItem("token");r.fire({title:"Creando usuario...",html:"Se enviará un correo con las credenciales temporales",allowOutsideClick:!1,didOpen:()=>{r.showLoading()}}),C.post("http://localhost:4000/api/usuarios/crear-usuario",o.value,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}}).then(t=>{r.fire({title:"¡Usuario Creado!",text:`Se ha enviado un correo a ${o.value.userData.correo_usuario} con las credenciales de acceso`,icon:"success",confirmButtonText:"Aceptar"}),H(),T(!1)}).catch(t=>{var i,n,c;console.error("Error detallado:",(i=t.response)==null?void 0:i.data),r.fire({title:"Error",text:((c=(n=t.response)==null?void 0:n.data)==null?void 0:c.mensaje)||"Error al crear el usuario",icon:"error",confirmButtonText:"Aceptar"})})}})},H=async()=>{var l,h,p,u;N(!0);const e=localStorage.getItem("token");if(!e){r.fire({title:"Error",text:"No se ha encontrado el token. Por favor, inicia sesión nuevamente.",icon:"error",confirmButtonText:"Aceptar"}),N(!1);return}try{const d=await C.get("http://localhost:4000/api/usuarios/Todos-los-usuarios",{headers:{Authorization:`Bearer ${e}`}}),v=Array.isArray(d.data[0])?d.data[0]:d.data;A(v),v.length||r.fire({title:"Aviso",text:"No se encontraron usuarios",icon:"warning",confirmButtonText:"Aceptar"})}catch(d){console.error("Error al cargar usuarios:",d),r.fire({title:"Error",text:((h=(l=d.response)==null?void 0:l.data)==null?void 0:h.mensaje)||"Error al cargar usuarios",icon:"error",confirmButtonText:"Aceptar"}),J(((u=(p=d.response)==null?void 0:p.data)==null?void 0:u.mensaje)||"Error al cargar usuarios")}finally{N(!1)}},k=async(e,l)=>{var d,v,w,o,s;if(parseInt(Q)===e){r.fire({title:"Error",text:"No puedes cambiar tu propio estado de privilegios.",icon:"error",confirmButtonText:"Aceptar"});return}if($==="2"&&l!=="2"&&((d=E.find(t=>t.cod_usuario===e))==null?void 0:d.Cod_rol)==="2"){r.fire({title:"Error",text:"No puedes cambiar el estado de otros administradores.",icon:"error",confirmButtonText:"Aceptar"});return}if($==="4"&&l!=="2"&&((v=E.find(t=>t.cod_usuario===e))==null?void 0:v.Cod_rol)==="4"){r.fire({title:"Error",text:"No puedes cambiar el estado de otros managers.",icon:"error",confirmButtonText:"Aceptar"});return}if(x.has(e))return;const h={1:"activar",2:"desactivar",3:"suspender"},{value:p}=await r.fire({title:`¿Estás seguro de que deseas ${h[l]} este usuario?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, estoy seguro",cancelButtonText:"Cancelar"});if(!p)return;const u=localStorage.getItem("token");if(!u){r.fire({title:"Error",text:"No se encontró el token de autenticación",icon:"error",confirmButtonText:"Aceptar"});return}try{M(i=>new Set(i).add(e));const t=await C.put("http://localhost:4000/api/usuarios/cambiar-estado",{userId:e,Cod_estado_usuario:l},{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"}});t.data&&t.status===200&&(A(i=>i.map(n=>n.cod_usuario===e?{...n,Cod_estado_usuario:l}:n)),r.fire({title:"Éxito",text:"Estado actualizado correctamente",icon:"success",confirmButtonText:"Aceptar"}))}catch(t){console.error("Error detallado:",(w=t.response)==null?void 0:w.data),r.fire({title:"Error",text:((s=(o=t.response)==null?void 0:o.data)==null?void 0:s.mensaje)||"Error al cambiar el estado del usuario",icon:"error",confirmButtonText:"Aceptar"})}finally{M(t=>{const i=new Set(t);return i.delete(e),i})}},Y=e=>{switch(e){case 1:return a.jsx(le,{className:"status-icon active",size:18});case 2:return a.jsx(de,{className:"status-icon inactive",size:18});case 3:return a.jsx(re,{className:"status-icon suspended",size:18});default:return null}},Z=e=>{switch(e){case 1:return"Activo";case 2:return"Inactivo";case 3:return"Suspendido";default:return"Desconocido"}},ee=e=>{switch(e){case 1:return"Padre";case 2:return"Administrador";case 3:return"Docente";case 4:return"Manager";default:return"Desconocido"}},q=E.filter(e=>{var p,u;const l=((p=e.nombre_usuario)==null?void 0:p.toLowerCase().includes(I.toLowerCase()))||!1||((u=e.correo_electronico)==null?void 0:u.toLowerCase().includes(I.toLowerCase()))||!1,h=B==="all"||e.Cod_estado_usuario===parseInt(B);return l&&h});return R?a.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):z?a.jsx("div",{className:"alert alert-danger",role:"alert",children:"Error al cargar los permisos. Por favor, intente nuevamente."}):P?a.jsxs("div",{className:"user-management",children:[a.jsxs("div",{className:"header",children:[a.jsxs("div",{className:"header-top",children:[a.jsx("h1",{children:"Gestión de Usuarios"}),a.jsxs("button",{className:"btn btn-primary add-user-main",onClick:()=>T(!D),children:[a.jsx(pe,{size:20,className:"me-2"}),"Agregar Usuario"]})]}),D&&a.jsx("div",{className:"user-types-grid",children:W.filter(e=>L?!0:e.id!==2&&e.id!==4).map(e=>a.jsxs("button",{className:"user-type-button",onClick:()=>X(e.id),children:[a.jsx("div",{className:`icon-wrapper ${e.color}`,children:a.jsx(e.icon,{size:24,className:"text-white"})}),a.jsxs("div",{className:"user-type-info",children:[a.jsx("h3",{children:e.title}),a.jsx("p",{children:e.description})]})]},e.id))}),S&&a.jsx("div",{className:"error-message",children:S}),a.jsxs("div",{className:"controls",children:[a.jsxs("div",{className:"search-box",children:[a.jsx(ce,{size:20}),a.jsx("input",{type:"text",placeholder:"Buscar usuarios...",value:I,onChange:e=>V(e.target.value)})]}),a.jsxs("div",{className:"filter-box",children:[a.jsxs("select",{value:B,onChange:e=>G(e.target.value),children:[a.jsx("option",{value:"all",children:"Todos los estados"}),a.jsx("option",{value:"1",children:"Activos"}),a.jsx("option",{value:"2",children:"Inactivos"}),a.jsx("option",{value:"3",children:"Suspendidos"})]}),a.jsx(ne,{size:20,className:"select-icon"})]})]})]}),a.jsx("div",{className:"table-container",children:K?a.jsx("div",{className:"loading-message",children:"Cargando usuarios..."}):a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"users-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Usuario"}),a.jsx("th",{children:"Rol"}),a.jsx("th",{children:"Estado"}),a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:q.map(e=>a.jsxs("tr",{children:[a.jsx("td",{className:"user-cell",children:a.jsxs("div",{className:"user-info",children:[a.jsx("span",{className:"user-name",children:e.nombre_usuario}),a.jsx("span",{className:"user-email",children:e.correo_electronico})]})}),a.jsx("td",{children:ee(e.Cod_rol)}),a.jsx("td",{children:a.jsxs("span",{className:`status-badge status-${e.Cod_estado_usuario}`,children:[Y(e.Cod_estado_usuario),Z(e.Cod_estado_usuario)]})}),a.jsx("td",{children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:`btn btn-activate ${e.Cod_estado_usuario===1||x.has(e.cod_usuario)||e.Cod_rol==="2"||e.Cod_rol==="4"?"disabled":""}`,onClick:()=>k(e.cod_usuario,1),disabled:e.Cod_estado_usuario===1||x.has(e.cod_usuario)||e.Cod_rol==="2"||e.Cod_rol==="4",children:"Activar"}),a.jsx("button",{className:`btn btn-deactivate ${e.Cod_estado_usuario===2||x.has(e.cod_usuario)||e.Cod_rol==="2"||e.Cod_rol==="4"?"disabled":""}`,onClick:()=>k(e.cod_usuario,2),disabled:e.Cod_estado_usuario===2||x.has(e.cod_usuario)||e.Cod_rol==="2"||e.Cod_rol==="4",children:"Desactivar"}),a.jsx("button",{className:`btn btn-suspend ${e.Cod_estado_usuario===3||x.has(e.cod_usuario)||e.Cod_rol==="2"||e.Cod_rol==="4"?"disabled":""}`,onClick:()=>k(e.cod_usuario,3),disabled:e.Cod_estado_usuario===3||x.has(e.cod_usuario)||e.Cod_rol==="2"||e.Cod_rol==="4",children:"Suspender"})]})})]},e.cod_usuario))})]}),q.length===0&&a.jsx("div",{className:"no-results-message",children:"No se encontraron usuarios que coincidan con tu búsqueda."})]})})]}):a.jsx(te,{})};export{Ne as default};
