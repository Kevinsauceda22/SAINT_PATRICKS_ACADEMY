import{r as o,j as e,C as ee}from"./index-SVRFFNc9.js";import{C as S}from"./index.esm-DWwMdKxH.js";import{S as g}from"./sweetalert2.esm.all-D3pEHXw3.js";import{l as te}from"./logo_saint_patrick-xw7Wl8f3.js";import"./jspdf.plugin.autotable-gke1D7B3.js";import"./html2canvas.esm-CBrSDip1.js";import{u as re}from"./usePermission-BCWksQX7.js";import se from"./AccessDenied-yaDW3Jao.js";import{C as oe}from"./CContainer-BdNP0s3v.js";import{C as T,a as b}from"./CRow-Bf67u6lu.js";import{C as P}from"./CInputGroup-D-McUFva.js";import{C as ae}from"./CInputGroupText-Cfu0fzaY.js";import{c as ne}from"./cil-search-CDkY_4k-.js";import{C as ie}from"./CFormInput-B_gylY64.js";import{a as u}from"./CButton-D9GPTbB6.js";import{c as le}from"./cil-brush-alt-CV61lKqC.js";import{C as ce}from"./CFormSelect-CzT7g5tb.js";import{C as I,a as L,b as d,c as n,d as R,e as a}from"./CTable-98qqrSRH.js";import{C as de}from"./CPagination-UopCEeNZ.js";import{c as xe}from"./cil-arrow-left-D66Kb3Zq.js";import"./CFormControlWrapper-OEJgTi6e.js";import"./CFormControlValidation-CtDkyDfm.js";import"./CFormLabel-szm2Dda9.js";const Me=()=>{const{canSelect:D,canInsert:pe,canUpdate:me}=re("ListaCuadroPadre"),[M,z]=o.useState([]),[C,O]=o.useState(!0),[N,w]=o.useState("hijos");o.useState([]);const[H,_]=o.useState("");o.useState(""),o.useState(""),o.useState(null);const[G,W]=o.useState(""),[$,U]=o.useState(""),[V,Y]=o.useState(""),[x,X]=o.useState(5),[F,k]=o.useState(""),[p,f]=o.useState(1),[i,q]=o.useState([]);o.useEffect(()=>{Z()},[]);const Z=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("Token no encontrado");const r=await fetch("http://74.50.68.87:4000/api/notas/hijos",{method:"GET",headers:{Authorization:`Bearer ${t}`}});if(!r.ok)throw new Error("Error al obtener los hijos matriculados");const s=await r.json();z(s.hijos)}catch(t){console.error("Error al obtener los hijos matriculados:",t)}finally{O(!1)}},J=async(t,r,s,l,m)=>{try{U(r),Y(s),W(l),_(m);const c=await fetch(`http://74.50.68.87:4000/api/notas/notasypromedio/${t}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!c.ok)throw new Error("Error al obtener el cuadro de notas.");const h=await c.json();q(h),w("cuadroNotas")}catch(c){console.error("Error al obtener el cuadro de notas:",c),g.fire("Error","No se pudieron cargar los datos del cuadro de notas","error")}},B=t=>{t.preventDefault(),g.fire({icon:"warning",title:"Acción bloqueada",text:"Copiar y pegar no está permitido.",confirmButtonText:"Aceptar"})},K=t=>{let s=t.target.value.toUpperCase().trimStart();const l=/^[A-ZÑÁÉÍÓÚ0-9\s,]*$/;if(/\s{2,}/.test(s)&&(g.fire({icon:"warning",title:"Espacios múltiples",text:"No se permite más de un espacio entre palabras.",confirmButtonText:"Aceptar"}),s=s.replace(/\s+/g," ")),!l.test(s)){g.fire({icon:"warning",title:"Caracteres no permitidos",text:"Solo se permiten letras, números y espacios.",confirmButtonText:"Aceptar"});return}const m=s.split(" ");for(let c of m){const h={};for(let y of c)if(h[y]=(h[y]||0)+1,h[y]>4){g.fire({icon:"warning",title:"Repetición de letras",text:`La letra "${y}" se repite más de 4 veces en la palabra "${c}".`,confirmButtonText:"Aceptar"});return}}k(s),f(1)},j=M.filter(t=>t.Nombre_Completo.toLowerCase().includes(F.toLowerCase())),v=p*x,Q=v-x,A=j.slice(Q,v),E=t=>{t>0&&t<=Math.ceil(j.length/x)&&f(t)};return D?e.jsxs(oe,{className:"py-1",children:[C&&e.jsx("div",{className:"text-center my-5",children:e.jsx(ee,{color:"primary","aria-label":"Cargando información..."})}),!C&&N==="hijos"&&e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"align-items-center mb-5",children:e.jsx(b,{xs:"12",className:"d-flex flex-column flex-md-row justify-content-between align-items-center gap-3",children:e.jsx("div",{className:"flex-grow-1 text-center",children:e.jsx("h4",{className:"text-center fw-semibold pb-2 mb-0",style:{display:"inline-block",borderBottom:"2px solid #4CAF50"},children:" Cuadros: Mis Hijos"})})})}),e.jsxs(T,{className:"align-items-center mt-4 mb-2",children:[e.jsx(b,{xs:"12",md:"8",className:"d-flex flex-wrap align-items-center",children:e.jsxs(P,{className:"me-3",style:{width:"350px"},children:[e.jsx(ae,{children:e.jsx(S,{icon:ne})}),e.jsx(ie,{style:{width:"80px",height:"35px",display:"inline-block",fontSize:"0.8rem"},placeholder:"Buscar estudiante...",onChange:K,value:F,onPaste:B,onCopy:B}),e.jsxs(u,{style:{border:"1px solid #ccc",transition:"all 0.1s ease-in-out",backgroundColor:"#F3F4F7",color:"#343a40",height:"35px"},onClick:()=>{k(""),f(1)},onMouseEnter:t=>{t.currentTarget.style.backgroundColor="#E0E0E0",t.currentTarget.style.color="black"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="#F3F4F7",t.currentTarget.style.color="#343a40"},children:[e.jsx(S,{icon:le})," Limpiar"]})]})}),e.jsx(b,{xs:"12",md:"4",className:"text-md-end mt-2 mt-md-0",children:e.jsx(P,{style:{width:"auto",display:"inline-block"},children:e.jsxs("div",{className:"d-inline-flex align-items-center",children:[e.jsx("span",{style:{fontSize:"0.85rem"},children:"Mostrar "}),e.jsxs(ce,{style:{width:"80px",height:"35px",display:"inline-block",textAlign:"center"},onChange:t=>{const r=Number(t.target.value);X(r),f(1)},value:x,children:[e.jsx("option",{value:"5",children:"5"}),e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"})]}),e.jsx("span",{style:{fontSize:"0.85rem"},children:" registros"})]})})})]}),e.jsx("div",{className:"table-responsive",style:{maxHeight:"400px",overflowX:"auto",overflowY:"auto",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.3)"},children:e.jsxs(I,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx(L,{className:"sticky-top bg-light text-center",style:{fontSize:"0.8rem"},children:e.jsxs(d,{children:[e.jsx(n,{children:"#"}),e.jsx(n,{children:"IDENTIDAD"}),e.jsx(n,{children:"NOMBRE ESTUDIANTE"}),e.jsx(n,{children:"GRADO"}),e.jsx(n,{children:"SECCIÓN"}),e.jsx(n,{children:"ACCIÓN"})]})}),e.jsx(R,{className:"text-center",style:{fontSize:"0.85rem"},children:A.length>0?A.map((t,r)=>e.jsxs(d,{children:[e.jsx(a,{children:r+1}),e.jsx(a,{children:t.DNI}),e.jsx(a,{children:t.Nombre_Completo}),e.jsx(a,{children:t.nombre_grado}),e.jsx(a,{children:t.nombre_seccion}),e.jsx(a,{children:e.jsx(u,{size:"sm",style:{backgroundColor:"#F0F4F3",color:"#153E21",border:"1px solid #A2B8A9",borderRadius:"6px",padding:"5px 12px",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.1)"},onMouseEnter:s=>s.target.style.backgroundColor="#dce3dc",onMouseLeave:s=>s.target.style.backgroundColor="#F0F4F3",onClick:()=>J(t.cod_seccion_matricula,t.Nombre_Completo,t.DNI,t.nombre_grado,t.nombre_seccion),children:"Ver Cuadro"})})]},r)):e.jsx(d,{children:e.jsx(a,{colSpan:"5",children:"No se encontraron resultados"})})})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"16px"},children:[e.jsxs(de,{"aria-label":"Page navigation",style:{display:"flex",gap:"10px"},children:[e.jsx(u,{style:{backgroundColor:"#6f8173",color:"#D9EAD3"},disabled:p===1,onClick:()=>E(p-1),children:"Anterior"}),e.jsx(u,{style:{marginLeft:"10px",backgroundColor:"#6f8173",color:"#D9EAD3"},disabled:p===Math.ceil(j.length/x),onClick:()=>E(p+1),children:"Siguiente"})]}),e.jsxs("span",{style:{marginLeft:"10px"},children:["Página ",p," de ",Math.ceil(j.length/x)]})]})]}),!C&&N==="cuadroNotas"&&e.jsxs(e.Fragment,{children:[e.jsx(b,{xs:"12",className:"d-flex flex-column flex-md-row justify-content-between align-items-center gap-3",children:e.jsxs(u,{className:"btn btn-sm d-flex align-items-center gap-1 rounded shadow",onMouseEnter:t=>t.currentTarget.style.backgroundColor="#4B4B4B",onMouseLeave:t=>t.currentTarget.style.backgroundColor="#656565",style:{backgroundColor:"#656565",color:"#FFFFFF",padding:"6px 12px",fontSize:"0.9rem",transition:"background-color 0.2s ease, box-shadow 0.3s ease",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)"},onClick:()=>w("hijos"),children:[e.jsx(S,{icon:xe})," Volver a Hijos"]})}),e.jsxs("div",{style:{width:"816px",height:"1056px",backgroundColor:"white",padding:"20px",boxSizing:"border-box",justifyContent:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",textAlign:"left",marginBottom:"10px",flex:1,marginLeft:"-70px",padding:"5px",borderRadius:"8px",fontFamily:"Arial Narrow, sans-serif",fontSize:"1rem"},children:[e.jsx("img",{src:te,alt:"Saint Patrick's Academy Logo",style:{width:"200px",height:"200px",position:"relative",left:"-80px"}}),e.jsxs("div",{style:{textAlign:"center",marginTop:"-70px",transform:"translateX(-10px)"},children:[e.jsx("h1",{style:{fontSize:"2.333rem",marginBottom:"10px",marginTop:"0",fontFamily:"Monotype Corsiva, cursive",fontWeight:"bold",color:"#000000"},children:"Saint Patrick's Academy"}),e.jsx("h2",{style:{fontSize:"2.17rem",marginBottom:"5px",fontFamily:"Monotype Corsiva, cursive",color:"#000000",marginTop:"0",fontWeight:"bold"},children:"Report Card"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",margin:"0 30px",fontSize:"1.1rem",fontFamily:"Arial Narrow, sans-serif",color:"#000000",marginTop:"30px"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center"},children:[e.jsx("strong",{style:{fontWeight:"bold"},children:"Student Name:"}),e.jsx("span",{style:{borderBottom:"1px solid black",paddingBottom:"2px",display:"inline-block",flex:"1",marginLeft:"5px",letterSpacing:"0.5px"},children:$})]}),e.jsxs("span",{style:{display:"flex",alignItems:"center"},children:[e.jsx("strong",{style:{fontWeight:"bold"},children:"Student ID:"}),e.jsx("span",{style:{borderBottom:"1px solid black",paddingBottom:"2px",display:"inline-block",flex:"1",marginLeft:"5px",letterSpacing:"0.5px"},children:V})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",margin:"20px 30px",fontSize:"1.1rem",fontFamily:"Arial Narrow, sans-serif",color:"#000000",marginTop:"30px"},children:[e.jsxs("span",{style:{marginLeft:"40px"},children:[e.jsx("strong",{style:{fontWeight:"bold"},children:"Grade: "}),e.jsxs("span",{style:{paddingBottom:"2px",display:"inline-block",letterSpacing:"0.5px"},children:[" ",G]})]}),e.jsxs("span",{style:{marginLeft:"10px"},children:[e.jsx("strong",{style:{fontWeight:"bold"},children:"Section: "})," ",H]}),e.jsxs("span",{style:{marginRight:"40px"},children:[e.jsx("strong",{style:{fontWeight:"bold"},children:"School year: "})," ",new Date().getFullYear(),"-",new Date().getFullYear()+1]})]}),e.jsxs(I,{className:"table-bordered",style:{border:"1px solid #000000",marginTop:"50px",fontSize:"0.8rem",lineHeight:"1"},children:[e.jsxs(L,{children:[e.jsxs(d,{children:[e.jsx(n,{rowSpan:2,className:"text-center align-middle",style:{backgroundColor:"#BFBFBF"},children:e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center",children:[e.jsx("span",{style:{marginBottom:"12px"},children:"ÁREAS CURRICULARES/"}),e.jsx("span",{style:{marginTop:"5px"},children:"CAMPOS DEL CONOCIMIENTO"})]})}),e.jsx(n,{rowSpan:1,colSpan:i.length>0?i[0].NotasParciales.filter(t=>!t.Parcial.match(/recu/i)).length:0,className:"text-center align-middle",style:{backgroundColor:"#BFBFBF",borderBottom:"1px solid #000000",padding:"10px"},children:"PARCIALES"}),i.length>0&&i[0].NotasParciales.some(t=>t.Parcial.match(/recu/i))&&i[0].NotasParciales.filter(t=>t.Parcial.match(/recu/i)).map((t,r)=>e.jsxs(n,{rowSpan:2,className:"text-center align-middle",style:{backgroundColor:"#BFBFBF",padding:"10px"},children:[t.Parcial," "]},r)),e.jsx(n,{rowSpan:2,className:"text-center align-middle",style:{backgroundColor:"#BFBFBF"},children:e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center",children:[e.jsx("span",{style:{marginBottom:"12px"},children:"NOTA"}),e.jsx("span",{style:{marginTop:"5px"},children:"PROM.FINAL (%)"})]})})]}),e.jsx(d,{children:i.length>0&&i[0].NotasParciales.filter(t=>!t.Parcial.match(/recu/i)).map((t,r)=>e.jsx(n,{className:"text-center",style:{backgroundColor:"#BFBFBF"},children:t.Parcial},r))})]}),e.jsx(R,{children:i.length>0?i.map((t,r)=>{var s;return e.jsxs(d,{children:[e.jsx(a,{className:"text-center bg-transparent",style:{fontSize:"0.8rem",width:"350px"},children:e.jsxs("div",{className:"d-flex justify-content-start",children:[e.jsxs("span",{style:{marginRight:"20px",marginLeft:"60px"},children:[r+1,"."]})," ",e.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:t.Asignatura})," "]})}),t.NotasParciales.filter(l=>!l.Parcial.match(/recu/i)).map((l,m)=>e.jsx(a,{className:"text-center bg-transparent",children:l.Nota},m)),e.jsx(a,{className:"text-center bg-transparent",children:((s=t.NotasParciales.find(l=>l.Parcial.match(/recu/i)))==null?void 0:s.Nota)||"-"}),e.jsx(a,{className:"text-center bg-transparent",children:t.PromedioFinal})]},r)}):e.jsx(d,{children:e.jsx(a,{colSpan:"5",children:"No se encontraron resultados"})})})]})]})]})]}):e.jsx(se,{})};export{Me as default};
